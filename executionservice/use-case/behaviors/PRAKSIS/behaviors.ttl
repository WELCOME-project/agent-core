# @base <http://localhost:8090/rdf4j/repositories/behaviors#> .

@prefix agents: <http://localhost:8090/rdf4j/repositories/agents#> .
@prefix : <http://localhost:8090/rdf4j/repositories/behaviors#> .
@prefix domain: <http://localhost:8090/rdf4j/repositories/domain#> .
@prefix localServices: <http://localhost:8090/rdf4j/repositories/localServices#> .
@prefix localAgents: <http://localhost:8090/rdf4j/repositories/localAgents#> .
@prefix services: <http://localhost:8090/rdf4j/repositories/services#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ajan: <http://www.ajan.de/ajan-ns#> .
@prefix bt: <http://www.ajan.de/behavior/bt-ns#> .
@prefix actn: <http://www.ajan.de/actn#> .
@prefix http-headers: <http://www.w3.org/2008/http-headers#> .
@prefix http-methods: <http://www.w3.org/2008/http-methods#> .
@prefix http-core: <http://www.w3.org/2006/http#> .
@prefix ssc: <http://welcome/ajan/servicecomputing#> .
@prefix myWelcome: <http://www.ajan.de/myWelcome-ns#> .

# ----------------------------------------------
# ------------- WelcomeBehaviorTree ------------
# ----------------------------------------------

# ----------- Endpoint ------------

# localhost:8080/welcome/integration/coordination/ajan/agents/<agentName>?capability=receiveSpeechAct | POST | text/turtle
# Body: "<http://test/Subject> <http://test/predicate> "Hallo! I come from the KMS" ."
# localhost:8080/welcome/integration/coordination/ajan/agents/<agentName>?capability=populateRepo | POST | text/turtle
# Body: "<http://test/Subject> <http://test/predicate> "Hallo! I come from the WPM" ."

# -------------------------------------------	
# ---------------- Behaviors ----------------
# -------------------------------------------	
				
:InitialWelcomeBehavior
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Initialization Behavior" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:UpdateBehaviorRunning
										[
											a bt:Priority ;
											bt:hasChildren (
																:ConditionLSRPopulated
																:EventProducerPopulateLSR
															)																														
										]
										[
											a bt:Priority ;
											bt:hasChildren (
																:ConditionLARPopulated
																:EventProducerPopulateLAR														
															)																														
										]
									)
				] .

:FinalWelcomeBehavior
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Final Behavior" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:DeleteTemporalFlagsinLAKR
										:DeleteTemporalFlagsinLSR
									)
				] .

:HeartbeatMonitoringBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Heartbeat behavior" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:AgentMonitoringHandleEvent
									)
				] .

:ErrorHandlingBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Error Handling Behavior" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:ReceiveErrorHandleEvent
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionKMSError
																						:UpdateCreateClosingUponFailureFarewellKMSError_Part1
																						:UpdateCreateClosingUponFailureFarewellKMSError_Part2
																						#:UpdateCreateHeaderDMSMessage																												
																						:SendIncompleteOrMultipleDIPDMS
																					)																															
																]
															)																															
										]
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:UpdateEmptyExecutionRepository
										]
									)
				] .
				
:PopulateLSRRepos
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Populate Local LSR Repository" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
										[
											a bt:Sequence ;
											bt:hasChildren (
																:EventHandlerRequestLSRTriples
																:UpdateBehaviorRunning
																:UpdateCreateHeaderDispatcherMessage
																:MessageSendLSRMessageWPM
																:DefaultFailed
															)																														
										]
										[
											a bt:Sequence ;
											bt:hasChildren (
																:EventHandlerReceiveLocalServices
																:UpdateBehaviorRunning
																[
																	a bt:Priority ;
																	bt:hasChildren (
																						[
																							a bt:Invert ;
																							bt:hasChild 
																										:ConditionLSRPopulated																														
																						]
																						:RemoveLSRContent
																						:UpdateLSRAgentKnowledge
																					)																															
																]
																:WriteTriplesLSRC1
																:WriteTriplesLSRC2
																:WriteTriplesLSRC3
																:WriteTriplesLSRC4
																:WriteTriplesLSRC5
																:PluginOWL2PDDL
																:UpdateAgentKnowsLSR
																:UpdateLSRExecutionKnowledge
																:UpdateDeleteBehaviorRunning
															)																															
										]
								   )
				] .

:PopulateLARRepos
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Populate Local LAR Repository" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
										[
											a bt:Sequence ;
											bt:hasChildren (
																:EventHandlerRequestLARTriples
																:UpdateBehaviorRunning
																:UpdateCreateHeaderDispatcherMessage
																:MessageSendLARMessageWPM
																:DefaultFailed
															)																															
										]
										[
											a bt:Sequence ;
											bt:hasChildren (
																:EventHandlerReceiveLocalAgents
																:UpdateBehaviorRunning
																[
																	a bt:Priority ;
																	bt:hasChildren (
																						[
																							a bt:Invert ;
																							bt:hasChild 
																										:ConditionLARPopulated																														
																						]
																						:RemoveLARContent
																						:UpdateLARAgentKnowledge
																					)																															
																]
																:WriteTriplesLAR
																:UpdateAgentKnowsLAR
																:UpdateLARExecutionKnowledge
																:UpdateDeleteBehaviorRunning
															)																															
										]
								   )
				] .
				
:HandshakeBehavior
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Handhshake BT" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
										[
											a bt:Invert ;
											bt:hasChild 
														:EventHandlerHandshake
										]
										[
											a bt:Sequence ;
											bt:hasChildren (
																:UpdateBehaviorRunning
																:ConditionLSRPopulated
																[
																	a bt:Priority ;
																	bt:hasChildren ([
																						a bt:Sequence ;
																						bt:hasChildren (
																										:ConditionLARPopulated
																										:ConditionIsTCNLogged
																										:UpdateCreateHeaderAppMessage
																										:MessageSendAgentReadiness
																										:UpdateDeleteBehaviorRunning
																										)																															
																					]
																					:EventProducerPopulateLAR
																					)																												
																]
															)
										]
										:EventProducerPopulateLSR									
									)																														
	] .
			
:ProcessSpeechActsBehavior
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Process Speech Acts BT" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Invert ;
																	bt:hasChild 
																				:EventSpeaktoavatar
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:UpdateBehaviorRunning
																						[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:UpdateEmptyExecutionRepository			
																						]
																						:WriteAgentNameinExecution
																						:UpdateCreateOpeningDIPPart1
																						:UpdateCreateOpeningDIPPart2
																						:UpdateCreateOpeningDIPPart3
																						:UpdateCreateHeaderKMSMessage
																						:SendDIPtoKMS
																					)
																]
															)																														
										]
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Invert ;
																	bt:hasChild 
																				:EventDIP_OR_ServiceRequest
																]
																[
																	a bt:Priority ;
																	bt:hasChildren (
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:UpdateBehaviorRunning																																		
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																						:UpdateEmptyExecutionRepository
																																						
																																		]
																																		:WriteActiveDIPinExecution
																																		:ConditionDIPIncomplete
																																		:UpdateIncompleteDIP
																																		:EventProducerSpecificBTDIPIncomplete
																																	)
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionDIPCompleteOrUndefinedOrUnfinished
																																		:UpdateCompleteDIP
																																		[
																																			a bt:Priority ;
																																			bt:hasChildren (
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														:ConditionDIPIsNotOpening
																																														:EventProducerSpecificBTDIPComplete
																																													)
																																								]
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														:ConditionalNoServiceRequest
																																														:DeleteActiveDIPinAgentKB																																														
																																														[
																																															a bt:IsSucceeding ;
																																															bt:hasChild 
																																																	:UpdateEmptyExecutionRepository
																																														]
																																														:WriteAgentNameinExecution
																																														:CreateClosingUponFailureNoRequest_Part1
																																														:CreateClosingUponFailureNoRequest_Part2
																																														:UpdateCreateHeaderKMSMessage
																																														:SendDIPtoKMS
																																													)
																																								]
																																							)
																																		]
																																	)
																												]																											
																											)
																						]
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionServiceRequest
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																					:DeletePreviousServiceRequestinExecution
																																		]																																		
																																		:WriteServiceRequestinExecution
																																		[
																																			a bt:Priority ;
																																			bt:hasChildren (
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														:InvokeMatchmaker
																																														:ConditionMatchmakerOutput
																																														:PDDL2SPARQLPlugin
																																														[
																																															a bt:Priority ;
																																															bt:hasChildren (
																																																				[
																																																					a bt:Sequence ;
																																																					bt:hasChildren (
																																																										:ConditionPreconditionHolds
																																																										#[
																																																										#	a bt:Priority ;
																																																										#	bt:hasChildren (
																																																										#						[
																																																										#							a bt:Sequence ;
																																																										#							bt:hasChildren (
																																																										#												:ConditionAtomicService
																																																										#												:CreateAtomicServiceDIP
																																																										#											)																														
																																																										#						]	
																																																										#						[
																																																										#							a bt:Sequence ;
																																																										#							bt:hasChildren (
																																																										#												:ConditionComposedService
																																																										#												:CreateComposedServiceDIP
																																																										#											)																														
																																																										#						]	
																																																										#					)																														
																																																										#]	
																																																										:DeleteSSCResultinAgentKB
																																																										:WriteSSCResultinAgentKB
																																																										:EventProducerFirstInteractionMove
																																																									)																														
																																																				]
																																																				:EventProducerAlternativeFirstInteractionMove																																		
																																																			)																														
																																														]
																																													)
																																								]																					
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														:InvokePlanner
																																														:ConditionPlannerOutput
																																													)																														
																																								]
																																							)
																																		]
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:DeleteActiveDIPinAgentKB
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																						:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:CreateClosingUponFailureNoRequest_Part1
																																		:CreateClosingUponFailureNoRequest_Part2
																																		:UpdateCreateHeaderKMSMessage
																																		:SendDIPtoKMS
																																	)																														
																												]																					
																											)																														
																						]
																					)
																]
															)																														
										]										
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Invert ;
																	bt:hasChild 
																				:EventDefaultStatementNoOpinion
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:UpdateBehaviorRunning
																						:DeleteActiveDIPinAgentKB																						
																						[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																										:UpdateEmptyExecutionRepository
																						]
																						:WriteAgentNameinExecution
																						:CreateClosingUponFailureInternalErrorPart1
																						:CreateClosingUponFailureInternalErrorPart2
																						:UpdateCreateHeaderKMSMessage
																						:SendDIPtoKMS
																					)
																]
															)																														
										]
									)
				] .

:GenericInteractionPRAKSISScenarioBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Generic Interaction Behaviour for PRAKSIS Scenarios" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
										[
											a bt:Sequence ;
											bt:hasChildren (
																:EventHandlerFirstInteractionMove
																:UpdateBehaviorRunning
																:DeletePrecondition
																:DeleteSSCResultinLSR
																[
																	a bt:IsSucceeding ;
																	bt:hasChild 	
																					:UpdateEmptyExecutionRepository
																]
																[
																	a bt:IsSucceeding ;
																	bt:hasChild 	
																				:DeleteActiveDIPinAgentKB
																]
																[
																	a bt:Priority ;
																	bt:hasChildren (
																						[
																							a bt:Sequence ;
																							bt:hasChildren (
																												:ConditionServiceFirstInteraction																							
																												[
																													a bt:Priority ;
																													bt:hasChildren (
																																		[
																																			a bt:Sequence ;
																																			bt:hasChildren (
																																								:ConditionFirstMovePreregistration
																																								:WriteObtainPersonalInformationDIP2Execution
																																							)
																																			
																																		]
																																		[
																																			a bt:Sequence ;
																																			bt:hasChildren (
																																								:ConditionFirstMoveSimulateAppointment
																																								:WriteScenarioIntroductionDIP2Execution
																																							)
																																		]
																																		[
																																			a bt:Sequence ;
																																			bt:hasChildren (
																																								:ConditionFirstMoveFullAsylumRegistraion
																																								:WriteScenarioIntroductionFullRegistrationDIP2Execution
																																							)
																																		]
																																		[
																																			a bt:Sequence ;
																																			bt:hasChildren (
																																								:ConditionFirstMoveCVCreation
																																								:WriteCVPurposeDIP2Execution
																																								[
																																									a bt:Priority ;
																																									bt:hasChildren (
																																														[
																																															a bt:Sequence ;
																																															bt:hasChildren (
																																																				:ConditionExistingIncompleteCV																																																																																												
																																																				:UpdateCVPurpose_ExistingIncompleteDIP2Execution
																																																			)
																																														]
																																														[
																																															a bt:Sequence ;
																																															bt:hasChildren (
																																																				:ConditionExistingCompleteCV																																																																																												
																																																				:UpdateCVPurpose_ExistingCompleteDIP2Execution
																																																			)
																																														]
																																														[
																																															a bt:Sequence ;
																																															bt:hasChildren (
																																																				:ConditionNoCV																																																																																												
																																																				:UpdateCVPurpose_NoCVDIP2Execution
																																																			)
																																														]
																																													)
																																								]
																																							)
																																		]
																																		[
																																			a bt:Sequence ;
																																			bt:hasChildren (
																																								:ConditionFirstMoveHealth
																																								:WriteScenarioIntroductionHealthDIP2Execution
																																							)
																																		]
																																	)
																													]
																											)																														
																						]
																						[
																							a bt:Sequence ;
																							bt:hasChildren (
																												[
																													a bt:IsSucceeding ;
																													bt:hasChild 	
																																:UpdateEmptyExecutionRepository
																												]
																												:WriteAgentNameinExecution
																												:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																												:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																												:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
																											)																														
																						]																																		
																					)																														
																]	
																:DeleteSSCResultinAgentKB
																#:DeleteFirstInteractionFlaginExecution	
																:DeleteFirstInteractionFlaginLAKR
																:UpdateCreateHeaderKMSMessage
																:SendDIPtoKMS																					
															)
										]
										[
											a bt:Sequence ;
											bt:hasChildren (
																:EventHandlerSpecificBT	
																[
																	a bt:IsSucceeding ;
																	bt:hasChild 	
																				:UpdateEmptyExecutionRepository
																]
																:WriteSpecificBTFlaginExecution																
																[
																	a bt:IsSucceeding ;
																	bt:hasChild 	
																					:DeleteSpecificBTFlaginAgentKB
																]
																:WriteActiveDIPinExecution
																[
																	a bt:Priority ;
																	bt:hasChildren (	
																						[
																							a bt:Sequence ;
																							bt:hasChildren (
																												:ConditionalFlagIncomplete
																												[
																													a bt:IsSucceeding ;
																													bt:hasChild 	
																																:DeleteActiveDIPinAgentKB
																												]																											
																												:SendIncompleteOrMultipleDIPDMS
																											)																														
																						]
																						[
																							a bt:Sequence ;
																							bt:hasChildren (
																												:ConditionalNormalClosing_ContactNGO_ClosingFailureComplete
																												:DeleteActiveDIPinAgentKB
																												#:SucessFinishScenario
																												:UpdateCreateHeaderAppMessage
																												:MessageSendDialogueFinishNotification
																											)																														
																						]
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionExecutePreregistrationBT
																																		:SpecificPreregistrationBT
																																	)
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionExecuteSimulateAppointmentBT
																																		:SpecificSimulateAppointmentBT
																																	)
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionExecuteFullAsylumRegistrationBT
																																		:EventProducerFullAsylumRegistrationBT
																																	)
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionExecuteHealthBT
																																		:EventProducerHealthBT
																																	)
																												]																												
																												:EventProducerExecuteCVCreationBT
																											)
																						]
																					)
																]
																:UpdateDeleteBehaviorRunning
															)
										]
									)
				] .

:SpecificPreregistrationBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Specific Preregistration Behavior Tree" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:UpdateBehaviorRunning																				
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:DeleteActiveDIPinExecution
										]
										:WriteActiveDIPinExecution
										:DeleteActiveDIPinAgentKB
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalUndefinedDIP
																						[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:UpdateEmptyExecutionRepository
																						]
																						:WriteAgentNameinExecution																						
																						:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part1
																						:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part2
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalObtainPersonalInfoCompleteAndFirstApplicationYes
																						:WriteInformAsylumClaimDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalObtainPersonalInfoCompleteAndFirstApplicationNot
																						:WriteInformContactPRAKSISDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformContactPRAKSIS_OR_InformInternetConnectionCompleteAndConfirmationYes
																						:WriteNormalClosingDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformContactPRAKSIS_ServiceNGOSupport_SkypeUSer_SkypeCallProcess_InternetConnection_DIPCompleteAndConfirmationNot
																						:UpdateCreateClosingUponFailureDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformAsylum_OR_AccountCreation_OR_NGOSupport_CompleteAndKnowledgeSkypeYes_InternetYes_ConfirmationYes
																						:WriteInformSkypeUserDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformAsylumClaimCompleteAndKnowledgeSkypeNot
																						:WriteInformSkypeAccountCreationDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformSkypeAccountCreationCompleteAndInternetAnswerNot
																						:WriteInformServiceNGOSupportDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformSkypeUserCompleteAndConfirmationYes
																						:WriteInformSkypeCallProcessDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformSkypeCallProcessCompleteAndConfirmationYes
																						:WriteInformInternetConnectionDIP2Execution
																					)																														
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:WriteAgentNameinExecution
																						[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:DeletePreviousDIPinExecution
																						]
																						:CreateClosingUponFailureInternalErrorPart1
																						:CreateClosingUponFailureInternalErrorPart2
																					)																														
																]
															)																														
										]
									:UpdateCreateHeaderKMSMessage
									:SendDIPtoKMS
									)
				] .	

:SpecificSimulateAppointmentBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Simulate Appointment Behavior Tree" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:UpdateBehaviorRunning																				
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:DeleteActiveDIPinExecution
										]
										:WriteActiveDIPinExecution
										:DeleteActiveDIPinAgentKB
										[
											a bt:Priority ;
											bt:hasChildren (
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalUndefinedDIP
																					:WriteAgentNameinExecution
																					[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:DeletePreviousDIPinExecution
																					]
																					:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part1
																					:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part2
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalAnyConfirmInfoNot_UndefinedValue
																					[
																						a bt:IsSucceeding ;
																						bt:hasChild 	
																										:UpdateEmptyExecutionRepository
																					]
																					:WriteAgentNameinExecution
																					:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part1
																					:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part2
																					:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part3
																					:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part4
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalContactNGOFarewellSimulationYes_MoreSimuYes
																					:WriteScenarioIntroductionDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalContactNGOFarewellSimulationYesNot_MoreSimuNot
																					:WriteAgentNameinExecution
																					[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:DeletePreviousDIPinExecution
																					]
																					:UpdateCreateNormalClosingFarewellS2bDIP2Execution_Part1 
																					:UpdateCreateNormalClosingFarewellS2bDIP2Execution_Part2 
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalScenarioIntroductionYes
																					:WriteSimulationIntrodutionDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalScenarioIntroNot_AppointmentSummary_AppointmentRejectedCallbackComplete
																					:WriteAgentNameinExecution
																					[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:DeletePreviousDIPinExecution
																					]
																					:UpdateCreateNormalClosingFarewellS2bDIP2Execution_Part1 
																					:UpdateCreateNormalClosingFarewellS2bDIP2Execution_Part2 
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalSimulationIntroComplete
																					:WritePRAKSISCardDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalPRAKSISCardYes_PremisesVisitYes_AltAuthenOfficer
																					:WriteMatterConcernIdentificationDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalPRAKSISCardNotOfficer_Lawyer
																					:WriteFirstContactInformationDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalMatterConcernIdentificationComplete
																					:WriteLawyerAvailabilityCheckingDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalLawyerAvailabilityCheckingYes
																					:WriteAvailabilityRejectedDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalLawyerAvailabilityCheckingNot
																					:WriteAgentNameinExecution
																					[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:DeletePreviousDIPinExecution
																					]
																					:UpdateCreateClosingUponFailureFarewellNoCheckingDIP2Execution_Part1
																					:UpdateCreateClosingUponFailureFarewellNoCheckingDIP2Execution_Part2
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalAvailabilityRejectedComplete
																					:WriteLegalServiceCallbackDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalLegalServiceCallbackYes
																					:WriteScenarioIntroductionDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalLegalServCallback_PremisesVisit_InformDetails_AforetimeAppReminderNot
																					:WriteAgentNameinExecution
																					[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:DeletePreviousDIPinExecution
																					]
																					:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																					:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																					:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalCardYes_AltAuthen_PremVisitYesLawyer
																					:WriteMakeAppointmentDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalFirstContactYes
																					:WritePremisesVisitDescriptionDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalFirstContactNot
																					:WriteAlternativeAuthentificationDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalMakeAppointmentYes
																					:WriteObtainTCNInformationDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalMakeAppointmentNot
																					:WriteAppointmentRejectedCallbackDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalObtainTCNInfoComplete_CardYes
																					:WriteInformDetailsAppointmentDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalObtainTCNInfoComplete_CardNot
																					:WriteAforetimeAppointmentReminderDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					:ConditionalInformDetails_AforetimeAppReminderYes
																					:WriteAppointmentSummaryDIP2Execution
																				)																														
															]
															[
																a bt:Sequence ;
																bt:hasChildren (
																					[
																						a bt:IsSucceeding ;
																						bt:hasChild 	
																									:UpdateEmptyExecutionRepository
																					]
																					:WriteAgentNameinExecution
																					:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part1
																					:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part2
																)																														
															]
														)
										]
										:UpdateCreateHeaderKMSMessage
										:SendDIPtoKMS
									)
				] .		

:SpecificFullAsylumRegistrationBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Full Asylum Registration Behavior Tree" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:UpdateBehaviorRunning																				
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:DeleteActiveDIPinExecution
										]
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren(
																						:EventHandlerExecuteAsylumRegistration
																						:WriteActiveDIPinExecution
																						:DeleteActiveDIPinAgentKB
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalUndefinedDIP
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																							:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part1
																																		:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part2
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAnyConfirmInfoNot_UndefinedValue
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																							:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalScenarioIntroductionAndInterestYes
																																		:WriteAsylumPreRegistrationDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalScenarioIntroductionAndInterestNot_RegistrationProcessDetailsNot_AsylumServiceAppNot
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																							:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateNormalClosingFarewellS2aDIP2Execution_Part1
																																		:UpdateCreateNormalClosingFarewellS2aDIP2Execution_Part2 																																		
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAsylumPreRegistrationYes
																																		:WriteAsylumApplicationKnowledgeDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAsylumPreRegistrationNot
																																		:WriteAsylumClaimRegistrationDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAsylumApplicationKnowledgeYes
																																		:WriteRegistrationProcessDetailsDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAnyConfirmInfoTCNAnswerNot
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																							:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
																																		
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalBeginFillingOnlineFormPreregistrationNumUnknown
																																		:WriteAgentNameinExecution
																																		[
																																				a bt:IsSucceeding ;
																																				bt:hasChild 	
																																						:DeletePreviousDIPinExecution
																																		]
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3																																
																																		
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAppliKnowledgeNot
																																		:WriteAgentNameinExecution
																																			[
																																					a bt:IsSucceeding ;
																																					bt:hasChild 	
																																							:DeletePreviousDIPinExecution
																																			]
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
																																		
																																	)																														
																												]																											
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalRegistrationProcessDetailsYes
																																		:WriteAsylumServiceAppDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAsylumServiceAppYes
																																		:WriteWebsiteProcedureDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalWebsiteProcedureConfirmationYes
																																		:WriteBeginFillingOnlineFormDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalBeginFillingOnlineFormNumberKnown
																																		:WriteIdentificationStepSurnameDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalIdentificationStepSurnameConfirmationYes
																																		:WriteIdentificationStepNameDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalIdentificationStepNameConfirmationYes
																																		:WriteIdentificationStepBirthdateDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalIdentificationStepBirthdateConfirmationYes
																																		:WriteIdentificationStepTelephoneDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalIdentificationStepTelephoneConfirmationYes
																																		:WriteIdentificationStepCaptchaDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalIdentificationStepCaptchaConfirmationYes
																																		:WritePrefilledFormVisualizationDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalPrefilledFormVisualizationYes																																		
																																		:WritePrefilledFormDisclaimerDIP2Execution
																																		:UpdateCreateHeaderAppMessageDisplay
																																		:MessageSendDisplayNotification2App
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalPrefilledFormVisualizationNot_PrefilledFormPrintedNot
																																		:WriteLoginStepDIP2Execution 
																																	)																														
																												]
																												#[
																												#	a bt:Sequence ;
																												#	bt:hasChildren (
																												#						:ConditionalPrefilledFormDisclaimerConfirmationYes
																												#						:WritePrefilledFormUsageDIP2Execution
																												#					)																														
																												#]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalPrefilledFormUsageConfirmationYes
																																		:WritePrefilledFormPrintedDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalLoginStepConfirmationYes
																																		:WriteLanguageStepDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalLanguageStepConfirmationYes
																																		:WriteAdditionalQuestionsDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalPrefilledFormPrintedYes
																																		:UpdateCreateHeaderAppMessageDisplay
																																		[
																																			a bt:Invert ;
																																			bt:hasChild 
																																						:SendPrintNotification2App																												
																																		]																																		
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAdditionalQuestionsCompleted
																																		:UpdateCreateHeaderAppMessage
																																		[
																																			a bt:Invert ;
																																			bt:hasChild 
																																						:MessageSendDialogueFinishNotification																											
																																		]																																		
																																	)																														
																												]
																												#[
																												#	a bt:Sequence ;
																												#	bt:hasChildren (
																												#						:WriteAgentNameinExecution
																												#						[
																												#							a bt:IsSucceeding ;
																												#							bt:hasChild 	
																												#									:DeletePreviousDIPinExecution
																												#						]
																												#						:UpdateCreateClosingUponFailureFarewellUnknownDIP
																												#					)																														
																												#]
																											)
																						]
																				  )
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren(
																					:EventHandlerDisplayedForm
																					:WritePrefilledFormUsageDIP2Execution
																				  )
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren(
																					:EventHandlerPrintedForm
																					:WriteLoginStepDIP2Execution
																				  )
																]
															)
										]
										:UpdateCreateHeaderKMSMessage
										:SendDIPtoKMS
									)
				] .	
				
:SpecificCVCreationBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "CV Creation Behavior Tree" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:UpdateBehaviorRunning									
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren(
																					:EventHandlerCVNotification
																					[
																						a bt:IsSucceeding ;
																						bt:hasChild 	
																								:UpdateEmptyExecutionRepository
																					]
																					:WriteNotificationToExecution
																					:DeleteS7NotificationFromLAKR
																					[
																						a bt:Priority ;
																						bt:hasChildren (
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsPersonalInfoFinished
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendPersonalInfoSectionToApp 
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsEducationInformationFinished
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendEducationInformationSectionToApp 
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsOtherEducationInformationFinished
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendOtherEducationInformationSectionToApp 
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsLanguageInformationFinished
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendLanguageInformationSectionToApp 
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsEmploymentInformationFinished
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendEmploymentInformationSectionToApp 
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsSkillInformationFinished
																																	#:UpdateCreateHeaderAppMessageSkillList
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendSkillNotificationtoApp																																																															
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionIsOtherInformationFinished
																																	:UpdateCreateHeaderAppMessageDisplay
																																	:MessageSendOtherInformationSectionToApp 
																																)																														
																											]
																											#[
																											#	a bt:Sequence ;
																											#	bt:hasChildren (
																											#						:ConditionCreateCVDocumentFinished
																											#						:UpdateCreateHeaderAppMessageDisplay
																											#						:MessageSendCreateCVDocumentSectionToApp 
																											#					)																														
																											#]
																										)																														
																					]
																				  )
																]
																[
																	a bt:Sequence ;
																	bt:hasChildren(
																						:EventHandlerExecuteCVCreationBT
																						[
																							a bt:IsSucceeding ;
																							bt:hasChild 	
																									:UpdateEmptyExecutionRepository
																						]
																						:WriteActiveDIPinExecution
																						:DeleteActiveDIPinAgentKB
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalUndefinedDIP
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																							:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part1
																																		:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part2
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAnyConfirmInfoNot_UndefinedValue
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																							:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
																																		:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalCVPurposeInterestYes																																		
																																		:WritePersonalInfoDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalCVPurposeInterestNot
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																					:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution	
																																		:UpdateCreateInformContactNGOFarewell_GENERIC_DIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewell_GENERIC_DIP2Execution_Part2
																																		:UpdateCreateInformContactNGOFarewell_GENERIC_DIP2Execution_Part3
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalPersonalInfoConfirmationYes
																																		:WriteEducationInformationDIP2Execution 
																																	)																														
																												] 
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalEducationInformationConfirmationYes
																																		:WriteOtherEducationInformationDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalOtherEducationInformationConfirmationYes
																																		:WriteLanguageInformationDIP2Execution 
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalLanguageInformationConfirmationYes
																																		:WriteEmploymentInformationDIP2Execution 
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalEmploymentInformationConfirmationYes
																																		#:UpdateCreateHeaderAppMessageSkillList
																																		#:MessageSendSkillNotificationtoApp
																																		:WriteSkillInformationDIP2Execution																																		
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalSkillInformation
																																		:WriteOtherInformationDIP2Execution 	
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalOtherInformationConfirmationYes
																																		:UpdateCreateHeaderAppMessageDisplay
																																		:MessageSendCVCreatedNotificationtoApp
																																		:WriteCreateCVDocumentDIP2Execution
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalCreateCVDocumentYes
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																						:UpdateEmptyExecutionRepository
																																						
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateNormalClosingS7DIP2Execution_Part1
																																		:UpdateCreateNormalClosingS7DIP2Execution_Part2
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																					:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part1
																																		:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part2
																																	)																														
																												]
																											)
																						]
																						:UpdateCreateHeaderKMSMessage
																						:SendDIPtoKMS
																				  )
																]																
															)
										]										
									)
				] .	


:SpecificHealthBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Health Behavior Tree: Master" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:HandleEventMasterHealthBT
										:UpdateBehaviorRunning									
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:UpdateEmptyExecutionRepository
										]
										:WriteActiveDIPinExecution	
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalMasterDIP
																																		[
																																			a bt:Priority ;
																																			bt:hasChildren (
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														:ConditionalExecuteMedicalEmergency
																																														:WritePublicLegislationDIP2Execution
																																													)																														
																																								]
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														
																																														:ConditionalExecutePersonalDoctorRegistration																																	
																																														:WriteSSNumberDIP2Execution
																																													)																														
																																								]
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																														:ConditionalAllSubTopicsInformed																																	
																																														[
																																															a bt:IsSucceeding ;
																																															bt:hasChild 	
																																																	:UpdateEmptyExecutionRepository
																																														]
																																														:WriteAgentNameinExecution
																																														:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part1
																																														:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part2 	
																																													)																														
																																								]
																																								[
																																									a bt:Sequence ;
																																									bt:hasChildren (
																																															[
																																																a bt:IsSucceeding ;
																																																bt:hasChild 	
																																																				:UpdateEmptyExecutionRepository
																																															]
																																															:WriteAgentNameinExecution
																																															:UpdateCreateClosingUponFailureUnknownTopicDIP2Execution_Part1
																																															:UpdateCreateClosingUponFailureUnknownTopicDIP2Execution_Part2
																																													)																														
																																								]
																																							)																														
																																		]
																																	)																														
																												]																
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalUndefinedDIP
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																						:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part1
																																		:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part2
																																	)																														
																												]
																												[
																													a bt:Sequence ;
																													bt:hasChildren (
																																		:ConditionalAnyConfirmInfoNot_UndefinedValue
																																		[
																																			a bt:IsSucceeding ;
																																			bt:hasChild 	
																																						:UpdateEmptyExecutionRepository
																																		]
																																		:WriteAgentNameinExecution
																																		:UpdateCreateInformContactNGOFarewell_S5DIP2Execution_Part1
																																		:UpdateCreateInformContactNGOFarewell_S5DIP2Execution_Part2
																																	)																														
																												]
																							)
																						]
																						:DeleteActiveDIPinAgentKB
																						:UpdateCreateHeaderKMSMessage
																						:SendDIPtoKMS
																					)																														
																]
																:EventProducerInformFirstTopic
																
															)																														
										]
										:UpdateDeleteTopicSelected
										:UpdateDeleteBehaviorRunning
					)
				] .	
				
:MedicalEmergencyHealthBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Health Behavior Tree: Medical Emergency" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:EventHandlerMedicalEmergency
										:UpdateBehaviorRunning									
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:UpdateEmptyExecutionRepository
										]
										:WriteActiveDIPinExecution								
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalInformFAQ_NotORContactNGOSubTopic_Yes
																						:DeleteActiveDIPinAgentKB
																						:UpdateCreateHeaderKMSMessage
																						:MessageMedicalEmergencyInformed
																					)																														
																]																
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalPublicLegislation_Yes
																																	:WriteInformFAQDIP2Execution
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalPublicLegislation_Not
																																	[
																																		a bt:IsSucceeding ;
																																		bt:hasChild 	
																																			:UpdateEmptyExecutionRepository
																																	]
																																	:WriteAgentNameinExecution
																																	:UpdateCreateContactNGOSubTopicDIP2Execution_Part1
																																	:UpdateCreateContactNGOSubTopicDIP2Execution_Part2
																																	:UpdateCreateContactNGOSubTopicDIP2Execution_Part3
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalContactNGOSubTopic_Not
																																	[
																																		a bt:IsSucceeding ;
																																		bt:hasChild 	
																																						:UpdateEmptyExecutionRepository
																																	]
																																	:WriteAgentNameinExecution
																																	:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part1
																																	:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part2
																																)																														
																											]
																							)
																						]
																						:DeleteActiveDIPinAgentKB
																						:UpdateCreateHeaderKMSMessage
																						:SendDIPtoKMS
																	)																														
																]
																:EventProducerInformSecondTopic
															)																														
										]
										:UpdateDeleteBehaviorRunning
					)
				] .	
				
:InformOnlineDoctorRegistrationBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Health Behavior Tree: Online Registration to Doctor" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:EventHandlerOnlineDoctorRegistration
										:UpdateBehaviorRunning									
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
														:UpdateEmptyExecutionRepository
										]
										:WriteActiveDIPinExecution										
										[
											a bt:Priority ;
											bt:hasChildren (
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						:ConditionalTaxisnetApplication_Yes
																						:DeleteActiveDIPinAgentKB
																						:UpdateCreateHeaderKMSMessage
																						:MessageOnlineDoctorRegistrationInformed
																					)																														
																]																
																[
																	a bt:Sequence ;
																	bt:hasChildren (
																						[
																							a bt:Priority ;
																							bt:hasChildren (
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalSSNumber_Yes
																																	:WriteSSRightsDIP2Execution
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalSSNumber_Otherwise
																																	:WriteAssignedPAAYPADIP2Execution
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalSSNumber_NotORAssignedPAAYPA_Yes
																																	:WriteSSInfoinFAQDIP2Execution
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalSSRights_Yes
																																	:WritePersonalDocRegistrationDIP2Execution
																																)																														
																											]
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalPersonalDocRegistration_Yes
																																	:WriteTaxisnetApplicationDIP2Execution
																																)																														
																											]																												
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	:ConditionalSSRightsORDocRegORAssignedPAAYPAORSSFAQORTaxiApp_Not
																																	[
																																		a bt:IsSucceeding ;
																																		bt:hasChild 	
																																			:UpdateEmptyExecutionRepository
																																	]
																																	:WriteAgentNameinExecution
																																	:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part1
																																	:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part2
																																)																														
																											]	
																											[
																												a bt:Sequence ;
																												bt:hasChildren (
																																	[
																																		a bt:IsSucceeding ;
																																		bt:hasChild 	
																																					:UpdateEmptyExecutionRepository
																																	]
																																	:WriteAgentNameinExecution
																																	:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part1
																																	:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part2
																												)																														
																											]																											
																											
																							)
																						]
																						:DeleteActiveDIPinAgentKB
																						:UpdateCreateHeaderKMSMessage
																						:SendDIPtoKMS
																	)																														
																]
															)																														
										]
										:UpdateDeleteBehaviorRunning
					)
				] .	
				
:ExternalFAQBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "External FAQ Behavior Tree" ;
	bt:hasChild [
		a bt:Sequence ;
		bt:hasChildren (
							:EventHandlerRetrievedExternalFAQs
							[
								a bt:IsSucceeding ;
								bt:hasChild 	
										:UpdateEmptyExecutionRepository
							]
							:WriteExternalFAQNotifiationToExecution
							:UpdateDeleteExternalFAQNotificationAgentKnowledge
							#:ConditionExternalFAQ
							:UpdateCreateHeaderAppMessageFAQSuggestion
							:MessageSendFoundFAQtoApp																	
						)
				] .
				
:InternalFAQBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Internal FAQ Behavior Tree" ;
	bt:hasChild [
		a bt:Sequence ;
		bt:hasChildren (
							:EventHandlerRetrievedInternalFAQs
							[
								a bt:IsSucceeding ;
								bt:hasChild 	
										:UpdateEmptyExecutionRepository
							]
							:WriteInternalFAQNotifiationToExecution
							:UpdateDeleteInternalFAQNotificationAgentKnowledge
							:WriteAgentNameinExecution
							:UpdateCreateFAQDIPinExecution_Part1
							:UpdateCreateFAQDIPinExecution_Part2
							:UpdateCreateFAQDIPinExecution_Part3
							:UpdateCreateFAQDIPinExecution_Part4
							:UpdateCreateFAQDIPinExecution_Part5
							:UpdateCreateFAQDIPinExecution_Part6
							:UpdateCreateFAQDIPinExecution_Part7
							:UpdateCreateFAQDIPinExecution_Part8
							:UpdateCreateHeaderKMSMessage
							:SendDIPtoKMS							
						)
				] .
				
:AgentShutdown
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Agent Shutdown Behavior Tree" ;
	bt:hasChild [
		a bt:Sequence ;
		bt:hasChildren (
							:EventHandlerShutdown
							:UpdateEmptyExecutionRepository
							:WriteThisAgentIdToEKB
							:WriteLAR2EKB
							[
								a bt:Priority ;
								bt:hasChildren (
													[
														a bt:Sequence ;
														bt:hasChildren (
																			[
																				a bt:Priority ;
																				bt:hasChildren (																	
																									:ConditionAgentRunningBT
																									:ConditionAgentIn_Coordination																			
																								)																														
																			]
																			:UpdateAgentRunningYes																			
																		)																														
													]
													:UpdateAgentRunningNot
												)																														
							]
							:MessageSendShutdownNotification
						)
				] .


# -------------------------------------------	
# ----------- S9  -----------
# -------------------------------------------

#-------------CHC Protocol BTs START--------------------------

:CHCProtocolBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "CHC Protocol Behavior Tree" ;
	bt:hasChild [
		a bt:UntilFail ;
		bt:hasChild [
				a bt:Sequence ;
				bt:hasChildren (
									:HandleCHCProtocolEvent
									:WriteThisAgentIdToEKB
									[
										a bt:Priority ;
										bt:hasChildren (
															[
																a bt:Sequence ;
																bt:hasChildren (
																				:ConditionAgentRunningCHCProcess
																				:MessageAlreadyRunningCHCProcess
																				)
															]
															:EventProducerExecuteCHCProcessEvent
														)
									]
								)
					]
				] .

:ExecutingPreCHCProcessBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Executing Pre-CHC Process BT Behavior Tree" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
										[
											a bt:Sequence ;
											bt:hasChildren (
													:HandleExecuteCHCProcessEvent
													[
														a bt:IsSucceeding ;
														bt:hasChild 	
																	:UpdateEmptyExecutionRepository
													]
													:WriteThisAgentIdToEKB
													:Message2AppStartingCHC
													:Message2KMSLocationPreference													
											)
										]
										:EventProducerCHCFailureEvent
									)
				] .

:ExecutingMainCHCProcessBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Executing Main CHC Process BT Behavior Tree" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
										[
											a bt:Sequence ;
											bt:hasChildren (
															:EventHandlerLARPopulated4CHC
															[
																a bt:IsSucceeding ;
																bt:hasChild 	
																			:RemoveLARContent
															]															
															:WriteRelevantAgentsInLAR
															[
																a bt:IsSucceeding ;
																bt:hasChild 	
																			:UpdateEmptyExecutionRepository
															]
															:WriteThisAgentIdToEKB
															:CHCStartFlagOn
															:Message2WPMUpdateStatus2InCoordination															
															:WriteChcProblemInstance2Execution
															:WriteChcPiAndChcRunningFlag2Lakr
															:UpdateExtractChcPersonalInfo
															:WritePersonalInfoRequestContent2Execution
															:WriteDedicatedAndParticipantAgentinLAR
															:ConditionMoreThanOneAgent
															:Broadcast4PersonalInfo
															:DeleteDedicatedAndParticipantAgentfromLAR
															:InsertCHCWasBroadcasted2Execution
															:UpdateSetTimer
															[
																a bt:UntilSuccess ;
																bt:hasChild [
																		a bt:Sequence ;
																		bt:hasChildren (
																							:Wait4ChcPersonalInfo
																							:UpdateTimer
																							[
																								a bt:Priority ;
																								bt:hasChildren (
																													[
																														a bt:Invert ;
																														bt:hasChild
																																:ConditionAnyoneNotReturnedPersonalInfo
																													]
																													[
																														a bt:Sequence ;
																														bt:hasChildren (
																																			:ConditionMaxWaitingTimeReached
																																			:RemoveNotRespondingAgentsFromCHCProblemInstance
																																			[
																																				a bt:Sequence ;
																																				bt:hasChildren (
																																									#:ConditionAtLeastOneParticipant
																																									:WriteNotRespodingAgentsinLAR
																																									:BroadcastFail4NotResponding
																																									:DeleteListNotRespondingAgents2LAKR
																																									:DeleteListNotRespondingAgents2LAR
																																								)
																																			]
																																			# If no one responds to Dedicated, then dedicated removes them all from
																																			# use case problem instance. Then since there is no participant agent
																																			# anymore, Dedicated fails to send the broadcasts.
																																			# However, this is not an error. Since an important step fails in
																																			# the protocol, Dedicated produces CHCFailure Event.
																																			# Then it informs the app that chc failed. So the process fails successfully.
																																			
																														)
																													]
																												)
																							]
																						)
																]
															]
															:WriteSimilaritiesRequestContent2Execution
															:WriteDedicatedAndParticipantAgentinLAR
															:Broadcast4SimilarityValues
															:DeleteDedicatedAndParticipantAgentfromLAR
															:WriteCHCPreferences2Execution
															:ComputeSimilarities4CHC
															:WriteSimilarities2LAKR
															:UpdateSetSimilarityTimer
															[
																a bt:UntilSuccess ;
																bt:hasChild [
																		a bt:Sequence ;
																		bt:hasChildren (																					
																							:Wait4SimilarityValues
																							:UpdateSimilarityTimer
																							[
																								a bt:Priority ;
																								bt:hasChildren (
																													[
																														a bt:Sequence ;
																														bt:hasChildren (
																																			:ConditionEveryoneReturnedSimilarities
																																			:EventProducerSolverCHCEvent
																																		)
																													]
																													[
																														a bt:Sequence ;
																														bt:hasChildren (
																																			:ConditionMaxSimilarityWaitingTimeReached
																																			:EventProducerCHCFailureEvent
																																		)
																													]
																												)
																							]
																						)
																]
															]
											)
										]
										:EventProducerCHCFailureEvent
									)
				] .
											
:SharingCHCPersonalInfoBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "SharingCHCPersonalInfoBT Behavior Tree" ;
	bt:hasChild [
		a bt:UntilFail ;
		bt:hasChild [
				a bt:Sequence ;
				bt:hasChildren (
							:HandleShareCHCPersonalInfoEvent
							[
								a bt:IsSucceeding ;
								bt:hasChild 	
										:UpdateEmptyExecutionRepository
							]
							:WriteDedicated2Execution
							:UpdateDeleteDedicatedfromLSR
							:WriteCHCPersonalInfo2Exec
							:Message2DedicatedChcPersonalInfo
							:Message2WPMUpdateStatus2InCoordination
							:AddAgentInvolvedInCHCFlag
							# CHC Personal Info is written from A.K to E.K. Then I attach the Id of CHC Process to the CHC Personal Info and send this info to
							# Dedicated agent. Lastly, I write "?agent :isInvolvedInCHC ?chcId." to A.K.
							# If it is necessary to write the CHC Personal Info for a particular CHC Process (i.e. set of triples in which CHC Id is attached to Personal Info),
							# then add an extra write node at the end or modify "WriteAgentInvolvedInCHC" node.							
							)
					]
				] .

:ReceiveCHCPersonalInfoBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "ReceiveCHCPersonalInfoBT Behavior Tree" ;
	bt:hasChild [
		a bt:UntilFail ;
		bt:hasChild [
				a bt:Sequence ;
				bt:hasChildren (
							:HandleReceiveCHCPersonalInfoEvent
							#:WritePersonalInfo2LAKR
								)
					]
				] .


:SharingCHCSimilaritiesBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "SharingCHCSimilaritiesBT Behavior Tree" ;
	bt:hasChild [
			a bt:UntilFail ;
			bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:HandleShareCHCSimilaritiesEvent
										[
											a bt:IsSucceeding ;
											bt:hasChild 	
													:UpdateEmptyExecutionRepository
										]
										:WriteCopyPIfromLSR2Execution
										:UpdateRemovePIfromLSR
										:WriteParticipantAgentEmail2LAKR
										:WriteCHCPreferences2Execution
										:ComputeSimilarities4CHC
										:MessageSimilarities2Dedicated
										:WriteSimilarities2LAKR
										
									)
						]
				] .

:ReceivingCHCSimilaritiesBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "ReceivingCHCSimilaritiesBT Behavior Tree" ;
	bt:hasChild [
			a bt:UntilFail ;
			bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
								:HandleReceiveCHCSimilaritiesEvent
								#:WriteReceivedSimilarities2LAKR
								)
						]
				] .

:SolvingCHCBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "SolvingCHCBT Behavior Tree" ;
	bt:hasChild [
					a bt:Priority ;
					bt:hasChildren (
									[
										a bt:Sequence ;
										bt:hasChildren (
												:HandleSolveCHCEvent
												[
													a bt:IsSucceeding ;
													bt:hasChild 	
															:UpdateEmptyExecutionRepository
												]										
												:ComputeCHCReciprocalSimilarities
												:ComputeCHCConstraints
												:WriteReciprocalScores2Lakr
												:ClusteringSolver_HDBSCAN
												:WriteCHCResultRequestContent2Execution
												:WriteDedicatedAndParticipantAgentinLAR
												:BroadcastHDBSCANResult
												:DeleteDedicatedAndParticipantAgentfromLAR
												:EventProducerFinalizeCHCProcessEvent
										)
									]
									:EventProducerCHCFailureEvent
					)
				] .

:FinalizingCHCProcessBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "Finalizing CHC Process Behavior Tree" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
								:HandleFinalizeCHCProcessEvent
								[
									a bt:IsSucceeding ;
									bt:hasChild 	
											:UpdateEmptyExecutionRepository
								]
								:WriteCopyResult2Execution
								:UpdateDeleteResultfromLSR
								:WriteThisAgentIdToEKB
								[
									a bt:IsSucceeding ;
									bt:hasChild 	
											:DeleteDedicatedAndParticipantAgentfromLAR
								]
								[
									a bt:Priority ;
									bt:hasChildren (
														[
															a bt:Sequence ;
															bt:hasChildren (
																			:ConditionCHCSucceeded
																			:WriteEmails2Execution																			
																			[
																				a bt:IsSucceeding ;
																				bt:hasChild 	
																						:UpdateDeletePreviousResultMessages
																			]
																			:WriteCHCResultMessage2Execution
																			:Message2WPMResultOfCHC
																			:Message2AppCHCFinished
																			:UpdateDeletePersonalInfoFromLAKR
																			:WriteCHCResult2Lakr
															)
														]
														[
															a bt:Sequence ;
															bt:hasChildren (
																:Message2AppChcFailure
																:UpdateChcStatus2Failure
															)
														]
									)
								]
								[
									a bt:Priority ;
									bt:hasChildren (
														[
															a bt:Sequence ;
															bt:hasChildren (
																				:ConditionIsANotRespondingAgent
																				:RemoveAgentInCHC
																			)
														]
														:RemoveAgentInCHCAndComputeRuntime
													)
								]
								:UpdateAgentRunningChcFlagOff
								[
									a bt:Priority ;
									bt:hasChildren (
														:ConditionAgentInAnyMAC
														:Message2WPMUpdateStatus2Active
													)
								]
					)
				] .

:CHCFailureBT
	a bt:BehaviorTree ;
	a bt:Root ;
	rdfs:label "CHC Process/Protocol Failure Behavior Tree" ;
	bt:hasChild [
					a bt:Sequence ;
					bt:hasChildren (
										:HandleCHCFailureEvent
										:WriteThisAgentIdToEKB
										:EventProducerFinalizeCHCProcessEvent
										[
											a bt:Priority ;
											bt:hasChildren (
													[
														a bt:Invert ;
														bt:hasChild 
															:ConditionWasCHCBuiltAndBroadcasted
													]
													[
														a bt:Sequence ;
														bt:hasChildren (
																			:WriteDedicatedAndParticipantAgentinLAR
																			:BroadcastCHCFailed
																			:DeleteDedicatedAndParticipantAgentfromLAR
																		)
													]
											)
										]

									)
				] .
				
# -------------------------------------------	
# ----------- Standard Primitives -----------
# -------------------------------------------	

#=============================================================================================
# InitialBT

:UpdateBehaviorRunning
	a bt:Update ;
	rdfs:label "Update: Write agentRunning Flag in the LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>									
					INSERT {
						?agent welcome:hasBTRunning "true"^^xsd:boolean .
					}
					 WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateDeleteBehaviorRunning
	a bt:Update ;
	rdfs:label "Update: Delete agentRunning Flag in the LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>									
					DELETE {
						?agent welcome:hasBTRunning ?val .
					}
					 WHERE {
						?agent rdf:type ajan:Agent .
						?agent welcome:hasBTRunning ?val .
					}"""^^xsd:string ;
		]) .
		
:ConditionLARPopulated
	a bt:Condition ;
	rdfs:label "Condition: LAR initialized?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					ASK
					WHERE {
						?agent rdf:type ajan:Agent .
						?agent ?p ?o .	
					}"""^^xsd:string ;
		]) .

:EventProducerPopulateLAR
	a bt:EventProducer ;
	rdfs:label "EventProducer: Request Populate LAR" ;
	ajan:event agents:PopulateLAREvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:needsPopulateLAR "localRepo" .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	

:ConditionLSRPopulated
	a bt:Condition ;
	rdfs:label "Condition: LSR initialized?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					ASK
					WHERE {
						?service rdf:type service:Service.	
					}"""^^xsd:string ;
		]) .
		
:EventProducerPopulateLSR
	a bt:EventProducer ;
	rdfs:label "EventProducer: Request Populate LSR" ;
	ajan:event agents:PopulateLSREvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:needsPopulateLSR "localRepo" .
							<http://mycontext> <http://www.ajan.de/behavior/bt-ns#rdfContext> <http://localhost:8090/rdf4j/repositories/agents#PopulateLSREvent> .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	

#=============================================================================================
# FinalBT

:DeleteTemporalFlagsinLAKR
	a bt:Update ;
	rdfs:label "Update: Delete Flags in LAKR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					DELETE {
						?MatchmakerOffer welcome:hasPrecondition ?precondition .
						?MatchmakerResult ssc:hasServiceName ?servName .	
						?agent welcome:hasBTRunning ?val .
						?query welcome:hasPreconditionResult ?preconVal .
						welcome:myWelcomeAgent welcome:hasFirstMove ?result .
						?bt welcome:hasActiveDIP ?id .	
						?dip welcome:hasNamedGraph ?dipGraph .
					}
					 WHERE {
						?s ?o ?p .
						OPTIONAL {
							{?MatchmakerOffer welcome:hasPrecondition ?precondition .}
							UNION
							{?MatchmakerResult ssc:hasServiceName ?servName .}	
							UNION
							{?agent welcome:hasBTRunning ?val .}
							UNION
							{?query welcome:hasPreconditionResult ?preconVal .}
							UNION
							{welcome:myWelcomeAgent welcome:hasFirstMove ?result .}
							UNION
							{?bt welcome:hasActiveDIP ?id .}
							UNION
							{?dip welcome:hasNamedGraph ?dipGraph .}
						}
					}					
					"""^^xsd:string ;
		]) .
		
:DeleteTemporalFlagsinLSR
	a bt:Update ;
	rdfs:label "Update: Delete Flags in LSR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					DELETE {
						?ssc ssc:hasResultOffer ?MatchmakerOffer .	
					}
					WHERE {
						?s ?o ?p .
						OPTIONAL {
							?ssc ssc:hasResultOffer ?MatchmakerOffer .	
						}
					}					
					"""^^xsd:string ;
		]) .

#=============================================================================================
# HeartbeatMonitoringBT

:AgentMonitoringHandleEvent
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Heartbeat Monitoring" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#AgentMonitoringEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE { 
							?s ?p ?o .				
						}"""^^xsd:string ;
				] .
	
#=============================================================================================
#ErrorHandlingBT	

:ReceiveErrorHandleEvent
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Error Handling" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ErrorHandlingEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
						PREFIX wex: <http://welcome.org/integration/pipeline/exception#>
						CONSTRUCT {
							?error rdf:type wex:WelcomePipelineException .
							?error ?propError ?objError .
						}
						WHERE { 
							?error rdf:type wex:WelcomePipelineException .
							?error ?propError ?objError .
						}"""^^xsd:string ;
				] .

:ConditionKMSError
	a bt:Condition ;
	rdfs:label "Condition: Error in KMS?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX wex: <http://welcome.org/integration/pipeline/exception#>
					ASK
					WHERE {
						?error rdf:type wex:WelcomePipelineException .
						?error wex:hasCode ?errorCode .
						FILTER (CONTAINS(str(?errorCode), "KMS"))						
					}"""^^xsd:string ;
		]) .

:UpdateCreateClosingUponFailureFarewellKMSError_Part1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - KMS Error - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					PREFIX wex: <http://welcome.org/integration/pipeline/exception#>
					INSERT {
						welcome:ClosingUponFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailureFarewell welcome:hasDIPStatus welcome:Incomplete .
						welcome:ClosingUponFailureFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonTError40_4 .
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .				
						welcome:reifiedReasonTError40_4 rdf:type rdf:Statement .
						welcome:reifiedReasonTError40_4 rdf:subject welcome:subTemplate .
						welcome:reifiedReasonTError40_4 rdf:predicate welcome:isReason .
						welcome:reifiedReasonTError40_4 rdf:object "TError40_4"^^xsd:string .
					} WHERE { 
						?error rdf:type wex:WelcomePipelineException .
					}"""^^xsd:string ;
		]) .

:UpdateCreateClosingUponFailureFarewellKMSError_Part2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - KMS Error - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					PREFIX wex: <http://welcome.org/integration/pipeline/exception#>
					INSERT {
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informClosingFailureFarewell .
						welcome:informClosingFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasTemplateId "TInformClosingFailureFarewell"^^xsd:string . 
						welcome:informClosingFailureFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:hasStatus welcome:Pending .
						welcome:informClosingFailureFarewell welcome:hasNumberAttempts 0 .
						welcome:informClosingFailureFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informClosingFailureFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informClosingFailureFarewell welcome:dependsOn welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?error rdf:type wex:WelcomePipelineException .
					}"""^^xsd:string ;
		]) .
																						
:UpdateEmptyExecutionRepository
	a bt:Update ;
	rdfs:label "Update: Empty Execution Repository" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE{
						?s ?p ?o .
					}
					WHERE { 
						?s ?p ?o .
					}
					"""^^xsd:string ;
		]) .
#=============================================================================================
# PopulateReposBT
																
:EventHandlerRequestLSRTriples
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Request Populate LSR" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#PopulateLSREvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:needsPopulateLSR "localRepo" .
						}
						WHERE { 
							welcome:myWelcomeAgent welcome:needsPopulateLSR "localRepo" .				
						}"""^^xsd:string ;
				] .

:UpdateCreateHeaderDispatcherMessage
	a bt:Update ;
	rdfs:label "Update: Header Message for Dispatcher" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE{
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .
					}
					INSERT {
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .						
					} 
					WHERE { 
						?msg welcome:hasCorrelationID ?correlationID .
						?du rdf:type welcome:DialogueUser .
						?du welcome:hasUserId ?idObject .
						?idObject welcome:hasValue ?id .
					}
					"""^^xsd:string ;
		]) .
		
:MessageSendLSRMessageWPM
	a <http://www.ajan.de/myWelcome-ns#Message> ;
	rdfs:label "Message: Request KBS populate LSR" ;
	rdfs:comment "Message: Request KBS populate LSR" ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	<http://www.ajan.de/myWelcome-ns#correlatorId> [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/trig"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
						CONSTRUCT {					
							?agent rdf:type ajan:Agent .
						}
						WHERE {
							?agent rdf:type ajan:Agent .					
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/globalRepository?repository=wsr") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/kms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:DefaultFailed
	a bt:Fail ;
	rdfs:label "Default Fail - Successful Request to KBS"^^xsd:string .
	
:EventHandlerRequestLARTriples
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Request Populate LAR" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#PopulateLAREvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """						
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:needsPopulateLAR "localRepo" .
						}
						WHERE { 
							welcome:myWelcomeAgent welcome:needsPopulateLAR "localRepo" .
						}"""^^xsd:string ;
				] .

:MessageSendLARMessageWPM
	a <http://www.ajan.de/myWelcome-ns#Message> ;
	rdfs:label "Message: Request KBS populate LAR" ;
	rdfs:comment "Message: Request KBS populate LAR" ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	<http://www.ajan.de/myWelcome-ns#correlatorId> [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
						CONSTRUCT {					
							?agent rdf:type ajan:Agent .
						}
						WHERE {
							?agent rdf:type ajan:Agent .					
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
       		  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/globalRepository?repository=war") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/kms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:EventHandlerReceiveLocalServices
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Receive Local Services" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ReceiveLocalServicesEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """"""^^xsd:string ;
				] .

#:ConditionNoAgentPopulation
#	a bt:Condition ;
#	rdfs:label "Condition: Agent Population?" ;
#	bt:query ( [
#		a bt:AskQuery ;
#		bt:originBase ajan:ExecutionKnowledge ;
#		bt:sparql """
#					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
#					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
#					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
#					ASK
#					WHERE {
#						?agentName rdf:type ajan:Agent .
#					}"""^^xsd:string ;
#		]) .
		
:RemoveLSRContent
	a bt:Update ;
	rdfs:label "Update: Remove LSR Content" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					DELETE {
						?s ?o ?p .
					}
					 WHERE {
						?s ?o ?p .
					}					
					"""^^xsd:string ;
		]) .

:UpdateLSRAgentKnowledge
	a bt:Update ;
	rdfs:label "Delete LSR Agent Knowledge" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				DELETE {
					?agent welcome:knowsLocalServices ajan:LocalServicesKnowledge .	
				}
				INSERT {
					?agent welcome:needsPopulateLSR "localRepo" .
				}
				WHERE {
					?agent rdf:type ajan:Agent .
				}		"""^^xsd:string ;
		]) .
		
#:WriteTriplesLSR
#	a bt:Write ;
#	rdfs:label "Write Triples in LSR" ;
#	bt:query [
#		a bt:ConstructQuery ;
#		bt:originBase ajan:ExecutionKnowledge ;
#		bt:targetBase ajan:LocalServicesKnowledge ;
#		bt:sparql """
#			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
#			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
#			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
#			PREFIX owl: <http://www.w3.org/2002/07/owl#>
#			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
#			CONSTRUCT  {
#			  ?s ?o ?p .
#			}
#			WHERE { 
#			  SELECT DISTINCT ?s ?o ?p 
#			  WHERE {
#				?s ?o ?p .
#				?a rdf:type service:Service .
#			  }
#			} """^^xsd:string ;
#	] .

:PluginOWL2PDDL
	a ssc:PDDLConverter ;
	rdfs:label "Plugin: Create PDDL Domain File" ;
	ssc:LocalServicesTriples [
				a bt:SelectQuery ;
				bt:originBase ajan:LocalServicesKnowledge ;
				bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				SELECT ?s ?o ?p ?g
				WHERE {
					{ GRAPH ?g { ?s ?o ?p } }
				}"""^^xsd:string ;
			] .	

:UpdateAgentKnowsLSR
	a bt:Update ;
	rdfs:label "Update: Agent Knows LSR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					DELETE {
						welcome:myWelcomeAgent welcome:needsPopulateLSR "localRepo" .
					}
					INSERT {
						?agent welcome:knowsLocalServices ajan:LocalServicesKnowledge .	
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}					
					"""^^xsd:string ;
		]) .

:WriteTriplesLSRC1
	a bt:Write ;
	rdfs:label "Write Triples in LSR for C1 - PreregistrationProcedureService" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalServicesKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX owl: <http://www.w3.org/2002/07/owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
                    CONSTRUCT {
                        ?s ?p ?o .
            <http://mycontext1> <http://www.ajan.de/behavior/bt-ns#rdfContext> <file://C:/fakepath/PreregistrationProcedureService.owl> .
                    }

                        WHERE { GRAPH <file://C:/fakepath/PreregistrationProcedureService.owl> {?s ?p ?o .} } """^^xsd:string ;
	] .

:WriteTriplesLSRC2
	a bt:Write ;
	rdfs:label "Write Triples in LSR for C2 - SimulateAppointmentService" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalServicesKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX owl: <http://www.w3.org/2002/07/owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
                    CONSTRUCT {
                        ?s ?p ?o .
            <http://mycontext2> <http://www.ajan.de/behavior/bt-ns#rdfContext> <file://C:/fakepath/SimulateAppointmentService.owl> .
                    }

                        WHERE { GRAPH <file://C:/fakepath/SimulateAppointmentService.owl> {?s ?p ?o .} } """^^xsd:string ;
	] .

:WriteTriplesLSRC3
	a bt:Write ;
	rdfs:label "Write Triples in LSR for C3 - FullRegistration.owl" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalServicesKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX owl: <http://www.w3.org/2002/07/owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
                    CONSTRUCT {
                        ?s ?p ?o .
            <http://mycontext3> <http://www.ajan.de/behavior/bt-ns#rdfContext> <file://C:/fakepath/FullPreregistration.owl> .
                    }

                        WHERE { GRAPH <file://C:/fakepath/FullPreregistration.owl> {?s ?p ?o .} } """^^xsd:string ;
	] .

:WriteTriplesLSRC4
	a bt:Write ;
	rdfs:label "Write Triples in LSR for C4 - CreateCV" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalServicesKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX owl: <http://www.w3.org/2002/07/owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
                    CONSTRUCT {
                        ?s ?p ?o .
            <http://mycontext4> <http://www.ajan.de/behavior/bt-ns#rdfContext> <file://C:/fakepath/CreateCV.owl> .
                    }

                        WHERE { GRAPH <file://C:/fakepath/CreateCV.owl> {?s ?p ?o .} } """^^xsd:string ;
	] .
	
:WriteTriplesLSRC5
	a bt:Write ;
	rdfs:label "Write Triples in LSR for C5 - Health" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalServicesKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX owl: <http://www.w3.org/2002/07/owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
                    CONSTRUCT {
                        ?s ?p ?o .
            <http://mycontext5> <http://www.ajan.de/behavior/bt-ns#rdfContext> <file://C:/fakepath/Health.owl> .
                    }

                        WHERE { GRAPH <file://C:/fakepath/Health.owl> {?s ?p ?o .} } """^^xsd:string ;
	] .
	
:UpdateLSRExecutionKnowledge
	a bt:Update ;
	rdfs:label "Update: LSR in Execution Knowledge" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 	
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX owl: <http://www.w3.org/2002/07/owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			DELETE {
				?s ?p ?o .
			}WHERE {
				?s ?p ?o .
			}"""^^xsd:string ;
		]) .
		
:EventHandlerReceiveLocalAgents
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Receive Local Agents" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ReceiveLocalAgentsEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .
				
:RemoveLARContent
	a bt:Update ;
	rdfs:label "Update: Remove LAR Content" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					DELETE {
						?s ?o ?p .
					}
					WHERE {
						?s ?o ?p .
					}					
					"""^^xsd:string ;
		]) .

:UpdateLARAgentKnowledge
	a bt:Update ;
	rdfs:label "Delete LAR Agent Knowledge" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				DELETE {
					?agent welcome:knowsLocalAgents ?repoName .	
				}
				INSERT {
					?agent welcome:needsPopulateLAR "localRepo" .
				}				
				WHERE {
					?agent rdf:type ajan:Agent .
				}"""^^xsd:string ;
		]) .

:WriteTriplesLAR
	a bt:Write ;
	rdfs:label "Write Triples in LAR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			CONSTRUCT { 
				?s ?p ?o .
				?s rdf:type ajan:Agent .
			} WHERE  {
				?s ?p ?o .
				?s rdf:type ajan:Agent .
			}"""^^xsd:string ;
	] .
	
:UpdateAgentKnowsLAR
	a bt:Update ;
	rdfs:label "Update: Agent Knows LAR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					DELETE {
						welcome:myWelcomeAgent welcome:needsPopulateLAR "localRepo" .
					}
					INSERT {
						?agent welcome:knowsLocalAgents ajan:LocalAgentsKnowledge .	
					}
					 WHERE {
						?agent rdf:type ajan:Agent .
					}					
					"""^^xsd:string ;
		]) .
		
:UpdateLARExecutionKnowledge
	a bt:Update ;
	rdfs:label "Update: LAR in Execution Knowledge" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 					
					DELETE {
						?s ?p ?o .
						?s rdf:type ajan:Agent.
					} WHERE { 						
						?s ?p ?o .
						?s rdf:type ajan:Agent .
						
					}"""^^xsd:string ;
		]) .
		
#=============================================================================================
# HandshakeBT

:EventHandlerHandshake
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Handshake" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ReceiveHandshakeEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
						CONSTRUCT {
							?sub rdf:type welcome:Handshaking .
						}
						WHERE { 
							?sub rdf:type welcome:Handshaking .
							?s ?p ?o .
						} """^^xsd:string ;
				] .

:UpdateCreateHeaderAppMessage
	a bt:Update ;
	rdfs:label "Update: Header Message for App" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE{
						?headerSubject welcome:hasHeaderValue ?typeval .
						?headerValSubject welcome:hasHeaderValue ?typeHeaderval .
					}
					INSERT {
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .					
						welcome:headerMsgType welcome:hasHeaderName "X-Msg-Type" .
						welcome:headerMsgType welcome:hasHeaderValue "DisplayUI " .
					} 
					WHERE { 
						?du rdf:type welcome:DialogueUser .
						?msg welcome:hasCorrelationID ?correlationID .
						?du welcome:hasUserId ?idObject .
						?idObject welcome:hasValue ?id .
						OPTIONAL {?headerSubject welcome:hasHeaderValue ?typeval .}
						OPTIONAL {?headerValSubject welcome:hasHeaderValue ?typeHeaderval .}
					}
					"""^^xsd:string ;
		]) .

:ConditionIsTCNLogged
	a bt:Condition ;
	rdfs:label "Condition: Is TCN Logged in the App?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE {
						?du welcome:isLogged ?log .
						FILTER (STRENDS(str(?log), "Yes") || STRENDS(str(?log), "yes") || STRENDS(str(?log), "True") || STRENDS(str(?log), "true"))
					}"""^^xsd:string ;
		] .
		
:MessageSendAgentReadiness
	a myWelcome:Message ;
	rdfs:label "Message: Send Agent Readiness to App - Handshake"^^xsd:string ;
	rdfs:comment "Message: Send Agent Readiness to App - Handshake"^^xsd:string ;
	bt:targetBase ajan:AgentKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							?agent welcome:hasMessage "is ready" .
						}
						WHERE {
							?agent rdf:type ajan:Agent .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

#:DeleteHeaderDispatcherMessageinLAKR
#	a bt:Update ;
#	rdfs:label "Update: Delete Header Readiness Message in LAKR" ;
#	bt:query ([
#		a bt:UpdateQuery ;
#		bt:originBase ajan:AgentKnowledge ;
#		bt:sparql """
#					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
#					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#					DELETE {
#						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
#						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
#						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
#						welcome:headerUserID welcome:hasHeaderValue ?userID .						
#					} 
#					WHERE { 
#						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
#						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
#						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
#						welcome:headerUserID welcome:hasHeaderValue ?userID .
#					}
#					"""^^xsd:string ;
#		]) .
#=============================================================================================
# ProcessSpeechActsBehavior

:EventSpeaktoavatar
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Speak to Avatar" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#SpeakAvatarEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
						CONSTRUCT {						    
							welcome:TCN_SpeakToAvatar rdf:type welcome:speakToAvatar .
						}
						WHERE { 
							welcome:TCN_SpeakToAvatar rdf:type welcome:speakToAvatar .
						}"""^^xsd:string ;
				] .

:WriteAgentNameinExecution
	a bt:Write ;
	rdfs:label "Write: Agent Name in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 	
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			CONSTRUCT  {
				?agentName rdf:type ajan:Agent .
			}
			WHERE { 
				?agentName rdf:type ajan:Agent .
			} """^^xsd:string ;
	] .
	
:UpdateCreateOpeningDIPPart1
	a bt:Update ;
	rdfs:label "Update: Create Opening DIP 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 					
					INSERT {
						welcome:Opening rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .	
						welcome:Opening welcome:hasDIPStatus welcome:Unknown .
						welcome:Opening welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:Opening welcome:hasSlot welcome:confirmCommunication .
						welcome:confirmCommunication rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
						welcome:confirmCommunication welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:confirmCommunication welcome:hasTemplateId "TConfirmCommunication"^^xsd:string .
						welcome:confirmCommunication welcome:hasInputRDFContents welcome:Unknown .
						welcome:confirmCommunication welcome:hasTCNAnswer welcome:Unknown .
						welcome:confirmCommunication welcome:hasStatus welcome:Pending .
						welcome:confirmCommunication welcome:hasNumberAttempts 0 .
						welcome:confirmCommunication welcome:confidenceScore "0.0"^^xsd:float .
						welcome:confirmCommunication welcome:isOptional "false"^^xsd:boolean .
						welcome:confirmCommunication welcome:dependsOn welcome:Unknown .
						welcome:confirmCommunication welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agentName rdf:type ajan:Agent .
					}
					"""^^xsd:string ;
		]) .

:UpdateCreateOpeningDIPPart2
	a bt:Update ;
	rdfs:label "Update: Create Opening DIP Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					INSERT {
						welcome:Opening welcome:hasSlot welcome:confirmLanguage .
						welcome:confirmLanguage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
						welcome:confirmLanguage	welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Language"^^xsd:anyURI .
						welcome:confirmLanguage welcome:hasTemplateId "TConfirmLanguage"^^xsd:string .
						welcome:confirmLanguage	welcome:hasInputRDFContents welcome:Unknown .
						welcome:confirmLanguage welcome:hasTCNAnswer welcome:Unknown .
						welcome:confirmLanguage	welcome:hasStatus welcome:Pending .
						welcome:confirmLanguage	welcome:hasNumberAttempts 0 .
						welcome:confirmLanguage	welcome:confidenceScore "0.0"^^xsd:float .
						welcome:confirmLanguage	welcome:isOptional "false"^^xsd:boolean .						
						welcome:confirmLanguage welcome:dependsOn welcome:Unknown .
						welcome:confirmLanguage welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agentName rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateOpeningDIPPart3
	a bt:Update ;
	rdfs:label "Update: Create Opening DIP Part 3" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					INSERT {
						welcome:Opening welcome:hasSlot welcome:obtainRequest .
						welcome:obtainRequest rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
						welcome:obtainRequest welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ServiceRequest"^^xsd:anyURI .
						welcome:obtainRequest welcome:hasTemplateId "TObtainMatterConcern"^^xsd:string .
						welcome:obtainRequest welcome:hasStatus welcome:Completed .
						welcome:obtainRequest welcome:hasNumberAttempts 0 .
						welcome:obtainRequest welcome:confidenceScore "0.0"^^xsd:float .	
						welcome:obtainRequest welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainRequest welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainRequest welcome:isOptional "false"^^xsd:boolean .	
						welcome:obtainRequest welcome:dependsOn welcome:Unknown .
						welcome:obtainRequest welcome:associatedWith welcome:Unknown .			
					} 
					WHERE { 
						?agentName rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateHeaderKMSMessage
	a bt:Update ;
	rdfs:label "Update: Header KMS Message" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue . 						
					} 
					INSERT {
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .	
					} 
					WHERE { 						
						?msg welcome:hasCorrelationID ?correlationID .
						OPTIONAL {?headerName welcome:hasHeaderName ?hdrName . }
						OPTIONAL {?headerName welcome:hasHeaderValue ?fieldValue . }					
					}
					"""^^xsd:string ;
		]) .
		
:SendDIPtoKMS
	a myWelcome:Message ;
	rdfs:label "Message: Send DIP to KMS"^^xsd:string ;
	rdfs:comment "Message: Send DIP to KMS"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle;charset=UTF-8" 
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/plain"
				]
		) ;	
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .	
							?dip welcome:hasDIPStatus ?status .
							?dip welcome:isCurrentDIP ?isCurrentValue .
							?dip welcome:belongsTo ?someService . 
							?dip welcome:hasSlot ?slotDIP .
							?slotDIP rdf:type ?slotType .
							?slotDIP welcome:hasOntologyType ?slotOntoType .
							?slotDIP welcome:hasInputRDFContents ?slotRDFContents .
							?slotRDFContents ?reifiRDFContentsPred ?reifiRDFContentsObj .
							?slotDIP welcome:hasStatus ?slotStatus .
							?slotDIP welcome:hasNumberAttempts ?NbAttempts .
							?slotDIP welcome:confidenceScore ?confScore .
							?slotDIP welcome:isOptional ?opt .
							?slotDIP welcome:dependsOn ?dependency .
							?slotDIP welcome:associatedWith ?association .
							?slotDIP welcome:hasTemplateId ?templateID .
							?slotDIP welcome:hasTCNAnswer welcome:Unknown .
						}
						WHERE {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .	
							?dip welcome:hasDIPStatus ?status .
							?dip welcome:isCurrentDIP ?isCurrentValue .
							OPTIONAL { ?dip welcome:belongsTo ?someService . }
							?dip welcome:hasSlot ?slotDIP .
							?slotDIP rdf:type ?slotType .
							?slotDIP welcome:hasOntologyType ?slotOntoType .
							?slotDIP welcome:hasInputRDFContents ?slotRDFContents .
							OPTIONAL { ?slotRDFContents ?reifiRDFContentsPred ?reifiRDFContentsObj .}
							?slotDIP welcome:hasStatus ?slotStatus .
							?slotDIP welcome:hasNumberAttempts ?NbAttempts .
							?slotDIP welcome:confidenceScore ?confScore .
							?slotDIP welcome:isOptional ?opt .
							OPTIONAL { ?slotDIP welcome:hasTemplateId ?templateID . }
							OPTIONAL {?slotDIP welcome:hasTCNAnswer ?tcnAnswer .}
							OPTIONAL {?slotDIP welcome:dependsOn ?dependency .}
						    OPTIONAL {?slotDIP welcome:associatedWith ?association .}
						}"""^^xsd:string
			]
		] ;    
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					SELECT ?requestURI
					WHERE {
					  welcome:KMS welcome:hasURI ?requestURI .
					}"""^^xsd:string
	] .
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/kms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

#:UpdateExecutionDeleteDIP
#	a bt:Update ;
#	rdfs:label "Update: Delete DIP from Execution" ;
#	bt:query ( [
#		a bt:UpdateQuery ;
#		bt:originBase ajan:ExecutionKnowledge ;
#		bt:sparql """
#					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
#					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#					PREFIX welcomeService: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
#					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>								
#					DELETE {
#						?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
#						?dip welcome:hasDIPStatus ?status .
#						?dip welcome:isCurrentDIP "true"^^xsd:boolean .
#						?dip welcome:hasSlot ?slots .
#						?slots rdf:type ?slotType .
#						?slots welcome:hasOntologyType ?ontoType .
#						?slots welcome:hasInputRDFContents ?RDFContents .
#						?slots welcome:hasTCNAnswer ?tcnAnswer .						
#						?slots welcome:hasStatus ?slotsStatus .		
#						?slots welcome:hasNumberAttempts ?NbAttempts .
#						?slots welcome:confidenceScore ?confScore .
#						?slots welcome:isOptional ?optional .	
#						?slots welcome:hasTemplateId ?templateID .
#						?slots welcome:dependsOn ?dependency .
#						?slots welcome:associatedWith ?association .						
#					} WHERE { 
#						?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
#						?dip welcome:hasDIPStatus ?status .
#						?dip welcome:isCurrentDIP "true"^^xsd:boolean .
#						?dip welcome:hasSlot ?slots .
#						?slots rdf:type ?slotType .
#						?slots welcome:hasOntologyType ?ontoType .
#						?slots welcome:hasInputRDFContents ?RDFContents .	
#						?slots welcome:hasStatus ?slotsStatus .		
#						?slots welcome:hasNumberAttempts ?NbAttempts .
#						?slots welcome:confidenceScore ?confScore .
#						?slots welcome:isOptional ?optional .	
#						OPTIONAL {?slots welcome:hasTemplateId ?templateID .}
#						OPTIONAL {?slots welcome:hasTCNAnswer ?tcnAnswer .}
#						OPTIONAL {?slots welcome:dependsOn ?dependency .}
#						OPTIONAL {?slots welcome:associatedWith ?association .}
#					}"""^^xsd:string ;
#		]) .

:EventDIP_OR_ServiceRequest
	a bt:HandleEvent ;
	rdfs:label "EventHandler: DIP OR Service Request" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#EventDIPORServiceRequest> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
						CONSTRUCT {								
							?dip welcome:hasNamedGraph ?dipGraph .
							welcome:BT welcome:hasActiveDIP ?dipId .					
						}
						WHERE { 
								?dip welcome:hasNamedGraph ?dipGraph .
								?dip welcome:DIPId ?dipId .
						}"""^^xsd:string ;
				] .

:DeletePreviousDIPinExecution
	a bt:Update ;
	rdfs:label "Update: Delete Previous DIP in Execution" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX welcomeService: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					DELETE {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:hasSlot ?slot .
							?dip welcome:DIPId ?dipid .
							?dip welcome:isCurrentDIP ?current .							
							?slot rdf:type ?slottype .
							?slot welcome:hasInputRDFContents ?rdfcontents .
							?slot welcome:hasOntologyType ?ontotype .
							?slot welcome:hasStatus ?statusslot . 
							?slot welcome:confidenceScore ?scoreslot .
							?slot welcome:hasNumberAttempts ?attp .
							?slot welcome:isOptional ?opt .
							?slot welcome:dependsOn ?dependency .
							?slot welcome:associatedWith ?association .
							?slot welcome:hasTemplateId ?slottemplate . 
							?slot welcome:hasTCNAnswer ?tcnAnswer . 
							?dip welcome:hasDIPStatus ?statusdip .
							?dipName welcome:hasNamedGraph ?dipGraph . 
							?bt welcome:hasActiveDIP ?dipIdVal .
							?dip welcome:belongsTo ?someService .
							?rdfcontents ?relrdfcontents ?objrdfcontents .	
							?tcnAnswer ?reltcnAnswer ?objtcnAnswer .
					}
					WHERE {		
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:hasSlot ?slot .
							?dip welcome:DIPId ?dipid .
							?dip welcome:isCurrentDIP ?current .					
							?slot rdf:type ?slottype .
							?slot welcome:hasInputRDFContents ?rdfcontents .
							?slot welcome:hasOntologyType ?ontotype .
							?slot welcome:hasStatus ?statusslot . 
							?slot welcome:confidenceScore ?scoreslot .
							?slot welcome:hasNumberAttempts ?attp .
							?slot welcome:isOptional ?opt .
							OPTIONAL { ?slot welcome:hasTemplateId ?slottemplate . }
							OPTIONAL { ?slot welcome:hasTCNAnswer ?tcnAnswer . }
							OPTIONAL { ?dip welcome:hasDIPStatus ?statusdip .}
							OPTIONAL { ?dipName welcome:hasNamedGraph ?dipGraph . }
							OPTIONAL { ?bt welcome:hasActiveDIP ?dipIdVal . }
							OPTIONAL { ?dip welcome:belongsTo ?someService .}
							OPTIONAL {?slot welcome:dependsOn ?dependency .}
							OPTIONAL {?slot welcome:associatedWith ?association .}
							OPTIONAL {?rdfcontents ?relrdfcontents ?objrdfcontents .}
							OPTIONAL {?tcnAnswer ?reltcnAnswer ?objtcnAnswer .}
					}"""^^xsd:string ;
		]) .

:WriteActiveDIPinExecution
	a bt:Write ;
	rdfs:label "Write: Active DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
			PREFIX welcomeService: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>			
			CONSTRUCT  {
				?bt welcome:hasActiveDIP ?dipId . 
				?dip welcome:hasNamedGraph ?dipGraph .
				?s ?p ?o .
			}
			WHERE { 
				?bt welcome:hasActiveDIP ?dipId . 
				?dip welcome:hasNamedGraph ?dipGraph .
				{	GRAPH ?dipGraph {?s ?p ?o . }}
			} """^^xsd:string ;
	] .

:ConditionDIPIncomplete
	a bt:Condition ;
	rdfs:label "Condition: DIP Incomplete?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX welcomeServices: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX fn: <http://www.w3.org/2005/xpath-functions#>
					ASK
					WHERE { 
							{
								?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								?dip welcome:hasSlot ?slot .
								?dip welcome:DIPId ?id .
								?slot welcome:hasStatus ?status .
								?slot welcome:hasNumberAttempts ?NbAtt .
							}
							FILTER (regex(str(?status), "Pending") || regex(str(?status), "FailedAnalysis") || regex(str(?status), "PendingAgreement") || regex(str(?status), "TCNElaborateRequest") || regex(str(?status), "TCNClarifyRequest") || regex(str(?status), "TopicSwitch") || regex(str(?status), "UnclearAnalysis"))
					}"""^^xsd:string ;
		]) .

:UpdateIncompleteDIP
	a bt:Update ;
	rdfs:label "Update: DIP Incomplete" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					DELETE {
						?dip welcome:hasDIPStatus ?statusDIP .	
					} INSERT {
						?dip welcome:hasDIPStatus welcome:Incomplete .
					}
					WHERE {
						?dip welcome:hasNamedGraph ?dipGraph .
						welcome:BT welcome:hasActiveDIP ?dipId .
						GRAPH ?dipGraph {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							OPTIONAL { ?dip welcome:hasDIPStatus ?status . }
							?dip welcome:DIPId ?dipId .
						}					
					}"""^^xsd:string ;
		]) .

:EventProducerSpecificBTDIPIncomplete
	a bt:EventProducer ;
	rdfs:label "EventProducer: Trigger Specific BT - Incomplete DIP" ;
	ajan:event agents:SpecificBTEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:execute "IncompleteDIP" .							
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	
				
:ConditionDIPCompleteOrUndefinedOrUnfinished
	a bt:Condition ;
	rdfs:label "Condition: DIP Complete or Undefined or Unfinished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX welcomeServices: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX fn: <http://www.w3.org/2005/xpath-functions#>
					ASK
					WHERE { 
							{
								{
									?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
									?dip welcome:hasSlot ?slot .
									?dip welcome:DIPId ?id .
									?slot welcome:hasStatus ?status .
									?slot welcome:hasNumberAttempts ?NbAtt .
								}
								FILTER (
									  !regex(str(?status), "Pending") && 
									  !regex(str(?status), "FailedAnalysis") && 
									  !regex(str(?status), "PendingAgreement") && 
									  !regex(str(?status), "TCNElaborateRequest") && 
									  !regex(str(?status), "TCNClarifyRequest") && 
									  !regex(str(?status), "TopicSwitch") && 
									  !regex(str(?status), "UnclearAnalysis")
								)
							}
							UNION
							{
								?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								?dipName welcome:DIPId ?id .
								?dipName welcome:hasSlot ?mandatorySlotName.
								?mandatorySlotName welcome:hasStatus welcome:Undefined .
							}
							UNION
							{
								?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								?dipName welcome:DIPId ?id .
								?dipName welcome:hasSlot ?unfinishedSlotName.
								?unfinishedSlotName welcome:hasStatus welcome:Unfinished .
							}
					}"""^^xsd:string ;
		]) .

:UpdateCompleteDIP
	a bt:Update ;
	rdfs:label "Update: DIP Complete" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					DELETE { 
						?dip welcome:hasDIPStatus ?status . 
					} INSERT {
						?dip welcome:hasDIPStatus welcome:Complete .
					}
					WHERE {		
							?dip welcome:hasNamedGraph ?dipGraph .
							welcome:BT welcome:hasActiveDIP ?dipId .
							GRAPH ?dipGraph {
								?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								OPTIONAL {?dip welcome:hasDIPStatus ?status }.
								?dip welcome:DIPId ?dipId .
							}
					}"""^^xsd:string ;
		]) .

:ConditionDIPIsNotOpening
	a bt:Condition ;
	rdfs:label "Condition: Active DIP is not Opening?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcomeService: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					ASK
					WHERE { 
						?dip welcome:hasNamedGraph ?dipGraph .
						?dip welcome:DIPId ?id .  
						?stg welcome:hasActiveDIP ?id . 
						?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						FILTER (
							!(  STRENDS(str(?dip), "#Opening") ||
							    STRENDS(str(?dip), ":Opening") )
						) 						
					} """^^xsd:string ;
		]) .
		
:EventProducerSpecificBTDIPComplete
	a bt:EventProducer ;
	rdfs:label "EventProducer: Trigger Specific BT - Complete DIP" ;
	ajan:event agents:SpecificBTEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:execute "CompleteDIP" .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	

:ConditionalNoServiceRequest
	a bt:Condition ;
	rdfs:label "Condition: No Service Request?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					ASK 
					WHERE { 
							?dip welcome:hasNamedGraph ?dipGraph .
							GRAPH ?dipGraph 
							{
								FILTER NOT EXISTS {
													?container rdf:type welcome:SpeechActContainer .
													?container welcome:hasSpeechActType welcome:Commit .
												  }
							}							
					}"""^^xsd:string ;
		]) .

:CreateClosingUponFailureNoRequest_Part1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - No Service Request or No SSC output - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailure rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailure welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailure welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailure welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string .
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonNoFoundService .
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .						
					} WHERE { 
						?s rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:CreateClosingUponFailureNoRequest_Part2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - No Service Request or No SSC output - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
						welcome:reifiedReasonSTReasonNoFoundService rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonNoFoundService rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonNoFoundService rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonNoFoundService rdf:object "STReasonNoFoundService"^^xsd:string .
					} WHERE { 
						?s rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:ConditionServiceRequest
	a bt:Condition ;
	rdfs:label "Condition: Commit exists?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					ASK 
					WHERE { 
							?dip welcome:hasNamedGraph ?dipGraph .
							GRAPH ?dipGraph 
							{
								?container rdf:type welcome:SpeechActContainer .
								?container welcome:hasSpeechActType welcome:Commit .
							}							
					}"""^^xsd:string ;
		]) .

:DeletePreviousServiceRequestinExecution
	a bt:Update ;
	rdfs:label "Update: Delete Previous Service Request from Execution" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					DELETE {
							?container rdf:type welcome:SpeechActContainer .
							?container welcome:hasSpeechActType welcome:Commit .
							?container welcome:hasSpeechActObject ?o .
							?o rdf:type service:Service . 
							?o service:presents ?profile .
							?profile ?relprofile ?objprof .
					} WHERE { 
							?container rdf:type welcome:SpeechActContainer .
							?container welcome:hasSpeechActType welcome:Commit .
							?container welcome:hasSpeechActObject ?o .
							?o rdf:type service:Service . 
							?o service:presents ?profile .
							?profile ?relprofile ?objprof .
					}"""^^xsd:string ;
		]) .
		
:WriteServiceRequestinExecution
	a bt:Write ;
	rdfs:label "Write: Service Request in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#> 
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			CONSTRUCT  {
					?container rdf:type welcome:SpeechActContainer .
					?container welcome:hasSpeechActType welcome:Commit .
					?container welcome:hasSpeechActObject ?o .
					?o rdf:type service:Service . 
					?o service:presents ?profile .
					?profile ?relprofile ?objprof .	
			}
			WHERE { 
				?bt welcome:hasActiveDIP ?dipId . 
				?dip welcome:hasNamedGraph ?dipGraph .
				GRAPH ?dipGraph { 
					?container rdf:type welcome:SpeechActContainer .
					?container welcome:hasSpeechActType welcome:Commit .
					?container welcome:hasSpeechActObject ?o .
					?o rdf:type service:Service . 
					?o service:presents ?profile .
					?profile ?relprofile ?objprof .	
				}
			}"""^^xsd:string ;
	] .

:InvokeMatchmaker
	a ssc:ServiceComputing ;
	rdfs:label "SSC Plugin: Matchmaker" ;
	ssc:serviceRequest [
				a bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:targetBase ajan:LocalServicesKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
						PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 	
						PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>						
						CONSTRUCT {
							?o rdf:type service:Service . 
							?o service:presents ?profile .
							?profile ?relprofile ?objprof .
						}
						WHERE { 
							?s rdf:type welcome:SpeechActContainer .
							?s welcome:hasSpeechActType welcome:Commit .
							?s welcome:hasSpeechActObject ?o .
							?o rdf:type service:Service . 
							?o service:presents ?profile .
							?profile ?relprofile ?objprof .							
						} """^^xsd:string ;
			] ;
	ssc:serviceOffer [
				a bt:SelectQuery ;
				bt:originBase ajan:LocalServicesKnowledge ;
				bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					SELECT ?s ?o ?p ?g
					WHERE {
						{ GRAPH ?g { ?s ?o ?p } }
					}"""^^xsd:string ;
			] ;
	ssc:filterModel "text-similarity.filter"^^xsd:string .

:ConditionMatchmakerOutput
	a bt:Condition ;
	rdfs:label "Condition: MatchmakerOutput?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					ASK
					WHERE {
						?ssc ssc:hasResultOffer ?MatchmakerOffer .
						FILTER NOT EXISTS {?ssc ssc:hasResultOffer welcome:Unknown .}
					}"""^^xsd:string ;
		]) .
		
:PDDL2SPARQLPlugin
	a ssc:PDDL2SPARQL ;
	rdfs:label "PDDL2SPARQL Plugin: Map Precondition" ;
	ssc:servicePrecondition [
				a bt:ConstructQuery ;
				bt:originBase ajan:LocalServicesKnowledge ;
				bt:targetBase ajan:AgentKnowledge ;
				bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>	
					PREFIX pddlexpr: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/PDDLExpression.owl#>	
					PREFIX expr: <http://www.daml.org/services/owl-s/1.1/generic/Expression.owl#>
					CONSTRUCT {
						?MatchmakerOffer welcome:hasPrecondition ?precondition .
					}
					WHERE { 
						?ssc ssc:hasResultOffer ?MatchmakerOffer .
						GRAPH ?g {
							?MatchmakerOffer service:describedBy ?process .
							?process process:hasPrecondition ?precondClass .
							?precondClass expr:expressionBody ?precondition .
						}
					}"""^^xsd:string ;
			] .

:ConditionPreconditionHolds
	a bt:Condition ;
	rdfs:label "Condition: Precondition holds?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					ASK
					WHERE {
						?query welcome:hasPreconditionResult "true"^^<http://www.w3.org/2001/XMLSchema#boolean> .	
					}"""^^xsd:string ;
		]) .

:ConditionAtomicService	
	a bt:Condition ;
	rdfs:label "Condition: Atomic Service?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					ASK
					WHERE {
						?ssc ssc:hasResultOffer ?MatchmakerOffer .
						?MatchmakerOffer rdf:type service:Service .
						?MatchmakerOffer service:describedBy ?process .
						?process rdf:type process:AtomicProcess .
					}"""^^xsd:string ;
		]) .

:CreateAtomicServiceDIP
	a bt:Write ;
	rdfs:label "Write: Create DIP from Atomic" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						?dipName welcome:belongsTo ?matchmakerOffer .
						?dipName welcome:isCurrentDIP "true"^^xsd:boolean .
						?dipName welcome:hasDIPStatus welcome:Unknown .
						?dipName welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						?ssc ssc:hasResultOffer ?matchmakerOffer .
						?matchmakerOffer rdf:type service:Service .
						?service service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP ?dipName .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .
	
:ConditionComposedService
	a bt:Condition ;
	rdfs:label "Condition: Composed Service?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					ASK
					WHERE {
						?ssc ssc:hasResultOffer ?MatchmakerOffer .
						?MatchmakerOffer rdf:type service:Service .
						?MatchmakerOffer service:describedBy ?process .
						?process rdf:type process:CompositeProcess .
					}"""^^xsd:string ;
		]) .

:CreateComposedServiceDIP
	a bt:Write ;
	rdfs:label "Write: Create DIP from Composite" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						?atomicProcess rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						?atomicProcess welcome:belongsTo ?matchmakerOffer .
						?atomicProcess welcome:isCurrentDIP "true"^^xsd:boolean .
						?atomicProcess welcome:hasDIPStatus welcome:Unknown .
						?atomicProcess welcome:hasSlot ?inputAtomic .
						?inputAtomic rdf:type ?slotType .
						?inputAtomic welcome:hasOntologyType ?paramTypeInput .
						?inputAtomic welcome:hasTemplateId ?templateInput .
						?inputAtomic welcome:isOptional ?optionalOutput .
						?inputAtomic welcome:hasInputRDFContents welcome:Unknown .
						?inputAtomic welcome:hasTCNAnswer welcome:Unknown .
						?inputAtomic welcome:hasStatus welcome:Pending .
						?inputAtomic welcome:dependsOn ?dependency .
						?inputAtomic welcome:associatedWith ?association .
						?inputAtomic welcome:hasNumberAttempts 0 .
						?inputAtomic welcome:confidenceScore "0.0"^^xsd:float .	
			}
			WHERE { 
					{?ssc ssc:hasResultOffer ?matchmakerOffer .
					?matchmakerOffer service:describedBy ?Compositeprocess . 
					?Compositeprocess process:hasInput ?inputComposite .
					?perform process:process ?atomicProcess .
					?atomicProcess rdf:type process:AtomicProcess .	
					?atomicProcess process:hasInput ?inputAtomic .
					?inputAtomic rdf:type process:Input .					
					?perform process:hasDataFrom ?inputBinding .
					?inputBinding rdf:type process:InputBinding .
					?inputAtomic process:parameterType ?paramTypeInput .
					?inputAtomic welcome:hasSlotType ?slotType .										
					OPTIONAL { 
						?inputAtomic welcome:hasTemplateId ?templateInput .
					}
					?inputAtomic welcome:isOptional ?optionalOutput .					
					?inputBinding process:toParam ?inputAtomic .
					?inputBinding process:valueSource ?valOf .
					?valOf rdf:type process:ValueOf .
					?valOf process:theVar ?inputComposite .
					OPTIONAL {?inputAtomic welcome:dependsOn ?val}
					OPTIONAL {?inputAtomic welcome:associatedWith ?asso}
					BIND(IF(EXISTS{?inputAtomic welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
					BIND(IF(EXISTS{?inputAtomic welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association). 
					}					
			}"""^^xsd:string ;
	] .

:WriteSSCResultinAgentKB
	a bt:Write ;
	rdfs:label "Write: SSC Result in Agent KB" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>	
			PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			CONSTRUCT { 
				?sscSubj ssc:hasResultOffer ?MatchmakerOffer .
				?MatchmakerOffer ssc:hasServiceName ?servName .				
			} WHERE  {
				?sscSubj ssc:hasResultOffer ?MatchmakerOffer .
				?MatchmakerOffer rdf:type service:Service .
				?MatchmakerOffer service:presents ?profile .
				?profile profile:serviceName ?servName .
			}"""^^xsd:string ;
	] .

:EventProducerFirstInteractionMove
	a bt:EventProducer ;
	rdfs:label "EventProducer: Trigger First Interaction Move" ;
	ajan:event agents:FirstInteractionBTEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>	
						PREFIX profile: <http://www.daml.org/services/owl-s/1.1/Profile.owl#>
						PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:hasFirstMove "ServiceInteraction" .
						}
						WHERE {
							?s rdf:type ajan:Agent . 
						}"""^^xsd:string ;
				] .	

:EventProducerAlternativeFirstInteractionMove
	a bt:EventProducer ;
	rdfs:label "EventProducer: Trigger Alternative First Interaction Move" ;
	ajan:event agents:FirstInteractionBTEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:hasFirstMove "FirstAlternativeMove" .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	

:InvokePlanner
	a ssc:ServiceComputing ;
	rdfs:label "SSC Plugin: Planner" ;
	ssc:domainDefinition [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
				CONSTRUCT {
						?s welcome:hasPDDLDomain ?p .
				}
				WHERE { 
						?s welcome:hasPDDLDomain ?p .
				} """^^xsd:string ;
	] ;
	ssc:problemInit [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
					CONSTRUCT {
						?o welcome:hasInitState ?goal .
					}
					WHERE { 
						?s rdf:type welcome:SpeechActContainer .
						?s welcome:hasSpeechActType welcome:Commit .
						?s welcome:hasSpeechActObject ?o .
						?o welcome:hasInitState ?initialState .
					} """^^xsd:string ;
		] ;	
	ssc:problemGoal [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
				CONSTRUCT {
					?o welcome:hasGoalState ?goal .
				}
				WHERE { 
					?s rdf:type welcome:SpeechActContainer .
					?s welcome:hasSpeechActType welcome:Commit .
					?s welcome:hasSpeechActObject ?o .
					?o welcome:hasGoalState?initialState .
				} """^^xsd:string ;
	] .	

:ConditionPlannerOutput
	a bt:Condition ;
	rdfs:label "Condition: PlannerOutput?" ;
	bt:query ( [
		a bt:AskQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					ASK
					WHERE {
						?ssc ssc:hasComposedService ?compositeService .	
					}"""^^xsd:string ;
		]) .
		
:EventDefaultStatementNoOpinion
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Default Statement Non Opinion" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#EventStatementNonOpinion> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 						
						CONSTRUCT {						    
							?s rdf:type welcome:SpeechActContainer .
							?s welcome:hasSpeechActType welcome:Statement-non-opinion .
						}
						WHERE { 
							?s rdf:type welcome:SpeechActContainer .
							?s welcome:hasSpeechActType welcome:Statement-non-opinion .
						}"""^^xsd:string ;
				] .

:CreateClosingUponFailureInternalErrorPart1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - Internal Error Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailure rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailure welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailure welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailure welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 						
						welcome:informMessage welcome:hasStatus welcome:Pending .	
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?a rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:CreateClosingUponFailureInternalErrorPart2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - Internal Error Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .	
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonInternalFailure .
						welcome:reifiedReasonSTReasonInternalFailure rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonInternalFailure rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonInternalFailure rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonInternalFailure rdf:object "STReasonInternalFailure"^^xsd:string .
					} WHERE { 
						?a rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .


#=============================================================================================
#GenericInteractionPRAKSISScenarioBT

:EventHandlerFirstInteractionMove
	a bt:HandleEvent ;
	rdfs:label "EventHandler: First Scenario Specific Interaction Move" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#FirstInteractionBTEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 					
						PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>	
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:hasFirstMove ?val .
						}
						WHERE { 
							welcome:myWelcomeAgent welcome:hasFirstMove ?val .					
						}"""^^xsd:string ;
				] .

:DeletePrecondition
	a bt:Update ;
	rdfs:label "Update: Delete Service Precondition Result in LAKR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					DELETE {
						?MatchmakerOffer welcome:hasPrecondition ?precondition .
						?query welcome:hasPreconditionResult ?preconVal .	
					}
					 WHERE {
						?s ?p ?o .
						OPTIONAL { ?MatchmakerOffer welcome:hasPrecondition ?precondition .}
						OPTIONAL { ?query welcome:hasPreconditionResult ?preconVal .}
					}					
					"""^^xsd:string ;
		]) .

:DeleteSSCResultinLSR
	a bt:Update ;
	rdfs:label "Update: Delete SSC Result in LSR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>	
					DELETE {
						?sscSubj ssc:hasResultOffer ?MatchmakerOffer .
					}
					WHERE {		
						?sscSubj ssc:hasResultOffer ?MatchmakerOffer .
					}"""^^xsd:string ;
		]) .

:DeleteActiveDIPinExecution
	a bt:Update ;
	rdfs:label "Delete Previous Active DIP in Execution" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					DELETE {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:hasSlot ?slot .
							?dip welcome:DIPId ?dipid .
							?dip welcome:isCurrentDIP ?current .							
							?slot rdf:type ?slottype .
							?slot welcome:hasInputRDFContents ?rdfcontents .
							?slot welcome:hasOntologyType ?ontotype .
							?slot welcome:hasStatus ?statusslot . 
							?slot welcome:confidenceScore ?scoreslot .
							?slot welcome:hasNumberAttempts ?attp .
							?slot welcome:isOptional ?opt .
							?slot welcome:dependsOn ?dependency .
							?slot welcome:associatedWith ?association .
							?slot welcome:hasTemplateId ?slottemplate . 
							?slot welcome:hasTCNAnswer ?tcnAnswer . 
							?dip welcome:hasDIPStatus ?statusdip .
							?dipName welcome:hasNamedGraph ?dipGraph . 
							?bt welcome:hasActiveDIP ?activeId . 	
							?dip welcome:belongsTo ?someService .							
					}
					WHERE {		
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:hasSlot ?slot .
							OPTIONAL { ?dip welcome:DIPId ?dipid .}
							?dip welcome:isCurrentDIP ?current .							
							?slot rdf:type ?slottype .
							?slot welcome:hasInputRDFContents ?rdfcontents .
							?slot welcome:hasOntologyType ?ontotype .
							?slot welcome:hasStatus ?statusslot . 
							?slot welcome:confidenceScore ?scoreslot .
							?slot welcome:hasNumberAttempts ?attp .
							?slot welcome:isOptional ?opt .
							OPTIONAL { ?slot welcome:hasTemplateId ?slottemplate . }
							OPTIONAL { ?slot welcome:hasTCNAnswer ?tcnAnswer . }
							OPTIONAL { ?dip welcome:hasDIPStatus ?statusdip .}
							OPTIONAL { ?dipName welcome:hasNamedGraph ?dipGraph . }
							OPTIONAL { ?bt welcome:hasActiveDIP ?activeId . }
							OPTIONAL { ?dip welcome:belongsTo ?someService .}
							OPTIONAL {?slot welcome:dependsOn ?dependency .}
							OPTIONAL {?slot welcome:associatedWith ?association .}
					}"""^^xsd:string ;
		]) .
		
:ConditionServiceFirstInteraction
	a bt:Condition ;
	rdfs:label "Condition: First Move of a Found Service?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					ASK
					WHERE { 
							welcome:myWelcomeAgent welcome:hasFirstMove "ServiceInteraction".							
					}"""^^xsd:string ;
		]) .
		
:ConditionFirstMovePreregistration
	a bt:Condition ;
	rdfs:label "Condition: First Move for Preregistration BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							?sscSubj ssc:hasResultOffer preregistration:PreregistrationProcedureService .
					}"""^^xsd:string ;
		]) .
				
:WriteObtainPersonalInformationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Obtain Personal Information DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:ObtainPersonalInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:ObtainPersonalInformation welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:ObtainPersonalInformation welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:ObtainPersonalInformation welcome:hasDIPStatus welcome:Unknown .
							preregistration:ObtainPersonalInformation welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:ObtainPersonalInformation .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionFirstMoveSimulateAppointment			
	a bt:Condition ;
	rdfs:label "Condition: First Move for Simulate Appointment BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							?sscSubj ssc:hasResultOffer simulateAppointment:simulatePraksisAppointmentService .
					}"""^^xsd:string ;
		]) .

:WriteScenarioIntroductionDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Scenario Introduction DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:ScenarioIntroduction welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:ScenarioIntroduction welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:ScenarioIntroduction welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:ScenarioIntroduction welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:ScenarioIntroduction .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionFirstMoveFullAsylumRegistraion
	a bt:Condition ;
	rdfs:label "Condition: First Move for Full Asylum Registration BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							?sscSubj ssc:hasResultOffer fullpreregistration:fullAsylumRegistration .
					}"""^^xsd:string ;
		]) .
		
:WriteScenarioIntroductionFullRegistrationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Scenario Introduction DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:ScenarioIntroduction welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:ScenarioIntroduction welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:ScenarioIntroduction welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:ScenarioIntroduction welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:ScenarioIntroduction .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionFirstMoveCVCreation
	a bt:Condition ;
	rdfs:label "Condition: First Move for CV Creation BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							?sscSubj ssc:hasResultOffer employment:createCV .
					}"""^^xsd:string ;
		]) .

:WriteCVPurposeDIP2Execution
  a bt:Write ;
  rdfs:label "Write: CV Purpose DIP in Execution" ;
  bt:query [
    a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:CVPurpose rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:CVPurpose welcome:belongsTo employment:createCV .
						employment:CVPurpose welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:CVPurpose welcome:hasDIPStatus welcome:Unknown .
						employment:CVPurpose welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:CVPurpose .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
  ] . 

:ConditionExistingIncompleteCV
	a bt:Condition ;
	rdfs:label "Condition: TCN Already has an Incomplete CV ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							welcome:tcn_user welcome:hasCVStatus ?cvStatus .
							?cvStatus rdf:type welcome:CVStatus .
							?cvStatus welcome:hasValue "Incomplete" .
					}"""^^xsd:string ;
		]) .
		
:UpdateCVPurpose_ExistingIncompleteDIP2Execution
	a bt:Update ;
	rdfs:label "Update: Incomplete CV Template" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>	
					DELETE {
						employment:informServicePurpose welcome:hasTemplateId ?templateServicePurpose .						
						employment:informDisclaimerCVModification welcome:hasTemplateId ?templateDisclaimerCV .
						employment:obtainCVCreationInterest welcome:hasTemplateId ?templateCVCreationInterest .
					}
					INSERT { 
						employment:informServicePurpose welcome:hasTemplateId "TInformServicePurpose_CV"^^xsd:string . 
						employment:informDisclaimerCVModification welcome:hasTemplateId "TInformDisclaimerCVModification_CV"^^xsd:string .
						employment:obtainCVCreationInterest welcome:hasTemplateId "TObtainCVContinueInterest"^^xsd:string .
					}
					WHERE {		
						employment:CVPurpose rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:CVPurpose welcome:hasSlot employment:informServicePurpose .
						employment:CVPurpose welcome:hasSlot employment:informDisclaimerCVModification .
						employment:CVPurpose welcome:hasSlot employment:obtainCVCreationInterest .
						employment:informServicePurpose welcome:hasTemplateId ?templateServicePurpose .						
						employment:informDisclaimerCVModification welcome:hasTemplateId ?templateDisclaimerCV .
						employment:obtainCVCreationInterest welcome:hasTemplateId ?templateCVCreationInterest .
					}"""^^xsd:string ;
		]) .
		
:ConditionExistingCompleteCV
	a bt:Condition ;
	rdfs:label "Condition: TCN Already has a Complete CV ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							welcome:tcn_user welcome:hasCVStatus ?cvStatus .
							?cvStatus rdf:type welcome:CVStatus .
							?cvStatus welcome:hasValue "Complete" .
					}"""^^xsd:string ;
		]) .
		
:UpdateCVPurpose_ExistingCompleteDIP2Execution
	a bt:Update ;
	rdfs:label "Update: Complete CV Template" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>	
					DELETE {
						employment:informServicePurpose welcome:hasTemplateId ?templateServicePurpose .						
						employment:informDisclaimerCVModification welcome:hasTemplateId ?templateDisclaimerCV .
						employment:obtainCVCreationInterest welcome:hasTemplateId ?templateCVCreationInterest .
					}
					INSERT { 
						employment:informServicePurpose welcome:hasTemplateId "TInformServicePurpose_CV"^^xsd:string . 
						employment:informDisclaimerCVModification welcome:hasTemplateId "TInformDisclaimerCVModification_CV"^^xsd:string .
						employment:obtainCVCreationInterest welcome:hasTemplateId "TObtainCVReviewInterest"^^xsd:string .
					}
					WHERE {		
						employment:CVPurpose rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:CVPurpose welcome:hasSlot employment:informServicePurpose .
						employment:CVPurpose welcome:hasSlot employment:informDisclaimerCVModification .
						employment:CVPurpose welcome:hasSlot employment:obtainCVCreationInterest .
						employment:informServicePurpose welcome:hasTemplateId ?templateServicePurpose .						
						employment:informDisclaimerCVModification welcome:hasTemplateId ?templateDisclaimerCV .
						employment:obtainCVCreationInterest welcome:hasTemplateId ?templateCVCreationInterest .
					}"""^^xsd:string ;
		]) .
		
:ConditionNoCV
	a bt:Condition ;
	rdfs:label "Condition: no CV exists ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							welcome:tcn_user welcome:hasCVStatus ?cvStatus .
							?cvStatus rdf:type welcome:CVStatus .
							?cvStatus welcome:hasValue "None" .
					}"""^^xsd:string ;
		]) .
		
:UpdateCVPurpose_NoCVDIP2Execution
	a bt:Update ;
	rdfs:label "Update: No CV Template" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>	
					DELETE {
						employment:informServicePurpose welcome:hasTemplateId ?templateServicePurpose .						
						employment:informDisclaimerCVModification welcome:hasTemplateId ?templateDisclaimerCV .
						employment:obtainCVCreationInterest welcome:hasTemplateId ?templateCVCreationInterest .
					}
					INSERT { 
						employment:informServicePurpose welcome:hasTemplateId "TInformServicePurpose_noCV"^^xsd:string . 
						employment:informDisclaimerCVModification welcome:hasTemplateId "TInformDisclaimerCVModification_noCV"^^xsd:string .
						employment:obtainCVCreationInterest welcome:hasTemplateId "TObtainCVCreationInterest"^^xsd:string .
					}
					WHERE {		
						employment:CVPurpose rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:CVPurpose welcome:hasSlot employment:informServicePurpose .
						employment:CVPurpose welcome:hasSlot employment:informDisclaimerCVModification .
						employment:CVPurpose welcome:hasSlot employment:obtainCVCreationInterest .
						employment:informServicePurpose welcome:hasTemplateId ?templateServicePurpose .						
						employment:informDisclaimerCVModification welcome:hasTemplateId ?templateDisclaimerCV .
						employment:obtainCVCreationInterest welcome:hasTemplateId ?templateCVCreationInterest .
					}"""^^xsd:string ;
		]) .

:ConditionFirstMoveHealth
	a bt:Condition ;
	rdfs:label "Condition: First Move for Health BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					ASK
					WHERE { 
							?sscSubj ssc:hasResultOffer health:healthCareInformationProvision .
					}"""^^xsd:string ;
		]) .
		
:WriteScenarioIntroductionHealthDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Scenario Introduction Health DIP in Execution" ;
	bt:query [
    a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:ScenarioIntroduction welcome:belongsTo health:healthCareInformationProvision .
						health:ScenarioIntroduction welcome:isCurrentDIP "true"^^xsd:boolean .
						health:ScenarioIntroduction welcome:hasDIPStatus welcome:Unknown .
						health:ScenarioIntroduction welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:ScenarioIntroduction .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
  ] . 
  
:DeleteSSCResultinAgentKB
	a bt:Update ;
	rdfs:label "Update: Delete SSC Result in Agent KB" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX welcomeServices: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>		
					DELETE {
						?sscSubj ssc:hasResultOffer ?MatchmakerOffer .
						?MatchmakerOffer ssc:hasServiceName ?servName .	
					}
					WHERE {		
						OPTIONAL {
							?sscSubj ssc:hasResultOffer ?MatchmakerOffer .
							?MatchmakerOffer ssc:hasServiceName ?servName .
						}
					}"""^^xsd:string ;
		]) .

:DeleteFirstInteractionFlaginLAKR
	a bt:Update ;
	rdfs:label "Update: Delete First Interaction Flag in LAKR" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE {
						welcome:myWelcomeAgent welcome:hasFirstMove ?val .		
					}
					WHERE { 
						welcome:myWelcomeAgent welcome:hasFirstMove ?val .	
					}					
					"""^^xsd:string ;
		]) .

:EventHandlerSpecificBT
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Specific BT" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#SpecificBTEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 				
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:execute ?val .			
						}
						WHERE { 
							welcome:myWelcomeAgent welcome:execute ?val .						
						}"""^^xsd:string ;
				] .

:DeletePreviousFlaginExecution
	a bt:Update ;
	rdfs:label "Update: Delete Previous Specific BT Flag in Execution" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE {
						welcome:myWelcomeAgent welcome:execute ?val .		
					} WHERE { 
						OPTIONAL{
							welcome:myWelcomeAgent welcome:execute ?val . 
						}
					}"""^^xsd:string ;
		]) .

:WriteSpecificBTFlaginExecution
	a bt:Write ;
	rdfs:label "Write: Specific BT Flag in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX welcomeServices: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>	
			CONSTRUCT  {
				welcome:myWelcomeAgent welcome:execute ?val .	
			}
			WHERE {
				welcome:myWelcomeAgent welcome:execute ?val .	
			}"""^^xsd:string ;
	] .

:DeleteSpecificBTFlaginAgentKB
	a bt:Update ;
	rdfs:label "Update: Delete Specific BT Flag in LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE {
						welcome:myWelcomeAgent welcome:execute ?val .		
					} WHERE { 
						welcome:myWelcomeAgent welcome:execute ?val . 
					}"""^^xsd:string ;
		]) .
		
:ConditionalFlagIncomplete
	a bt:Condition ;
	rdfs:label "Condition: Specific BT Flag Incomplete?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					ASK
					WHERE { 
							welcome:myWelcomeAgent welcome:execute "IncompleteDIP" .	
					}"""^^xsd:string ;
		]) .

:UpdateCreateHeaderDMSMessage
	a bt:Update ;
	rdfs:label "Update: Header DMS Message" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE {
						?headerName welcome:hasHeaderName ?valHeaderName .
						?headerValue welcome:hasHeaderValue ?valHeaderValue.		
					} 
					INSERT {
						welcome:headerTurnID welcome:hasHeaderName "X-Turn-ID" .
						welcome:headerTurnID welcome:hasHeaderValue ?turnID .
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerLanguage welcome:hasHeaderName "X-Language" .
						welcome:headerLanguage welcome:hasHeaderValue ?preferedLang .
						welcome:headerAvatarGender welcome:hasHeaderName "X-Avatar-Gender" .
						welcome:headerAvatarGender welcome:hasHeaderValue ?value .						
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .
						welcome:headerMsgType welcome:hasHeaderName "X-Msg-Type" .
						welcome:headerMsgType welcome:hasHeaderValue "dialogueResponse" .						
					} 
					WHERE { 
						?turn welcome:hasTurnID ?turnID .
						?du rdf:type welcome:DialogueUser .
						?msg welcome:hasCorrelationID ?correlationID .
						?du welcome:hasUserId ?idObject .
						?idObject welcome:hasValue ?id .
						welcome:tcn_user welcome:hasLanguageCode ?lang .
						?lang rdf:type welcome:LanguageCode .
						?lang welcome:hasValue ?preferedLang .
						welcome:Avatar welcome:hasGender welcome:Gender .
						welcome:Gender welcome:hasValue ?value .
						OPTIONAL {
							?headerName welcome:hasHeaderName ?valHeaderName .
							?headerValue welcome:hasHeaderValue ?valHeaderValue.
						}
					}
					"""^^xsd:string ;
		]) .
		
:SendIncompleteOrMultipleDIPDMS
	a myWelcome:Message ;
	rdfs:label "Message: Send Multiple or Incomplete DIP to DMS"^^xsd:string ;
	rdfs:comment "Message: Send Multiple or Incomplete DIP to DMS"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
		  a bt:SelectQuery;
		  a bt:QueryUri ;
		  bt:originBase ajan:AgentKnowledge ;
		  bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 
							{
								VALUES ?hdrName {"X-Turn-ID"}
								?turn welcome:hasTurnID ?fieldValue .
							}
							
							UNION
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
							   VALUES ?hdrName {"X-Language"}
								welcome:tcn_user welcome:hasLanguageCode ?lang .
								?lang rdf:type welcome:LanguageCode .
								?lang welcome:hasValue ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-Avatar-Gender"}
								welcome:Avatar welcome:hasGender welcome:Gender .
								welcome:Gender welcome:hasValue ?fieldValue .	
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
							UNION
							{
								VALUES (?hdrName ?fieldValue) {
								("X-Msg-Type" "dialogueResponse")
								}
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle;charset-UTF8"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;	
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
						PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
						PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
						PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
						CONSTRUCT {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .					
							?dip welcome:DIPId ?id .
							?dip welcome:isCurrentDIP ?current .
							?dip welcome:hasSlot ?slots .
							?slots rdf:type ?slotType .
							?slots welcome:hasTemplateId ?templateID .	
							?slots welcome:hasInputRDFContents ?RDFContents .
							?slots welcome:hasTCNAnswer ?tcnAnswer .
							?slots welcome:hasOntologyType ?ontoType .
							?tcnAnswer ?reifiPredAnswer ?reifiedObjAnswer .
							?RDFContents ?ReifiPredi ?ReifiObj .					
							?slots welcome:hasStatus ?slotsStatus .		
							?slots welcome:hasNumberAttempts ?NbAttempts .
							?slots welcome:confidenceScore ?confScore .
							?slots welcome:isOptional ?optional .
							?slots welcome:dependsOn ?val .
							?slots welcome:associatedWith ?asso .
						}
						WHERE {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .					
							?dip welcome:DIPId ?id .
							?dip welcome:isCurrentDIP ?current .
							?dip welcome:hasSlot ?slots .
							?slots rdf:type ?slotType .
							?slots welcome:hasOntologyType ?ontoType .							
							?slots welcome:hasStatus ?slotsStatus .		
							?slots welcome:hasNumberAttempts ?NbAttempts .
							?slots welcome:confidenceScore ?confScore .
							?slots welcome:isOptional ?optional .	
							OPTIONAL { ?slots welcome:hasTemplateId ?templateID . }
							OPTIONAL {?slots welcome:dependsOn ?val .}
							OPTIONAL {?slots welcome:associatedWith ?asso .}
							OPTIONAL { 
								{?slots welcome:hasTCNAnswer ?tcnAnswer .}
								UNION
								{?slots welcome:hasTCNAnswer ?tcnAnswer .
								 ?tcnAnswer ?reifiPredAnswer ?reifiedObjAnswer .}
							}
							OPTIONAL { 
								{?slots welcome:hasInputRDFContents ?RDFContents . }
								UNION
								{?slots welcome:hasInputRDFContents ?RDFContents .
								?RDFContents ?ReifiPredi ?ReifiObj .}
							}
						}"""^^xsd:string
			]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/toTcn?log=true") AS ?requestURI )
   			}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionalNormalClosing_ContactNGO_ClosingFailureComplete
	a bt:Condition ;
	rdfs:label "Condition: Normal Closing or ContactNGO or Closing Failure Complete" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX welcomeService: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								welcomeService:NormalClosing rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcomeService:NormalClosing welcome:DIPId ?id .
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								welcome:NormalClosing rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcome:NormalClosing welcome:DIPId ?id .
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id .
								welcome:ContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcome:ContactNGOFarewell welcome:DIPId ?id .
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id .
								welcome:NormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcome:NormalClosingFarewell welcome:DIPId ?id .
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id .
								welcome:ClosingUponFailure rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcome:ClosingUponFailure welcome:DIPId ?id .
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id .
								welcome:ClosingUponFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcome:ClosingUponFailureFarewell welcome:DIPId ?id .
							}
					}"""^^xsd:string ;
		]) .
		
#:SucessFinishScenario
#	a bt:Success ;
#	rdfs:label "Scenario Finished"^^xsd:string .

:MessageSendDialogueFinishNotification
	a myWelcome:Message ;
	rdfs:label "Message: Send Dialogue Finished Notification to App"^^xsd:string ;
	rdfs:comment "Message: Send Dialogue Finished Notification to App"^^xsd:string ;
	bt:targetBase ajan:AgentKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:notificationTitle welcome:EndDialogue  "true" .  
						}
						WHERE {
							?bt welcome:hasActiveDIP ?id .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .
	
:ConditionExecutePreregistrationBT				
	a bt:Condition ;
	rdfs:label "Condition: Execute Preregistration BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
						{
							?bt welcome:hasActiveDIP ?dipId . 
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:DIPId ?id .
							?dip welcome:belongsTo <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#PreregistrationProcedureService> .
						}
					}"""^^xsd:string ;
		]) .

:ConditionExecuteSimulateAppointmentBT
	a bt:Condition ;
	rdfs:label "Condition: Execute Simulate Appointment BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>			
					ASK
					WHERE { 
						{
							?bt welcome:hasActiveDIP ?dipId . 
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:DIPId ?id .
							?dip welcome:belongsTo <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#simulatePraksisAppointmentService> .
						}
					}"""^^xsd:string ;
		]) .

:ConditionExecuteFullAsylumRegistrationBT
	a bt:Condition ;
	rdfs:label "Condition: Execute Full Asylum Registration BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					ASK
					WHERE { 
							?bt welcome:hasActiveDIP ?dipId . 
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:DIPId ?id .
							?dip welcome:belongsTo <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#fullAsylumRegistration> .
					}"""^^xsd:string ;
		]) .
		
:EventProducerFullAsylumRegistrationBT																																			a bt:EventProducer ;
	a bt:EventProducer ;
	rdfs:label "EventProducer: Execute the Full Asylum Registration BT" ;
	ajan:event agents:FullAsylumRegistrationEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:executeScenario "FullAsylumRegistration" .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	

:ConditionExecuteHealthBT
	a bt:Condition ;
	rdfs:label "Condition: Execute Health BT?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					ASK
					WHERE { 
							?bt welcome:hasActiveDIP ?dipId . 
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dip welcome:DIPId ?id .
							?dip welcome:belongsTo health:healthCareInformationProvision .
					}"""^^xsd:string ;
		]) .
		
:EventProducerHealthBT
	a bt:EventProducer ;
	rdfs:label "EventProducer: Execute Health BT" ;
	ajan:event agents:HealthEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:executeScenario "Health" .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	
				
:EventProducerExecuteCVCreationBT
	a bt:EventProducer ;
	rdfs:label "EventProducer: Execute the CV Creation BT" ;
	ajan:event agents:CVCreationEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:AgentKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:executeScenario "CVCreation" .
						}
						WHERE {
							?s rdf:type ajan:Agent .
						}"""^^xsd:string ;
				] .	
				
#=============================================================================================
# SpecificPreregistrationBT

:UpdateCreateNormalClosingPart1
	a bt:Update ;
	rdfs:label "Update: Create Normal Closing DIP Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:NormalClosing rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:NormalClosing welcome:hasDIPStatus welcome:Unknown .
						welcome:NormalClosing welcome:hasSlot welcome:informEnd .
						welcome:NormalClosing welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:informEnd rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informEnd welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informEnd welcome:hasTemplateId "TInformEnd"^^xsd:string .
						welcome:informEnd welcome:hasInputRDFContents welcome:Unknown .
						welcome:informEnd welcome:hasTCNAnswer welcome:Unknown .
						welcome:informEnd welcome:hasStatus welcome:Pending .
						welcome:informEnd welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informEnd welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informEnd welcome:isOptional "false"^^xsd:boolean .	
						welcome:informEnd welcome:dependsOn welcome:Unknown .
						welcome:informEnd welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?s rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateNormalClosingPart2
	a bt:Update ;
	rdfs:label "Update: Create Normal Closing DIP Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:NormalClosing welcome:hasSlot welcome:obtainConfirmation .
						welcome:obtainConfirmation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ConfirmationRequest"^^xsd:anyURI . 
						welcome:obtainConfirmation welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:obtainConfirmation welcome:hasTemplateId "TObtainConfirmation"^^xsd:string .
						welcome:obtainConfirmation welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainConfirmation welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainConfirmation welcome:hasStatus welcome:Pending .
						welcome:obtainConfirmation welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainConfirmation welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainConfirmation welcome:isOptional "false"^^xsd:boolean .
						welcome:obtainConfirmation welcome:dependsOn welcome:Unknown .
						welcome:obtainConfirmation welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?s rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:DeleteActiveDIPinAgentKB
	a bt:Update ;
	rdfs:label "Update: Remove Active DIPs in LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE {
						?bt welcome:hasActiveDIP ?id .	
						?dip welcome:hasNamedGraph ?dipGraph .
					}
					 WHERE {
						OPTIONAL { ?bt welcome:hasActiveDIP ?id .}	
						OPTIONAL { ?dip welcome:hasNamedGraph ?dipGraph .}					
					}"""^^xsd:string ;
		]) .

#:ConditionalDIPIncompleteOrMultiple
#	a bt:Condition ;
#	rdfs:label "Condition: DIP Incomplete? or Multiple DIP?" ;
#	bt:query ([
#		a bt:AskQuery ;
#		bt:originBase ajan:ExecutionKnowledge ;
#		bt:sparql """
#					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
#					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
#					ASK
#					WHERE { 
#							{	?bt welcome:hasActiveDIP ?id . 
#								?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
#								?dip welcome:DIPId ?id .
#							}
#							UNION
#							{ 
#								{
#									SELECT (COUNT(?id) as ?counter)
#									WHERE {
#										?bt welcome:hasActiveDIP ?id .
#									}
#								}
#								FILTER(?counter > 1) 
#							}							
#					}"""^^xsd:string ;
#		]) .


																		
:ConditionalObtainPersonalInfoCompleteAndFirstApplicationYes
	a bt:Condition ;
	rdfs:label "Condition: Obtain Personal Info Complete? and First Application Yes" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							preregistration:ObtainPersonalInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:ObtainPersonalInformation welcome:DIPId ?id .
							preregistration:ObtainPersonalInformation welcome:hasSlot preregistration:obtainFirstApplication .	
							preregistration:obtainFirstApplication welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "true"))
					}"""^^xsd:string ;
		]) .

:WriteInformAsylumClaimDIP2Execution
	a bt:Write ;
	rdfs:label "Write:Inform Asylum Claim DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformAsylumClaim rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformAsylumClaim welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformAsylumClaim welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformAsylumClaim welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformAsylumClaim welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformAsylumClaim .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .	

:ConditionalObtainPersonalInfoCompleteAndFirstApplicationNot
	a bt:Condition ;
	rdfs:label "Condition: Obtain Personal Info Complete? and First Application Not" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							preregistration:ObtainPersonalInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:ObtainPersonalInformation welcome:DIPId ?id .
							preregistration:ObtainPersonalInformation welcome:hasSlot preregistration:obtainFirstApplication .	
							preregistration:obtainFirstApplication welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "False") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "No"))
							
					}"""^^xsd:string ;
		]) .

:WriteInformContactPRAKSISDIP2Execution
	a bt:Write ;
	rdfs:label "Write:Inform Contact PRAKSIS DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformContactPRAKSIS rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformContactPRAKSIS welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformContactPRAKSIS welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformContactPRAKSIS welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformContactPRAKSIS welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformContactPRAKSIS .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;		
	] .	

:ConditionalInformContactPRAKSIS_OR_InformInternetConnectionCompleteAndConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Inform Contact PRAKSIS  or Internet Connection Complete? and Confirmation Yes" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformContactPRAKSIS rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformContactPRAKSIS welcome:DIPId ?id .
								preregistration:InformContactPRAKSIS welcome:hasSlot preregistration:obtainConfirmationContactPRAKSIS .	
								preregistration:obtainConfirmationContactPRAKSIS welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformInternetConnection rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformInternetConnection welcome:DIPId ?id .
								preregistration:InformInternetConnection welcome:hasSlot preregistration:obtainConfirmationInternetConnection .	
								preregistration:obtainConfirmationInternetConnection welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
							}
					}"""^^xsd:string ;
		]) .

:WriteNormalClosingDIP2Execution
	a bt:Write ;
	rdfs:label "Write:Normal Closing DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:NormalClosing rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:NormalClosing welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:NormalClosing welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:NormalClosing welcome:hasDIPStatus welcome:Unknown .
							preregistration:NormalClosing welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:NormalClosing .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;		
	] .

:ConditionalInformContactPRAKSIS_ServiceNGOSupport_SkypeUSer_SkypeCallProcess_InternetConnection_DIPCompleteAndConfirmationNot
	a bt:Condition ;
	rdfs:label "Condition: Inform Contact PRAKSIS Complete? and Confirmation Not" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformContactPRAKSIS rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformContactPRAKSIS welcome:DIPId ?id .
								preregistration:InformContactPRAKSIS welcome:hasSlot preregistration:obtainConfirmationContactPRAKSIS .	
								preregistration:obtainConfirmationContactPRAKSIS welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformServiceNGOSupport rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformServiceNGOSupport welcome:DIPId ?id .
								preregistration:InformServiceNGOSupport welcome:hasSlot preregistration:obtainConfirmationNGOSupport .	
								preregistration:obtainConfirmationNGOSupport welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformSkypeUser rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformSkypeUser welcome:DIPId ?id .
								preregistration:InformSkypeUser welcome:hasSlot preregistration:obtainConfirmationSkypeUser .	
								preregistration:obtainConfirmationSkypeUser welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformSkypeCallProcess rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformSkypeCallProcess welcome:DIPId ?id .
								preregistration:InformSkypeCallProcess welcome:hasSlot preregistration:obtainConfirmationSkypeProcess .	
								preregistration:obtainConfirmationSkypeProcess welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformInternetConnection rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformInternetConnection welcome:DIPId ?id .
								preregistration:InformInternetConnection welcome:hasSlot preregistration:obtainConfirmationInternetConnection .	
								preregistration:obtainConfirmationInternetConnection welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False"))
							}
					}"""^^xsd:string ;
		]) .

:UpdateCreateClosingUponFailureDIP2Execution
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP. Confirmation Required to Continue Scenario" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailure rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailure welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailure welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailure welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType  "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonNoConfirmation .
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
						welcome:reifiedReasonSTReasonNoConfirmation rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonNoConfirmation rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonNoConfirmation rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonNoConfirmation rdf:object "STReasonNoConfirmation"^^xsd:string .						
					} WHERE { 
						?s rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:ConditionalInformAsylum_OR_AccountCreation_OR_NGOSupport_CompleteAndKnowledgeSkypeYes_InternetYes_ConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Asylum Complete and Knowledge Skype Yes? OR Account Creation Complete and Internet Yes? Or NGO Support Complete and Confirmation Yes" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformAsylumClaim rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformAsylumClaim welcome:DIPId ?id .
								preregistration:InformAsylumClaim welcome:hasSlot preregistration:obtainKnowledgeSkypeCreation .	
								preregistration:obtainKnowledgeSkypeCreation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformSkypeAccountCreation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformSkypeAccountCreation welcome:DIPId ?id .
								preregistration:InformSkypeAccountCreation welcome:hasSlot preregistration:obtainInternetConnection .	
								preregistration:obtainInternetConnection welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								preregistration:InformServiceNGOSupport rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								preregistration:InformServiceNGOSupport welcome:DIPId ?id .
								preregistration:InformServiceNGOSupport welcome:hasSlot preregistration:obtainConfirmationNGOSupport .	
								preregistration:obtainConfirmationNGOSupport welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
							}
					}"""^^xsd:string ;
		]) .

:WriteInformSkypeUserDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Inform Skype User DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformSkypeUser rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformSkypeUser welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformSkypeUser welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformSkypeUser welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformSkypeUser welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformSkypeUser .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionalInformAsylumClaimCompleteAndKnowledgeSkypeNot
	a bt:Condition ;
	rdfs:label "Condition: Inform Asylum Claim Complete? and Knowledge Skype Not" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							preregistration:InformAsylumClaim rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformAsylumClaim welcome:DIPId ?id .
							preregistration:InformAsylumClaim welcome:hasSlot preregistration:obtainKnowledgeSkypeCreation .	
							preregistration:obtainKnowledgeSkypeCreation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "No"))
					}"""^^xsd:string ;
		]) .
		
:WriteInformSkypeAccountCreationDIP2Execution
	a bt:Write ;
	rdfs:label "Write:Inform Skype Account Creation DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformSkypeAccountCreation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformSkypeAccountCreation welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformSkypeAccountCreation welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformSkypeAccountCreation welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformSkypeAccountCreation welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformSkypeAccountCreation .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionalInformSkypeAccountCreationCompleteAndInternetAnswerNot
	a bt:Condition ;
	rdfs:label "Condition: Inform Skype Account Complete? and Internet Not" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							preregistration:InformSkypeAccountCreation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformSkypeAccountCreation welcome:DIPId ?id .
							preregistration:InformSkypeAccountCreation welcome:hasSlot preregistration:obtainInternetConnection .	
							preregistration:obtainInternetConnection welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer  rdf:type rdf:Statement .
							?reifiedAnswer  rdf:subject ?reifiedSubject .
							?reifiedAnswer  rdf:predicate ?reifiedPredicate .
							?reifiedAnswer  rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "No"))
					}"""^^xsd:string ;
		]) .

:WriteInformServiceNGOSupportDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Inform Service NGO Support DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformServiceNGOSupport rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformServiceNGOSupport welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformServiceNGOSupport welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformServiceNGOSupport welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformServiceNGOSupport welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformServiceNGOSupport .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionalInformSkypeUserCompleteAndConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Inform Skype User Complete? and Confirmation Yes" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							preregistration:InformSkypeUser rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformSkypeUser welcome:DIPId ?id .
							preregistration:InformSkypeUser welcome:hasSlot preregistration:obtainConfirmationSkypeUser .	
							preregistration:obtainConfirmationSkypeUser welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
					}"""^^xsd:string ;
		]) .

:WriteInformSkypeCallProcessDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Inform Skype Call Process DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformSkypeCallProcess rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformSkypeCallProcess welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformSkypeCallProcess welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformSkypeCallProcess welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformSkypeCallProcess welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformSkypeCallProcess .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalInformSkypeCallProcessCompleteAndConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Inform Skype Process Complete? and Confirmation Yes" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							preregistration:InformSkypeCallProcess rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformSkypeCallProcess welcome:DIPId ?id .
							preregistration:InformSkypeCallProcess welcome:hasSlot preregistration:obtainConfirmationSkypeProcess .	
							preregistration:obtainConfirmationSkypeProcess welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))
					}"""^^xsd:string ;
		]) .

:WriteInformInternetConnectionDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Inform Internet Connection DIP in Execution" ;
	bt:query [
					a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							preregistration:InformInternetConnection rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							preregistration:InformInternetConnection welcome:belongsTo preregistration:PreregistrationProcedureService .
							preregistration:InformInternetConnection welcome:isCurrentDIP "true"^^xsd:boolean .
							preregistration:InformInternetConnection welcome:hasDIPStatus welcome:Unknown .
							preregistration:InformInternetConnection welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							preregistration:PreregistrationProcedureService rdf:type service:Service .
							preregistration:PreregistrationProcedureService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP preregistration:InformInternetConnection .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

#=============================================================================================
# SpecificSimulateAppointmentBT

:ConditionalUndefinedDIP
	a bt:Condition ;
	rdfs:label "Condition: A mandatory info is missing ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dipName welcome:DIPId ?id .
							?dipName welcome:hasSlot ?mandatorySlotName.
							?mandatorySlotName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
							?mandatorySlotName welcome:hasStatus welcome:Undefined .	
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - Missing Mandatory Info - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailureFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailureFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonValueMissed .
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .				
						welcome:reifiedReasonSTReasonValueMissed rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonValueMissed rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonValueMissed rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonValueMissed rdf:object "STReasonValueMissed"^^xsd:string .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateClosingUponFailureUndefinedSlotDIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - Missing Mandatory Info - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informClosingFailureFarewell .
						welcome:informClosingFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasTemplateId "TInformClosingFailureFarewell"^^xsd:string . 
						welcome:informClosingFailureFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:hasStatus welcome:Pending .
						welcome:informClosingFailureFarewell welcome:hasNumberAttempts 0 .
						welcome:informClosingFailureFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informClosingFailureFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informClosingFailureFarewell welcome:dependsOn welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:ConditionalAnyConfirmInfoNot_UndefinedValue
	a bt:Condition ;
	rdfs:label "Condition: Any Confirmation Not - Undefined Value" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dipName welcome:DIPId ?id .						
							?dipName welcome:hasSlot ?slotName .	
							?slotName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ConfirmationRequest"^^xsd:anyURI .
							?slotName welcome:hasStatus welcome:Undefined .			
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Farewell Simulation - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ContactNGOFarewellSimulation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ContactNGOFarewellSimulation welcome:hasDIPStatus welcome:Unknown .
						welcome:ContactNGOFarewellSimulation welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ContactNGOFarewellSimulation welcome:belongsTo <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#simulatePraksisAppointmentService> .
						welcome:ContactNGOFarewellSimulation welcome:hasSlot welcome:informGenericPRAKSISContact, welcome:obtainContactNGOSimulationConfirmation, welcome:flagMoreSimulations .						
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Farewell Simulation - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {											
						welcome:informGenericPRAKSISContact rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informGenericPRAKSISContact welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informGenericPRAKSISContact welcome:hasTemplateId "TInformInabilityAssistAndContacts"^^xsd:string . 
						welcome:informGenericPRAKSISContact welcome:hasInputRDFContents welcome:Unknown .
						welcome:informGenericPRAKSISContact welcome:hasStatus welcome:Pending .
						welcome:informGenericPRAKSISContact welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informGenericPRAKSISContact welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informGenericPRAKSISContact welcome:isOptional "false"^^xsd:boolean .
						welcome:informGenericPRAKSISContact welcome:dependsOn welcome:Unknown .
						welcome:informGenericPRAKSISContact welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part3
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Farewell Simulation - Part 3" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {										
						welcome:obtainContactNGOSimulationConfirmation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
						welcome:obtainContactNGOSimulationConfirmation welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:obtainContactNGOSimulationConfirmation welcome:hasTemplateId "TObtainContactNGOSimulationConfirmation"^^xsd:string . 
						welcome:obtainContactNGOSimulationConfirmation welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainContactNGOSimulationConfirmation welcome:hasStatus welcome:Pending .
						welcome:obtainContactNGOSimulationConfirmation welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainContactNGOSimulationConfirmation welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainContactNGOSimulationConfirmation welcome:isOptional "false"^^xsd:boolean .
						welcome:obtainContactNGOSimulationConfirmation welcome:dependsOn welcome:Unknown .
						welcome:obtainContactNGOSimulationConfirmation welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateContactNGOFarewellSimulationDIP2Execution_Part4
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Farewell Simulation - Part 4" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {												
						welcome:flagMoreSimulations rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
						welcome:flagMoreSimulations welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#OfficerRoleFlag"^^xsd:anyURI .
						welcome:flagMoreSimulations welcome:hasInputRDFContents welcome:Unknown .
						welcome:flagMoreSimulations welcome:hasStatus welcome:Pending .
						welcome:flagMoreSimulations welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:flagMoreSimulations welcome:confidenceScore "0.0"^^xsd:float .
						welcome:flagMoreSimulations welcome:isOptional "false"^^xsd:boolean .
						welcome:flagMoreSimulations welcome:dependsOn welcome:Unknown .
						welcome:flagMoreSimulations welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:ConditionalContactNGOFarewellSimulationYes_MoreSimuYes
	a bt:Condition ;
	rdfs:label "Condition: Contact NGO Farewell - More Simulation Yes " ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							welcome:ContactNGOFarewellSimulation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							welcome:ContactNGOFarewellSimulation welcome:DIPId ?id .
							welcome:ContactNGOFarewellSimulation welcome:hasSlot welcome:flagMoreSimulations .	
							welcome:flagMoreSimulations welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							welcome:ContactNGOFarewellSimulation welcome:hasSlot welcome:obtainContactNGOSimulationConfirmation .
							welcome:obtainContactNGOSimulationConfirmation welcome:hasTCNAnswer ?simulConfirmation .
							?simulConfirmation rdf:type rdf:Statement .
							?simulConfirmation rdf:subject ?reifiedSubjectConfirmation .
							?simulConfirmation rdf:predicate ?reifiedPredicateConfirmation .
							?simulConfirmation rdf:object ?answerConfirmation .							
							FILTER (STRENDS(str(?answerConfirmation), "true") || STRENDS(str(?answerConfirmation), "True") || STRENDS(str(?answerConfirmation), "Yes") || STRENDS(str(?answerConfirmation), "yes") || ?answerConfirmation = true )
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )
					}"""^^xsd:string ;
		]) .
		
:ConditionalContactNGOFarewellSimulationYesNot_MoreSimuNot
	a bt:Condition ;
	rdfs:label "Condition: Contact NGO Farewell - More Simulation Not " ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							welcome:ContactNGOFarewellSimulation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							welcome:ContactNGOFarewellSimulation welcome:DIPId ?id .
							welcome:ContactNGOFarewellSimulation welcome:hasSlot welcome:flagMoreSimulations .	
							welcome:flagMoreSimulations welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )
					}"""^^xsd:string ;
		]) .
		
:ConditionalScenarioIntroductionYes
	a bt:Condition ;
	rdfs:label "Condition: ScenarioIntroduction Complete and Readiness Yes? or Availability Accepted?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:ScenarioIntroduction welcome:DIPId ?id .
							simulateAppointment:ScenarioIntroduction welcome:hasSlot simulateAppointment:obtainReadiness .	
							simulateAppointment:obtainReadiness welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )
					}"""^^xsd:string ;
		]) .

:WriteSimulationIntrodutionDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Simulation Introduction DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:SimulationIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:SimulationIntroduction welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:SimulationIntroduction welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:SimulationIntroduction welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:SimulationIntroduction welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:SimulationIntroduction .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalScenarioIntroNot_AppointmentSummary_AppointmentRejectedCallbackComplete
	a bt:Condition ;
	rdfs:label "Condition: ScenarioIntroduction Readiness Not? Or Apptm Summary_Rejected Complete" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:ScenarioIntroduction welcome:DIPId ?id .
								simulateAppointment:ScenarioIntroduction welcome:hasSlot simulateAppointment:obtainReadiness .	
								simulateAppointment:obtainReadiness welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:AppointmentSummary rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:AppointmentSummary welcome:DIPId ?id .							
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:AppointmentRejectedCallback rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:AppointmentRejectedCallback welcome:DIPId ?id .	
								simulateAppointment:AppointmentRejectedCallback welcome:hasSlot simulateAppointment:obtainPhoneAppointmentRejection								
								FILTER NOT EXISTS { simulateAppointment:obtainPhoneAppointmentRejection welcome:hasTCNAnswer welcome:Unknown . }
							}
					}"""^^xsd:string ;
		]) .


:UpdateCreateNormalClosingFarewellS2bDIP2Execution_Part1 
	a bt:Update ;
	rdfs:label "Update: Normal Closing Farewell for S2b DIP - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 					
					INSERT {
						welcome:NormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:NormalClosingFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:NormalClosingFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informEnd .
						welcome:informEnd rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informEnd welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informEnd welcome:hasTemplateId "TInformEnd_S2b"^^xsd:string .
						welcome:informEnd welcome:hasInputRDFContents welcome:Unknown .	
						welcome:informEnd welcome:hasTCNAnswer welcome:Unknown .
						welcome:informEnd welcome:hasStatus welcome:Pending .		
						welcome:informEnd welcome:hasNumberAttempts 0 .
						welcome:informEnd welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informEnd welcome:isOptional "false"^^xsd:boolean .	
						welcome:informEnd welcome:dependsOn welcome:Unknown .
						welcome:informEnd welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateNormalClosingFarewellS2bDIP2Execution_Part2 
	a bt:Update ;
	rdfs:label "Update: Normal Closing Farewell for S2b DIP - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 					
					INSERT {
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informNormalClosingFarewell .
						welcome:informNormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informNormalClosingFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informNormalClosingFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informNormalClosingFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasStatus welcome:Pending .
						welcome:informNormalClosingFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informNormalClosingFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informNormalClosingFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informNormalClosingFarewell welcome:dependsOn welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:ConditionalSimulationIntroComplete
	a bt:Condition ;
	rdfs:label "Condition: SimulationIntro or Availability Accepted Completed" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:SimulationIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:SimulationIntroduction welcome:DIPId ?id .							
						}"""^^xsd:string ;
		]) .

:WritePRAKSISCardDIP2Execution
	a bt:Write ;
	rdfs:label "Write: PRAKSIS Card DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:PRAKSISCard rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:PRAKSISCard welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:PRAKSISCard welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:PRAKSISCard welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:PRAKSISCard welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:PRAKSISCard .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalPRAKSISCardYes_PremisesVisitYes_AltAuthenOfficer
	a bt:Condition ;
	rdfs:label "Condition: Praksis card or Premises Visit Yes or Alt Auth is Officer" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:PRAKSISCard rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:PRAKSISCard welcome:DIPId ?id .								
								simulateAppointment:PRAKSISCard welcome:hasSlot simulateAppointment:obtainCardNumber .	
								simulateAppointment:obtainCardNumber welcome:hasTCNAnswer ?reifiedCard .
								?reifiedCard rdf:type rdf:Statement .
								?reifiedCard rdf:subject ?reifiedCardSubject .
								?reifiedCard rdf:predicate ?reifiedCardPredicate .
								FILTER NOT EXISTS { ?reifiedCard rdf:object "Unknown" . }
								simulateAppointment:PRAKSISCard welcome:hasSlot simulateAppointment:flagIsOfficerRole .	
								simulateAppointment:flagIsOfficerRole welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true)
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:PremisesVisitDescription rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:PremisesVisitDescription welcome:DIPId ?id .	
								simulateAppointment:PremisesVisitDescription welcome:hasSlot simulateAppointment:obtainPremisesVisitConfirmation .	
								simulateAppointment:obtainPremisesVisitConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )	
								simulateAppointment:PremisesVisitDescription welcome:hasSlot simulateAppointment:flagIsOfficerRole .	
								simulateAppointment:flagIsOfficerRole welcome:hasTCNAnswer ?reifiedAnswerRole .
								?reifiedAnswerRole rdf:type rdf:Statement .
								?reifiedAnswerRole rdf:subject ?reifiedSubjectRole .
								?reifiedAnswerRole rdf:predicate ?reifiedPredicateRole .
								?reifiedAnswerRole rdf:object ?answerRole .
								FILTER (STRENDS(str(?answerRole), "true") || STRENDS(str(?answerRole), "True") || STRENDS(str(?answerRole), "Yes") || STRENDS(str(?answerRole), "yes") || ?answerRole = true )						
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:AlternativeAuthentification rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:AlternativeAuthentification welcome:DIPId ?id .	
								simulateAppointment:AlternativeAuthentification welcome:hasSlot simulateAppointment:flagIsOfficerRole .	
								simulateAppointment:flagIsOfficerRole welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )								
							}
					}"""^^xsd:string ;
		]) .

:WriteMatterConcernIdentificationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Matter Concern Identification DIP in Execution" ;
	bt:query [
					a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:MatterConcernIdentification rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:MatterConcernIdentification welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:MatterConcernIdentification welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:MatterConcernIdentification welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:MatterConcernIdentification welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:MatterConcernIdentification .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalPRAKSISCardNotOfficer_Lawyer
	a bt:Condition ;
	rdfs:label "Condition: Praksis card Not" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:PRAKSISCard rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:PRAKSISCard welcome:DIPId ?id .								
							simulateAppointment:PRAKSISCard welcome:hasSlot simulateAppointment:obtainCardNumber .								
							simulateAppointment:obtainCardNumber welcome:hasTCNAnswer ?reifiedAnswer . 
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Unknown"))								
					}"""^^xsd:string ;
		]) .

:WriteFirstContactInformationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: First Contact Information DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:FirstContactInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:FirstContactInformation welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:FirstContactInformation welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:FirstContactInformation welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:FirstContactInformation welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:FirstContactInformation .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalMatterConcernIdentificationComplete
	a bt:Condition ;
	rdfs:label "Condition: Matter Concern Identification Completed" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:MatterConcernIdentification rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:MatterConcernIdentification welcome:DIPId ?id .	
					}"""^^xsd:string ;
		]) .

:WriteLawyerAvailabilityCheckingDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Lawyer Availability Checking DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:LawyerAvailabilityChecking rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:LawyerAvailabilityChecking welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:LawyerAvailabilityChecking welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:LawyerAvailabilityChecking welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:LawyerAvailabilityChecking welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:LawyerAvailabilityChecking .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalLawyerAvailabilityCheckingYes
	a bt:Condition ;
	rdfs:label "Condition: LawyerAvailabilityCheck Confirmed" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:LawyerAvailabilityChecking rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:LawyerAvailabilityChecking welcome:DIPId ?id .						
							simulateAppointment:LawyerAvailabilityChecking welcome:hasSlot simulateAppointment:obtainCheckingConfirmation .	
							simulateAppointment:obtainCheckingConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )								
						}"""^^xsd:string ;
		]) .

:WriteAvailabilityRejectedDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Availability Rejected DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:AvailabilityRejected rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:AvailabilityRejected welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:AvailabilityRejected welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:AvailabilityRejected welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:AvailabilityRejected welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:AvailabilityRejected .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalLawyerAvailabilityCheckingNot
	a bt:Condition ;
	rdfs:label "Condition: LawyerAvailabilityCheck Not Confirmed" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:LawyerAvailabilityChecking rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:LawyerAvailabilityChecking welcome:DIPId ?id .						
							simulateAppointment:LawyerAvailabilityChecking welcome:hasSlot simulateAppointment:obtainCheckingConfirmation .	
							simulateAppointment:obtainCheckingConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )							
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateClosingUponFailureFarewellNoCheckingDIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - Lawyer Availability Checking Rejected - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailureFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailureFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonNoLawyerApprovalConfirmation .
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .	
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
						welcome:reifiedReasonSTReasonNoLawyerApprovalConfirmation rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonNoLawyerApprovalConfirmation rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonNoLawyerApprovalConfirmation rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonNoLawyerApprovalConfirmation rdf:object "STReasonNoLawyerApprovalConfirmation"^^xsd:string .					
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateClosingUponFailureFarewellNoCheckingDIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure DIP - Lawyer Availability Checking Rejected - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {						
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informClosingFailureFarewell .
						welcome:informClosingFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasTemplateId "TInformClosingFailureFarewell"^^xsd:string . 
						welcome:informClosingFailureFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:hasStatus welcome:Pending .
						welcome:informClosingFailureFarewell welcome:hasNumberAttempts 0 .
						welcome:informClosingFailureFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informClosingFailureFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informClosingFailureFarewell welcome:dependsOn welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:ConditionalAvailabilityRejectedComplete
	a bt:Condition ;
	rdfs:label "Condition: AvailabilityRejected Complete" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:AvailabilityRejected rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:AvailabilityRejected welcome:DIPId ?id .	
					}"""^^xsd:string ;
		]) .

:WriteLegalServiceCallbackDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Legal Service Callback DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:LegalServiceCallback rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:LegalServiceCallback welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:LegalServiceCallback welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:LegalServiceCallback welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:LegalServiceCallback welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:LegalServiceCallback .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalLegalServiceCallbackYes
	a bt:Condition ;
	rdfs:label "Condition: LegalServiceCallback Confirmed" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:LegalServiceCallback rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:LegalServiceCallback welcome:DIPId ?id .						
							simulateAppointment:LegalServiceCallback welcome:hasSlot simulateAppointment:obtainCallbackConfirmation .	
							simulateAppointment:obtainCallbackConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )								
						}"""^^xsd:string ;
		]) .

:ConditionalLegalServCallback_PremisesVisit_InformDetails_AforetimeAppReminderNot
	a bt:Condition ;
	rdfs:label "Condition: PRAKSIS Callback, Premises Visit, Appt Details, Aforetime Reminder not clear?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:LegalServiceCallback rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:LegalServiceCallback welcome:DIPId ?id .						
								simulateAppointment:LegalServiceCallback welcome:hasSlot simulateAppointment:obtainCallbackConfirmation .	
								simulateAppointment:obtainCallbackConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )												
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:PremisesVisitDescription rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:PremisesVisitDescription welcome:DIPId ?id .						
								simulateAppointment:PremisesVisitDescription welcome:hasSlot simulateAppointment:obtainPremisesVisitConfirmation .	
								simulateAppointment:obtainPremisesVisitConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )					
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:InformDetailsAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:InformDetailsAppointment welcome:DIPId ?id .						
								simulateAppointment:InformDetailsAppointment welcome:hasSlot simulateAppointment:obtainAppointmentDocumentsConfirmation .	
								simulateAppointment:obtainAppointmentDocumentsConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )					
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:AforetimeAppointmentReminder rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:AforetimeAppointmentReminder welcome:DIPId ?id .						
								simulateAppointment:AforetimeAppointmentReminder welcome:hasSlot simulateAppointment:obtainAforetimeReminderConfirmation .	
								simulateAppointment:obtainAforetimeReminderConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )					
							}
						}"""^^xsd:string ;
		]) .

:UpdateCreateInformContactNGOFarewellDIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Farewell DIP - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ContactNGOFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ContactNGOFarewell welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informInabilityAssist .						
						welcome:informInabilityAssist rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informInabilityAssist welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informInabilityAssist welcome:hasTemplateId "TInformInabilityAssist"^^xsd:string .
						welcome:informInabilityAssist welcome:hasInputRDFContents welcome:Unknown .
						welcome:informInabilityAssist welcome:hasTCNAnswer welcome:Unknown .
						welcome:informInabilityAssist welcome:hasStatus welcome:Pending .
						welcome:informInabilityAssist welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informInabilityAssist welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informInabilityAssist welcome:isOptional "false"^^xsd:boolean .
						welcome:informInabilityAssist welcome:dependsOn welcome:Unknown .
						welcome:informInabilityAssist welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateInformContactNGOFarewellDIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Farewell DIP - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informGenericPRAKSISContact .						
						welcome:informGenericPRAKSISContact rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informGenericPRAKSISContact welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informGenericPRAKSISContact welcome:hasTemplateId "TInformPRAKSISContact"^^xsd:string .
						welcome:informGenericPRAKSISContact welcome:hasInputRDFContents welcome:Unknown .
						welcome:informGenericPRAKSISContact welcome:hasTCNAnswer welcome:Unknown .
						welcome:informGenericPRAKSISContact welcome:hasStatus welcome:Pending .
						welcome:informGenericPRAKSISContact welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informGenericPRAKSISContact welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informGenericPRAKSISContact welcome:isOptional "false"^^xsd:boolean .
						welcome:informGenericPRAKSISContact welcome:dependsOn welcome:Unknown .
						welcome:informGenericPRAKSISContact welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateInformContactNGOFarewellDIP2Execution_Part3
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Farewell DIP - Part 3" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {								
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informContactNGOFarewell .
						welcome:informContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informContactNGOFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informContactNGOFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informContactNGOFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informContactNGOFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informContactNGOFarewell welcome:hasStatus welcome:Pending .
						welcome:informContactNGOFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informContactNGOFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informContactNGOFarewell welcome:isOptional "false"^^xsd:boolean .	
						welcome:informContactNGOFarewell welcome:dependsOn welcome:Unknown .
						welcome:informContactNGOFarewell welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:ConditionalCardYes_AltAuthen_PremVisitYesLawyer
	a bt:Condition ;
	rdfs:label "Condition: Card Yes or Alt Authen or Premises Visit with Lawyer?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:PRAKSISCard rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:PRAKSISCard welcome:DIPId ?id .								
								simulateAppointment:PRAKSISCard welcome:hasSlot simulateAppointment:obtainCardNumber .	
								simulateAppointment:obtainCardNumber welcome:hasTCNAnswer ?card . 
								?card rdf:type rdf:Statement .
								?card rdf:subject ?reifiedSubjectCard .
								?card rdf:predicate ?reifiedPredicateCard .
								FILTER NOT EXISTS { ?card rdf:object "Unknown" .}
								simulateAppointment:PRAKSISCard welcome:hasSlot simulateAppointment:flagIsOfficerRole .	
								simulateAppointment:flagIsOfficerRole welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )	
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:AlternativeAuthentification rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:AlternativeAuthentification welcome:DIPId ?id .
								simulateAppointment:AlternativeAuthentification welcome:hasSlot simulateAppointment:flagIsOfficerRole .	
								simulateAppointment:flagIsOfficerRole welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )	
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:PremisesVisitDescription rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:PremisesVisitDescription welcome:DIPId ?id .
								simulateAppointment:PremisesVisitDescription welcome:hasSlot simulateAppointment:flagIsOfficerRole .	
								simulateAppointment:flagIsOfficerRole welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )	
								simulateAppointment:PremisesVisitDescription welcome:hasSlot simulateAppointment:obtainPremisesVisitConfirmation .	
								simulateAppointment:obtainPremisesVisitConfirmation welcome:hasTCNAnswer ?reifiedAnswerPremises .
								?reifiedAnswerPremises rdf:type rdf:Statement .
								?reifiedAnswerPremises rdf:subject ?reifiedSubjectPremises .
								?reifiedAnswerPremises rdf:predicate ?reifiedPredicatePremises .
								?reifiedAnswerPremises rdf:object ?answerPremises .
								FILTER (STRENDS(str(?answerPremises), "true") || STRENDS(str(?answerPremises), "True") || STRENDS(str(?answerPremises), "Yes") || STRENDS(str(?answerPremises), "yes") || ?answer = true )					
							}
						}"""^^xsd:string ;
		]) .

:WriteMakeAppointmentDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Make Appointment DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:MakeAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:MakeAppointment welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:MakeAppointment welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:MakeAppointment welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:MakeAppointment welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:MakeAppointment .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalFirstContactYes
	a bt:Condition ;
	rdfs:label "Condition: First PRAKSIS Contact Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:FirstContactInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:FirstContactInformation welcome:DIPId ?id .						
							simulateAppointment:FirstContactInformation welcome:hasSlot simulateAppointment:obtainFirstContactPRAKSIS .	
							simulateAppointment:obtainFirstContactPRAKSIS welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )								
						}"""^^xsd:string ;
		]) .

:WritePremisesVisitDescriptionDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Premises Visit Description DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:PremisesVisitDescription rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:PremisesVisitDescription welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:PremisesVisitDescription welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:PremisesVisitDescription welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:PremisesVisitDescription welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:PremisesVisitDescription .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalFirstContactNot
	a bt:Condition ;
	rdfs:label "Condition: First PRAKSIS Contact Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:FirstContactInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:FirstContactInformation welcome:DIPId ?id .						
							simulateAppointment:FirstContactInformation welcome:hasSlot simulateAppointment:obtainFirstContactPRAKSIS .	
							simulateAppointment:obtainFirstContactPRAKSIS welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )							
						}"""^^xsd:string ;
		]) .
		
:WriteAlternativeAuthentificationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Alternative Authentification DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:AlternativeAuthentification rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:AlternativeAuthentification welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:AlternativeAuthentification welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:AlternativeAuthentification welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:AlternativeAuthentification welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:AlternativeAuthentification .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalMakeAppointmentYes
	a bt:Condition ;
	rdfs:label "Condition: Appointment Confirmed?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:MakeAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:MakeAppointment welcome:DIPId ?id .						
							simulateAppointment:MakeAppointment welcome:hasSlot simulateAppointment:obtainConfirmationTimeSlot .	
							simulateAppointment:obtainConfirmationTimeSlot welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )												
						}"""^^xsd:string ;
		]) .

:WriteObtainTCNInformationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Obtain TCN Information DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:ObtainTCNInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:ObtainTCNInformation welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:ObtainTCNInformation welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:ObtainTCNInformation welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:ObtainTCNInformation welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:ObtainTCNInformation .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalMakeAppointmentNot
	a bt:Condition ;
	rdfs:label "Condition: Appointment Not Confirmed?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:MakeAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:MakeAppointment welcome:DIPId ?id .						
								simulateAppointment:MakeAppointment welcome:hasSlot simulateAppointment:obtainConfirmationTimeSlot .	
								simulateAppointment:obtainConfirmationTimeSlot welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )											
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:MakeAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:MakeAppointment welcome:DIPId ?id .						
								simulateAppointment:MakeAppointment welcome:hasSlot simulateAppointment:obtainConfirmationTimeSlot .
								simulateAppointment:obtainConfirmationTimeSlot welcome:hasStatus welcome:Unfinished .
							}
						}"""^^xsd:string ;
		]) .

:WriteAppointmentRejectedCallbackDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Appointment Rejected Callback DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:AppointmentRejectedCallback rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:AppointmentRejectedCallback welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:AppointmentRejectedCallback welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:AppointmentRejectedCallback welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:AppointmentRejectedCallback welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:AppointmentRejectedCallback .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalObtainTCNInfoComplete_CardYes
	a bt:Condition ;
	rdfs:label "Condition: TCN Info complete with praksis card ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:ObtainTCNInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:ObtainTCNInformation welcome:DIPId ?id .						
							simulateAppointment:ObtainTCNInformation welcome:hasSlot simulateAppointment:flagPRAKSISCard .	
							simulateAppointment:flagPRAKSISCard welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							FILTER NOT EXISTS { ?reifiedAnswer rdf:object "Unknown" . }													
						}"""^^xsd:string ;
		]) .
		
:WriteInformDetailsAppointmentDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Inform Details Appointment DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:InformDetailsAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:InformDetailsAppointment welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:InformDetailsAppointment welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:InformDetailsAppointment welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:InformDetailsAppointment welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:InformDetailsAppointment .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalObtainTCNInfoComplete_CardNot
	a bt:Condition ;
	rdfs:label "Condition: TCN Info complete without praksis card ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							simulateAppointment:ObtainTCNInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:ObtainTCNInformation welcome:DIPId ?id .						
							simulateAppointment:ObtainTCNInformation welcome:hasSlot simulateAppointment:flagPRAKSISCard .
							simulateAppointment:flagPRAKSISCard welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object "Unknown" . 
						}"""^^xsd:string ;
		]) .
		
:WriteAforetimeAppointmentReminderDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Aforetime Appointment Reminder DIP in Execution" ;
	bt:query [
					a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:AforetimeAppointmentReminder rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:AforetimeAppointmentReminder welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:AforetimeAppointmentReminder welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:AforetimeAppointmentReminder welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:AforetimeAppointmentReminder welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:AforetimeAppointmentReminder .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalInformDetails_AforetimeAppReminderYes
	a bt:Condition ;
	rdfs:label "Condition: Inform details or aforetime apptm confirmed ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{	
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:InformDetailsAppointment rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:InformDetailsAppointment welcome:DIPId ?id .						
								simulateAppointment:InformDetailsAppointment welcome:hasSlot simulateAppointment:obtainAppointmentDocumentsConfirmation .	
								simulateAppointment:obtainAppointmentDocumentsConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes" ) || ?answer = true )																					
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								simulateAppointment:AforetimeAppointmentReminder rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								simulateAppointment:AforetimeAppointmentReminder welcome:DIPId ?id .						
								simulateAppointment:AforetimeAppointmentReminder welcome:hasSlot simulateAppointment:obtainAforetimeReminderConfirmation .	
								simulateAppointment:obtainAforetimeReminderConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )							
							}
						}"""^^xsd:string ;
		]) .
				
:WriteAppointmentSummaryDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Appointment Summary DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							simulateAppointment:AppointmentSummary rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							simulateAppointment:AppointmentSummary welcome:belongsTo simulateAppointment:simulatePraksisAppointmentService .
							simulateAppointment:AppointmentSummary welcome:isCurrentDIP "true"^^xsd:boolean .
							simulateAppointment:AppointmentSummary welcome:hasDIPStatus welcome:Unknown .
							simulateAppointment:AppointmentSummary welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							simulateAppointment:simulatePraksisAppointmentService rdf:type service:Service .
							simulateAppointment:simulatePraksisAppointmentService service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP simulateAppointment:AppointmentSummary .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure Farewell DIP - Unknown DIP Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailureFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailureFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 						
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .	
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonInternalFailure .
						welcome:reifiedReasonSTReasonInternalFailure rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonInternalFailure rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonInternalFailure rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonInternalFailure rdf:object "STReasonInternalFailure"^^xsd:string .							
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateClosingUponFailureFarewellUnknownDIP_Part2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure Farewell DIP - Unknown DIP Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informClosingFailureFarewell .
						welcome:informClosingFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasTemplateId "TInformClosingFailureFarewell"^^xsd:string . 						
						welcome:informClosingFailureFarewell welcome:hasStatus welcome:Pending .
						welcome:informClosingFailureFarewell welcome:hasNumberAttempts 0 .
						welcome:informClosingFailureFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informClosingFailureFarewell welcome:isOptional "false"^^xsd:boolean .	
						welcome:informClosingFailureFarewell welcome:hasInputRDFContents welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

#=============================================================================================
# SpecificFullAsylumRegistrationBT

:EventHandlerDisplayedForm 
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Notification Form Displayed" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ReceiveKMSNotificationDisplayEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:preFilledForm welcome:displayed "true" .
						}
						WHERE {
							welcome:preFilledForm welcome:displayed "true" .
						}"""^^xsd:string ;
				] .

:WritePrefilledFormDisclaimerDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Prefilled Form Disclaimer DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:PrefilledFormDisclaimer rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormDisclaimer welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:PrefilledFormDisclaimer welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:PrefilledFormDisclaimer welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:PrefilledFormDisclaimer welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:PrefilledFormDisclaimer .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:EventHandlerPrintedForm
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Notification Form Printed" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ReceiveKMSNotificationPrintEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>	
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:preFilledForm welcome:printed "true" .
						}
						WHERE {
							welcome:preFilledForm welcome:printed "true" .
						}"""^^xsd:string ;
				] .

:WriteLoginStepDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Login Step DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:LoginStep rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:LoginStep welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:LoginStep welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:LoginStep welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:LoginStep welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:LoginStep .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:EventHandlerExecuteAsylumRegistration
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Execute Full Asylum Registration BT" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#FullAsylumRegistrationEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 					
						CONSTRUCT {
							welcome:myWelcomeAgent welcome:executeScenario "FullAsylumRegistration" .
						}
						WHERE { 
							welcome:myWelcomeAgent welcome:executeScenario "FullAsylumRegistration" .	
						}"""^^xsd:string ;
				] .

:ConditionalScenarioIntroductionAndInterestYes
	a bt:Condition ;
	rdfs:label "Condition: Scenario Intro completed and interest yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:ScenarioIntroduction welcome:DIPId ?id .						
							fullpreregistration:ScenarioIntroduction welcome:hasSlot fullpreregistration:obtainInterest .	
							fullpreregistration:obtainInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )																					
								
					}"""^^xsd:string ;
		]) .
		
:WriteAsylumPreRegistrationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Asylum PreRegistration DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:AsylumPreRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumPreRegistration welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:AsylumPreRegistration welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:AsylumPreRegistration welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:AsylumPreRegistration welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:AsylumPreRegistration .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalScenarioIntroductionAndInterestNot_RegistrationProcessDetailsNot_AsylumServiceAppNot
	a bt:Condition ;
	rdfs:label "Condition: Scenario Intro Interest Not and Reg Process and Asylum Service Not? Asylum Confirm Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								fullpreregistration:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								fullpreregistration:ScenarioIntroduction welcome:DIPId ?id .						
								fullpreregistration:ScenarioIntroduction welcome:hasSlot fullpreregistration:obtainInterest .	
								fullpreregistration:obtainInterest welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )																					
							}
							UNION  
							{
								?bt welcome:hasActiveDIP ?id . 
								fullpreregistration:RegistrationProcessDetails rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								fullpreregistration:RegistrationProcessDetails welcome:DIPId ?id .						
								fullpreregistration:RegistrationProcessDetails welcome:hasSlot fullpreregistration:obtainRegistrationInterest .	
								fullpreregistration:obtainRegistrationInterest welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )					
							}
							UNION  
							{
								?bt welcome:hasActiveDIP ?id . 
								fullpreregistration:AsylumServiceApp rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								fullpreregistration:AsylumServiceApp welcome:DIPId ?id .						
								fullpreregistration:AsylumServiceApp welcome:hasSlot fullpreregistration:obtainOverviewInterest .	
								fullpreregistration:obtainOverviewInterest welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )					
							}
							UNION  
							{
								?bt welcome:hasActiveDIP ?id . 
								fullpreregistration:AsylumClaimRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								fullpreregistration:AsylumClaimRegistration welcome:DIPId ?id .						
								fullpreregistration:AsylumClaimRegistration welcome:hasSlot fullpreregistration:obtainAsylumClaimRegistration .	
								fullpreregistration:obtainAsylumClaimRegistration welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )									
							}
					}"""^^xsd:string ;
		]) .

:UpdateCreateNormalClosingFarewellS2aDIP2Execution_Part1 
	a bt:Update ;
	rdfs:label "Update: Normal Closing Farewell S2a DIP - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 					
					INSERT {
						welcome:NormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:NormalClosingFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:NormalClosingFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informEnd .
						welcome:informEnd rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informEnd welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informEnd welcome:hasTemplateId "TInformEnd_S2a"^^xsd:string .
						welcome:informEnd welcome:hasInputRDFContents welcome:Unknown .	
						welcome:informEnd welcome:hasTCNAnswer welcome:Unknown .
						welcome:informEnd welcome:hasStatus welcome:Pending .		
						welcome:informEnd welcome:hasNumberAttempts 0 .
						welcome:informEnd welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informEnd welcome:isOptional "false"^^xsd:boolean .	
						welcome:informEnd welcome:dependsOn welcome:Unknown .
						welcome:informEnd welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?a rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateNormalClosingFarewellS2aDIP2Execution_Part2 
	a bt:Update ;
	rdfs:label "Update: Normal Closing Farewell S2a DIP - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 					
					INSERT {
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informNormalClosingFarewell .
						welcome:informNormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informNormalClosingFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informNormalClosingFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informNormalClosingFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasStatus welcome:Pending .
						welcome:informNormalClosingFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informNormalClosingFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informNormalClosingFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informNormalClosingFarewell welcome:dependsOn welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?a rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:ConditionalAsylumPreRegistrationYes
	a bt:Condition ;
	rdfs:label "Condition: Asylum PreRegistration Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:AsylumPreRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumPreRegistration welcome:DIPId ?id .						
							fullpreregistration:AsylumPreRegistration welcome:hasSlot fullpreregistration:obtainRegistration .	
							fullpreregistration:obtainRegistration welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )																					
								
					}"""^^xsd:string ;
		]) .
		
:WriteAsylumApplicationKnowledgeDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Asylum Application Knowledge DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:AsylumApplicationKnowledge rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumApplicationKnowledge welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:AsylumApplicationKnowledge welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:AsylumApplicationKnowledge welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:AsylumApplicationKnowledge welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:AsylumApplicationKnowledge .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalAsylumPreRegistrationNot
	a bt:Condition ;
	rdfs:label "Condition: Asylum PreRegistration Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:AsylumPreRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumPreRegistration welcome:DIPId ?id .						
							fullpreregistration:AsylumPreRegistration welcome:hasSlot fullpreregistration:obtainRegistration .	
							fullpreregistration:obtainRegistration welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )									
								
					}"""^^xsd:string ;
		]) .
		
:WriteAsylumClaimRegistrationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Asylum Claim Registration DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:AsylumClaimRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumClaimRegistration welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:AsylumClaimRegistration welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:AsylumClaimRegistration welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:AsylumClaimRegistration welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:AsylumClaimRegistration .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalAsylumApplicationKnowledgeYes
	a bt:Condition ;
	rdfs:label "Condition: Asylum Application Knowledge Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:AsylumApplicationKnowledge rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumApplicationKnowledge welcome:DIPId ?id .						
							fullpreregistration:AsylumApplicationKnowledge welcome:hasSlot fullpreregistration:obtainApplicationKnowledge .	
							fullpreregistration:obtainApplicationKnowledge welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )										
								
					}"""^^xsd:string ;
		]) .
		
:WriteRegistrationProcessDetailsDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Registration Process Details DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:RegistrationProcessDetails rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:RegistrationProcessDetails welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:RegistrationProcessDetails welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:RegistrationProcessDetails welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:RegistrationProcessDetails welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:RegistrationProcessDetails .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalAppliKnowledgeNot
	a bt:Condition ;
	rdfs:label "Condition: Asylum Application Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:AsylumApplicationKnowledge rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumApplicationKnowledge welcome:DIPId ?id .						
							fullpreregistration:AsylumApplicationKnowledge welcome:hasSlot fullpreregistration:obtainApplicationKnowledge .	
							fullpreregistration:obtainApplicationKnowledge welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )									
					}"""^^xsd:string ;
		]) .

:ConditionalBeginFillingOnlineFormPreregistrationNumUnknown
	a bt:Condition ;
	rdfs:label "Condition: Preregistration Num Unknown?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:BeginFillingOnlineForm rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:BeginFillingOnlineForm welcome:DIPId ?id .						
							fullpreregistration:BeginFillingOnlineForm welcome:hasSlot fullpreregistration:obtainAsylumPreRegistrationNumber .	
							fullpreregistration:obtainAsylumPreRegistrationNumber welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object "Unknown" .
					}"""^^xsd:string ;
		]) .

:ConditionalAnyConfirmInfoTCNAnswerNot
	a bt:Condition ;
	rdfs:label "Condition: Any Confirmation Not" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							?dipName welcome:DIPId ?id .						
							?dipName welcome:hasSlot ?slotName .	
							?slotName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ConfirmationRequest"^^xsd:anyURI .
							?slotName welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )					
					}"""^^xsd:string ;
		]) .
		
:ConditionalRegistrationProcessDetailsYes
	a bt:Condition ;
	rdfs:label "Condition: Registration Process Details Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:RegistrationProcessDetails rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:RegistrationProcessDetails welcome:DIPId ?id .						
							fullpreregistration:RegistrationProcessDetails welcome:hasSlot fullpreregistration:obtainRegistrationInterest .	
							fullpreregistration:obtainRegistrationInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteAsylumServiceAppDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Asylum Servic App DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:AsylumServiceApp rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumServiceApp welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:AsylumServiceApp welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:AsylumServiceApp welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:AsylumServiceApp welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:AsylumServiceApp .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalAsylumServiceAppYes
	a bt:Condition ;
	rdfs:label "Condition: Asylum Service Application Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:AsylumServiceApp rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AsylumServiceApp welcome:DIPId ?id .						
							fullpreregistration:AsylumServiceApp welcome:hasSlot fullpreregistration:obtainOverviewInterest .	
							fullpreregistration:obtainOverviewInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteWebsiteProcedureDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Website Procedure DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:WebsiteProcedure rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:WebsiteProcedure welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:WebsiteProcedure welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:WebsiteProcedure welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:WebsiteProcedure welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:WebsiteProcedure .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalWebsiteProcedureConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Website Procedure Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:WebsiteProcedure rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:WebsiteProcedure welcome:DIPId ?id .						
							fullpreregistration:WebsiteProcedure welcome:hasSlot fullpreregistration:obtainConfirmationRequiredInfo .	
							fullpreregistration:obtainConfirmationRequiredInfo welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteBeginFillingOnlineFormDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Begin Filling Online Form DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:BeginFillingOnlineForm rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:BeginFillingOnlineForm welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:BeginFillingOnlineForm welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:BeginFillingOnlineForm welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:BeginFillingOnlineForm welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:BeginFillingOnlineForm .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalBeginFillingOnlineFormNumberKnown
	a bt:Condition ;
	rdfs:label "Condition: Preregistration Num known?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:BeginFillingOnlineForm rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:BeginFillingOnlineForm welcome:DIPId ?id .						
							fullpreregistration:BeginFillingOnlineForm welcome:hasSlot fullpreregistration:obtainAsylumPreRegistrationNumber .
							fullpreregistration:obtainAsylumPreRegistrationNumber welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .	
							FILTER NOT EXISTS {?reifiedAnswer rdf:object "Unknown" . }								
					}"""^^xsd:string ;
		]) .
		
:WriteIdentificationStepSurnameDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Identification Step Surname DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:IdentificationStepSurname rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepSurname welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:IdentificationStepSurname welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:IdentificationStepSurname welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:IdentificationStepSurname welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:IdentificationStepSurname .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalIdentificationStepSurnameConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Identification Step  - Surname Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:IdentificationStepSurname rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepSurname welcome:DIPId ?id .						
							fullpreregistration:IdentificationStepSurname welcome:hasSlot fullpreregistration:obtainConfirmationSurnameStep .	
							fullpreregistration:obtainConfirmationSurnameStep welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteIdentificationStepNameDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Identification Step Name DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:IdentificationStepName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepName welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:IdentificationStepName welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:IdentificationStepName welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:IdentificationStepName welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:IdentificationStepName .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalIdentificationStepNameConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Identification Step  - Name Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:IdentificationStepName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepName welcome:DIPId ?id .						
							fullpreregistration:IdentificationStepName welcome:hasSlot fullpreregistration:obtainConfirmationNameStep .	
							fullpreregistration:obtainConfirmationNameStep welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true)															
					}"""^^xsd:string ;
		]) .
		
:WriteIdentificationStepBirthdateDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Identification Step Birthdate DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:IdentificationStepBirthdate rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepBirthdate welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:IdentificationStepBirthdate welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:IdentificationStepBirthdate welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:IdentificationStepBirthdate welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:IdentificationStepBirthdate .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalIdentificationStepBirthdateConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Identification Step  - Birthdate Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:IdentificationStepBirthdate rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepBirthdate welcome:DIPId ?id .						
							fullpreregistration:IdentificationStepBirthdate welcome:hasSlot fullpreregistration:obtainConfirmationBirthdateStep .	
							fullpreregistration:obtainConfirmationBirthdateStep welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteIdentificationStepTelephoneDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Identification Step Telephone DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:IdentificationStepTelephone rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepTelephone welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:IdentificationStepTelephone welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:IdentificationStepTelephone welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:IdentificationStepTelephone welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:IdentificationStepTelephone .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalIdentificationStepTelephoneConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Identification Step  - Telephone Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:IdentificationStepTelephone rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepTelephone welcome:DIPId ?id .						
							fullpreregistration:IdentificationStepTelephone welcome:hasSlot fullpreregistration:obtainConfirmationTelephoneStep .	
							fullpreregistration:obtainConfirmationTelephoneStep welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteIdentificationStepCaptchaDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Identification Step Captcha DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:IdentificationStepCaptcha rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepCaptcha welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:IdentificationStepCaptcha welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:IdentificationStepCaptcha welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:IdentificationStepCaptcha welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:IdentificationStepCaptcha .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionalIdentificationStepCaptchaConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Identification Step Captcha Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:IdentificationStepCaptcha rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:IdentificationStepCaptcha welcome:DIPId ?id .						
							fullpreregistration:IdentificationStepCaptcha welcome:hasSlot fullpreregistration:obtainConfirmationCaptchaStep .	
							fullpreregistration:obtainConfirmationCaptchaStep welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true)															
					}"""^^xsd:string ;
		]) .
		
:WritePrefilledFormVisualizationDIP2Execution	
	a bt:Write ;
	rdfs:label "Write: Prefilled Form Visualization DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:PrefilledFormVisualization rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormVisualization welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:PrefilledFormVisualization welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:PrefilledFormVisualization welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:PrefilledFormVisualization welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:PrefilledFormVisualization .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionalPrefilledFormVisualizationYes
	a bt:Condition ;
	rdfs:label "Condition: Visualize prefilled form Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:PrefilledFormVisualization rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormVisualization welcome:DIPId ?id .						
							fullpreregistration:PrefilledFormVisualization welcome:hasSlot fullpreregistration:obtainVisualizationInterest .	
							fullpreregistration:obtainVisualizationInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .

:UpdateCreateHeaderAppMessageDisplay
	a bt:Update ;
	rdfs:label "Update: Header Message for App - Display " ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE{
						?headerSubject welcome:hasHeaderValue ?typeval .
						?headerValSubject welcome:hasHeaderValue ?typeHeaderval .
					}
					INSERT {
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .					
						welcome:headerMsgType welcome:hasHeaderName "X-Msg-Type" .
						welcome:headerMsgType welcome:hasHeaderValue "DisplayUI" .
					} 
					WHERE { 
						?du rdf:type welcome:DialogueUser .
						?msg welcome:hasCorrelationID ?correlationID .
						?du welcome:hasUserId ?idObject .
						?idObject welcome:hasValue ?id .
						OPTIONAL {?headerSubject welcome:hasHeaderValue ?typeval .}
						OPTIONAL {?headerValSubject welcome:hasHeaderValue ?typeHeaderval .}
					}
					"""^^xsd:string ;
		]) .
		
:MessageSendDisplayNotification2App
	a myWelcome:Message ;
	rdfs:label "Message: Send Display Notification to App"^^xsd:string ;
	rdfs:comment "Message: Send Display Notification to App"^^xsd:string ;
	bt:targetBase ajan:AgentKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayPrefilledForm "true" .
						}
						WHERE {
							?agent rdf:type ajan:Agent .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionalPrefilledFormVisualizationNot_PrefilledFormPrintedNot
	a bt:Condition ;
	rdfs:label "Condition: Visualize prefilled form Not? Print Form Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								fullpreregistration:PrefilledFormVisualization rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								fullpreregistration:PrefilledFormVisualization welcome:DIPId ?id .						
								fullpreregistration:PrefilledFormVisualization welcome:hasSlot fullpreregistration:obtainVisualizationInterest .	
								fullpreregistration:obtainVisualizationInterest welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )		
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								fullpreregistration:PrefilledFormPrinted rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								fullpreregistration:PrefilledFormPrinted welcome:DIPId ?id .						
								fullpreregistration:PrefilledFormPrinted welcome:hasSlot fullpreregistration:obtainPrintedInterest .	
								fullpreregistration:obtainPrintedInterest welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False") || ?answer = false )							
							}
					}"""^^xsd:string ;
		]) .
		
:WriteLoginStepDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Login Step DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:LoginStep rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:LoginStep welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:LoginStep welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:LoginStep welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:LoginStep welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:LoginStep .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalPrefilledFormDisclaimerConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Prefilled Form Disclaimer Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:PrefilledFormDisclaimer rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormDisclaimer welcome:DIPId ?id .						
							fullpreregistration:PrefilledFormDisclaimer welcome:hasSlot fullpreregistration:obtainConfirmationDisclaimer .	
							fullpreregistration:obtainConfirmationDisclaimer welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WritePrefilledFormUsageDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Prefilled Form Usage DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:PrefilledFormUsage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormUsage welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:PrefilledFormUsage welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:PrefilledFormUsage welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:PrefilledFormUsage welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:PrefilledFormUsage .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalPrefilledFormUsageConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Prefilled Form Usage Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:PrefilledFormUsage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormUsage welcome:DIPId ?id .						
							fullpreregistration:PrefilledFormUsage welcome:hasSlot fullpreregistration:obtainConfirmationUsage .	
							fullpreregistration:obtainConfirmationUsage welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WritePrefilledFormPrintedDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Prefilled Form Printed DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:PrefilledFormPrinted rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormPrinted welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:PrefilledFormPrinted welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:PrefilledFormPrinted welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:PrefilledFormPrinted welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:PrefilledFormPrinted .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalPrefilledFormPrintedYes
	a bt:Condition ;
	rdfs:label "Condition: Prefilled Form Printed Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:PrefilledFormPrinted rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:PrefilledFormPrinted welcome:DIPId ?id .						
							fullpreregistration:PrefilledFormPrinted welcome:hasSlot fullpreregistration:obtainPrintedInterest .	
							fullpreregistration:obtainPrintedInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:SendPrintNotification2App
	a myWelcome:Message ;
	rdfs:label "Message: Send Print Notification to App"^^xsd:string ;
	rdfs:comment "Message: Send Print Notification to App"^^xsd:string ;
	bt:targetBase ajan:AgentKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:printPrefilledForm "true" .
						}
						WHERE {
							?agent rdf:type ajan:Agent .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionalLoginStepConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Login Step Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:LoginStep rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:LoginStep welcome:DIPId ?id .						
							fullpreregistration:LoginStep welcome:hasSlot fullpreregistration:obtainConfirmationLogin .	
							fullpreregistration:obtainConfirmationLogin welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteLanguageStepDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Language Step DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:LanguageStep rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:LanguageStep welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:LanguageStep welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:LanguageStep welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:LanguageStep welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:LanguageStep .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .
	
:ConditionalLanguageStepConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Language Step Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:LanguageStep rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:LanguageStep welcome:DIPId ?id .						
							fullpreregistration:LanguageStep welcome:hasSlot fullpreregistration:obtainConfirmationLanguage .	
							fullpreregistration:obtainConfirmationLanguage welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes") || ?answer = true )															
					}"""^^xsd:string ;
		]) .
		
:WriteAdditionalQuestionsDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Additional Questions DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
				PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
				PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							fullpreregistration:AdditionalQuestions rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AdditionalQuestions welcome:belongsTo fullpreregistration:fullAsylumRegistration .
							fullpreregistration:AdditionalQuestions welcome:isCurrentDIP "true"^^xsd:boolean .
							fullpreregistration:AdditionalQuestions welcome:hasDIPStatus welcome:Unknown .
							fullpreregistration:AdditionalQuestions welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
							fullpreregistration:fullAsylumRegistration  rdf:type service:Service .
							fullpreregistration:fullAsylumRegistration service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP fullpreregistration:AdditionalQuestions .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
				} """^^xsd:string ;
	] .

:ConditionalAdditionalQuestionsCompleted
	a bt:Condition ;
	rdfs:label "Condition: Additional Questions Completed?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							fullpreregistration:AdditionalQuestions rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							fullpreregistration:AdditionalQuestions welcome:DIPId ?id .		
					}"""^^xsd:string ;
		]) .
#=============================================================================================
# CVCreation

:EventHandlerCVNotification
	a bt:HandleEvent ;
	rdfs:label "EventHandler: CV Created in the App" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ReceiveKMSNotificationS7Event> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
								PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
								PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
								PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
								PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
								CONSTRUCT {
									welcome:KMSNotifies ?pre ?boolVal .
								}
								WHERE { 
									welcome:KMSNotifies ?pre ?boolVal .
								}"""^^xsd:string ;
				] .

:WriteNotificationToExecution
	a bt:Write ;
	rdfs:label "Write: KMS S7 Notification from LAKR to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					CONSTRUCT  {
						welcome:KMSNotifies ?pred ?val .
					}
					WHERE {
						 welcome:KMSNotifies ?pred ?val .		
					}"""^^xsd:string ;
	] .
	
:DeleteS7NotificationFromLAKR
	a bt:Update ;
	rdfs:label "Update: Delete S7 Notification from LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					DELETE {
						welcome:KMSNotifies ?pred ?val .
					} 
					WHERE { 
						welcome:KMSNotifies ?pred ?val .
					}"""^^xsd:string ;
		]) .


:ConditionIsPersonalInfoFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Personal Info Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:PersonalInfo "true" .									
					}"""^^xsd:string ;
		]) .

:MessageSendPersonalInfoSectionToApp 
	a myWelcome:Message ;
	rdfs:label "Message: Send Personal Info Section to App"^^xsd:string ;
	rdfs:comment "Message: Send Personal Info Section to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayPersonalInfoSection "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?pred ?val .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionIsEducationInformationFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Education Information Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:EducationInformation "true" .									
					}"""^^xsd:string ;
		]) .
		
:MessageSendEducationInformationSectionToApp
	a myWelcome:Message ;
	rdfs:label "Message: Education Information Section to App"^^xsd:string ;
	rdfs:comment "Message: Education Information Section to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayEducationInformationSection "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?pred ?val .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionIsOtherEducationInformationFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Other Education Information Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:OtherEducationInformation "true" .									
					}"""^^xsd:string ;
		]) .
		
:MessageSendOtherEducationInformationSectionToApp 
	a myWelcome:Message ;
	rdfs:label "Message: Send Other Education Information Section to App"^^xsd:string ;
	rdfs:comment "Message: Send Other Education Information Section to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayOtherEducationInformationSection "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?pred ?val .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionIsLanguageInformationFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Language Information Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:LanguageInformation "true" .									
					}"""^^xsd:string ;
		]) .
		
:MessageSendLanguageInformationSectionToApp
	a myWelcome:Message ;
	rdfs:label "Message: Send Language Information Section to App"^^xsd:string ;
	rdfs:comment "Message: Send Language Information Section to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayLanguageInformationSection "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?pred ?val .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionIsEmploymentInformationFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Employment Information Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:EmploymentInformation "true" .									
					}"""^^xsd:string ;
		]) .
		
:MessageSendEmploymentInformationSectionToApp 
	a myWelcome:Message ;
	rdfs:label "Message: Send Employment Information Section to App"^^xsd:string ;
	rdfs:comment "Message: Send Employment Information Section to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayEmploymentInformationSection "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?pred ?val .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:ConditionIsSkillInformationFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Skill Information Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:SkillInformation "true" .									
					}"""^^xsd:string ;
		]) .
		
:ConditionIsOtherInformationFinished
	a bt:Condition ;
	rdfs:label "Condition: Was the Other Information Finished?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							welcome:KMSNotifies welcome:OtherInformation "true" .									
					}"""^^xsd:string ;
		]) .
		
:MessageSendOtherInformationSectionToApp
	a myWelcome:Message ;
	rdfs:label "Message: Send Other Information Section to App"^^xsd:string ;
	rdfs:comment "Message: Send Other Information Section to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayOtherInformationSection "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?pred ?val .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

#:ConditionCreateCVDocumentFinished
#:MessageSendCreateCVDocumentSectionToApp 
																																	
:EventHandlerExecuteCVCreationBT
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Executing CV Creation Move" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#CVCreationEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
								PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
								PREFIX ajan: <http://www.ajan.de/ajan-ns#>
								PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
								CONSTRUCT {
									welcome:myWelcomeAgent welcome:executeScenario "CVCreation" .
								}
								WHERE { 
									welcome:myWelcomeAgent welcome:executeScenario "CVCreation" .
								}"""^^xsd:string ;
				] .
				
:ConditionalCVPurposeInterestYes
	a bt:Condition ;
	rdfs:label "Condition: CV Purpose Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:CVPurpose rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:CVPurpose welcome:DIPId ?id .						
							employment:CVPurpose welcome:hasSlot employment:obtainCVCreationInterest .	
							employment:obtainCVCreationInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .
		
:WritePersonalInfoDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Personal Info DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:PersonalInfo rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:PersonalInfo welcome:belongsTo employment:createCV .
						employment:PersonalInfo welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:PersonalInfo welcome:hasDIPStatus welcome:Unknown .
						employment:PersonalInfo welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:PersonalInfo .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .

:ConditionalCVPurposeInterestNot
	a bt:Condition ;
	rdfs:label "Condition: CV Purpose and Confirmation Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:CVPurpose rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:CVPurpose welcome:DIPId ?id .						
							employment:CVPurpose welcome:hasSlot employment:obtainCVCreationInterest .	
							employment:obtainCVCreationInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "False"))					
						}"""^^xsd:string ;
		]) .

:UpdateCreateInformContactNGOFarewell_GENERIC_DIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Generic Farewell DIP - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ContactNGOFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ContactNGOFarewell welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informInabilityAssist .						
						welcome:informInabilityAssist rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informInabilityAssist welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informInabilityAssist welcome:hasTemplateId "TInformInabilityAssist"^^xsd:string .
						welcome:informInabilityAssist welcome:hasInputRDFContents welcome:Unknown .
						welcome:informInabilityAssist welcome:hasTCNAnswer welcome:Unknown .
						welcome:informInabilityAssist welcome:hasStatus welcome:Pending .
						welcome:informInabilityAssist welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informInabilityAssist welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informInabilityAssist welcome:isOptional "false"^^xsd:boolean .
						welcome:informInabilityAssist welcome:dependsOn welcome:Unknown .
						welcome:informInabilityAssist welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateInformContactNGOFarewell_GENERIC_DIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Generic Farewell DIP - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informGenericContact .						
						welcome:informGenericContact rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informGenericContact welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informGenericContact welcome:hasTemplateId "TInformGenericContact"^^xsd:string .
						welcome:informGenericContact welcome:hasInputRDFContents welcome:Unknown .
						welcome:informGenericContact welcome:hasTCNAnswer welcome:Unknown .
						welcome:informGenericContact welcome:hasStatus welcome:Pending .
						welcome:informGenericContact welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informGenericContact welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informGenericContact welcome:isOptional "false"^^xsd:boolean .
						welcome:informGenericContact welcome:dependsOn welcome:Unknown .
						welcome:informGenericContact welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateInformContactNGOFarewell_GENERIC_DIP2Execution_Part3
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Generic Farewell DIP - Part 3" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {								
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informContactNGOFarewell .
						welcome:informContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informContactNGOFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informContactNGOFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informContactNGOFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informContactNGOFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informContactNGOFarewell welcome:hasStatus welcome:Pending .
						welcome:informContactNGOFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informContactNGOFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informContactNGOFarewell welcome:isOptional "false"^^xsd:boolean .	
						welcome:informContactNGOFarewell welcome:dependsOn welcome:Unknown .
						welcome:informContactNGOFarewell welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:ConditionalPersonalInfoConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Personal Info and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:PersonalInfo rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:PersonalInfo welcome:DIPId ?id .						
							employment:PersonalInfo welcome:hasSlot employment:obtainPersonalInfoConfirmation .	
							employment:obtainPersonalInfoConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .

:WriteEducationInformationDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Education Information DIP in Execution" ;
	bt:query [
			a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							employment:EducationInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:EducationInformation welcome:belongsTo employment:createCV .
							employment:EducationInformation welcome:isCurrentDIP "true"^^xsd:boolean .
							employment:EducationInformation welcome:hasDIPStatus welcome:Unknown .
							employment:EducationInformation welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
						{
							employment:createCV rdf:type service:Service .
							employment:createCV service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP employment:EducationInformation .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
						}
				} """^^xsd:string ;
	] .
	
:ConditionalEducationInformationConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Education Information Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:EducationInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:EducationInformation welcome:DIPId ?id .						
							employment:EducationInformation welcome:hasSlot employment:obtainEducationalInformationConfirmation .	
							employment:obtainEducationalInformationConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .

:WriteOtherEducationInformationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Other Language Information DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
			bt:originBase ajan:LocalServicesKnowledge ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
				PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
				PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
				PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				CONSTRUCT  {
							employment:OtherEducationInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:OtherEducationInformation welcome:belongsTo employment:createCV .
							employment:OtherEducationInformation welcome:isCurrentDIP "true"^^xsd:boolean .
							employment:OtherEducationInformation welcome:hasDIPStatus welcome:Unknown .
							employment:OtherEducationInformation welcome:hasSlot ?input .
							?input rdf:type ?slotType .
							?input welcome:hasOntologyType ?paramTypeInput .
							?input welcome:hasTemplateId ?templateIdInput .						
							?input welcome:isOptional ?optionalInput .
							?input welcome:hasInputRDFContents welcome:Unknown .
							?input welcome:hasTCNAnswer welcome:Unknown .
							?input welcome:hasStatus welcome:Pending .
							?input welcome:dependsOn ?dependency .
							?input welcome:associatedWith ?association .
							?input welcome:hasNumberAttempts 0 .
							?input welcome:confidenceScore "0.0"^^xsd:float .					
				}
				WHERE { 
						{
							employment:createCV rdf:type service:Service .
							employment:createCV service:describedBy ?process . 
							?process process:hasInput ?input .
							?input process:parameterType ?paramTypeInput .
							?input welcome:hasDIP employment:OtherEducationInformation .
							?input welcome:hasSlotType ?slotType .
							?input welcome:isOptional ?optionalInput .							
							OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
							OPTIONAL {?input welcome:dependsOn ?val}
							OPTIONAL {?input welcome:associatedWith ?asso}
							BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
							BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
						}
				} """^^xsd:string ;
	] .
	
:ConditionalOtherEducationInformationConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Other Education Information Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:OtherEducationInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:OtherEducationInformation welcome:DIPId ?id .						
							employment:OtherEducationInformation welcome:hasSlot employment:obtainMoreEducationalInformationConfirmation .	
							employment:obtainMoreEducationalInformationConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .
		
:WriteLanguageInformationDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Language Information DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:LanguageInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:LanguageInformation welcome:belongsTo employment:createCV .
						employment:LanguageInformation welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:LanguageInformation welcome:hasDIPStatus welcome:Unknown .
						employment:LanguageInformation welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:LanguageInformation .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .
	
:ConditionalLanguageInformationConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Language Information Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:LanguageInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:LanguageInformation welcome:DIPId ?id .						
							employment:LanguageInformation welcome:hasSlot employment:obtainLanguageInformationConfirmation .	
							employment:obtainLanguageInformationConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .
		
:WriteEmploymentInformationDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Employment Information DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:EmploymentInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:EmploymentInformation welcome:belongsTo employment:createCV .
						employment:EmploymentInformation welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:EmploymentInformation welcome:hasDIPStatus welcome:Unknown .
						employment:EmploymentInformation welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:EmploymentInformation .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .
	
:ConditionalEmploymentInformationConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Employment Information Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:EmploymentInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:EmploymentInformation welcome:DIPId ?id .						
							employment:EmploymentInformation welcome:hasSlot employment:obtainEmploymentInformationConfirmation .	
							employment:obtainEmploymentInformationConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .

:UpdateCreateHeaderAppMessageSkillList
	a bt:Update ;
	rdfs:label "Update: Header Message for App - Skill list" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE{
						?headerNameSubject welcome:hasHeaderName ?headerValName . 
						?headerValSubject welcome:hasHeaderValue ?headerVal . 
					}
					INSERT {
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .					
						welcome:headerMsgType welcome:hasHeaderName "X-Msg-Type" .
						welcome:headerMsgType welcome:hasHeaderValue "CVSkills" .						
					} 
					WHERE { 
						?msg welcome:hasCorrelationID ?correlationID .
						?du rdf:type welcome:DialogueUser .
						?du welcome:hasUserId ?idObject .
						?idObject welcome:hasValue ?id .
						OPTIONAL { ?headerNameSubject welcome:hasHeaderName ?headerValName . }
						OPTIONAL { ?headerValSubject welcome:hasHeaderValue ?headerVal . }
					}
					"""^^xsd:string ;
		]) .
		
:MessageSendSkillNotificationtoApp
	a myWelcome:Message ;
	rdfs:label "Message: Send Skill List to App"^^xsd:string ;
	rdfs:comment "Message: Send Skill List to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:notificationTitle welcome:displaySkillList "true" . 
						}
						WHERE {
							welcome:KMSNotifies ?p ?o .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

:WriteSkillInformationDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Skill Information DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:SkillInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:SkillInformation welcome:belongsTo employment:createCV .
						employment:SkillInformation welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:SkillInformation welcome:hasDIPStatus welcome:Unknown .
						employment:SkillInformation welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:SkillInformation .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .
	
:ConditionalSkillInformation
	a bt:Condition ;
	rdfs:label "Condition: Skill Information Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:SkillInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:SkillInformation welcome:DIPId ?id .					
					}"""^^xsd:string ;
		]) .
		
:WriteOtherInformationDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Other Information DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:OtherInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:OtherInformation welcome:belongsTo employment:createCV .
						employment:OtherInformation welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:OtherInformation welcome:hasDIPStatus welcome:Unknown .
						employment:OtherInformation welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:OtherInformation .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .
	
:ConditionalOtherInformationConfirmationYes
	a bt:Condition ;
	rdfs:label "Condition: Other Information Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:OtherInformation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:OtherInformation welcome:DIPId ?id .						
							employment:OtherInformation welcome:hasSlot employment:obtainOtherInformationConfirmation .	
							employment:obtainOtherInformationConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .

:MessageSendCVCreatedNotificationtoApp
	a myWelcome:Message ;
	rdfs:label "Message: Send CV Created Notification to App"^^xsd:string ;
	rdfs:comment "Message: Send Send CV Created Notification to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>		
						CONSTRUCT {
							welcome:app welcome:displayCVButton "true" . 
						}
						WHERE {
							?bt welcome:hasActiveDIP ?id . 
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .
		
:WriteCreateCVDocumentDIP2Execution 
	a bt:Write ;
	rdfs:label "Write: Create CV Document DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						employment:CreateCVDocument rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						employment:CreateCVDocument welcome:belongsTo employment:createCV .
						employment:CreateCVDocument welcome:isCurrentDIP "true"^^xsd:boolean .
						employment:CreateCVDocument welcome:hasDIPStatus welcome:Unknown .
						employment:CreateCVDocument welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
					{
						employment:createCV rdf:type service:Service .
						employment:createCV service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP employment:CreateCVDocument .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
					}
			} """^^xsd:string ;
	] .

:ConditionalCreateCVDocumentYes
	a bt:Condition ;
	rdfs:label "Condition: Create CV Complete and Confirmation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							employment:CreateCVDocument rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							employment:CreateCVDocument welcome:DIPId ?id .						
							employment:CreateCVDocument welcome:hasSlot employment:obtainCVCompletionConfirmation .	
							employment:obtainCVCompletionConfirmation welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))															
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateNormalClosingS7DIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Normal Closing DIP for S7 - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:NormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:NormalClosingFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informEnd .
						welcome:NormalClosingFarewell welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:informEnd rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informEnd welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informEnd welcome:hasTemplateId "TInformEnd_S7"^^xsd:string .
						welcome:informEnd welcome:hasInputRDFContents welcome:Unknown .
						welcome:informEnd welcome:hasTCNAnswer welcome:Unknown .
						welcome:informEnd welcome:hasStatus welcome:Pending .
						welcome:informEnd welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informEnd welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informEnd welcome:isOptional "false"^^xsd:boolean .	
						welcome:informEnd welcome:dependsOn welcome:Unknown .
						welcome:informEnd welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateNormalClosingS7DIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Normal Closing DIP for S7 - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informNormalClosingFarewell .
						welcome:informNormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ConfirmationRequest"^^xsd:anyURI . 
						welcome:informNormalClosingFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:informNormalClosingFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informNormalClosingFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasStatus welcome:Pending .
						welcome:informNormalClosingFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informNormalClosingFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informNormalClosingFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informNormalClosingFarewell welcome:dependsOn welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
				]) .

#=============================================================================================
# SpecificHealthBT

:HandleEventMasterHealthBT
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Executing Health BT Master" ;
	ajan:event agents:HealthEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
								PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
								PREFIX ajan: <http://www.ajan.de/ajan-ns#>
								PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
								CONSTRUCT {
									welcome:myWelcomeAgent welcome:executeScenario "Health" .
								}
								WHERE { 
									welcome:myWelcomeAgent welcome:executeScenario "Health" .
								}"""^^xsd:string ;
	] .
	
:ConditionalMasterDIP
	a bt:Condition ;
	rdfs:label "Condition: Is the Master DIP for Health ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:ScenarioIntroduction welcome:DIPId ?id .
							
					}"""^^xsd:string ;
		]) .
		
:ConditionalExecuteMedicalEmergency
	a bt:Condition ;
	rdfs:label "Condition: Inform about Medical Emergency ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:ScenarioIntroduction welcome:DIPId ?id .						
							health:ScenarioIntroduction welcome:hasSlot health:flagMedEmergencyRequested .	
							health:flagMedEmergencyRequested welcome:hasTCNAnswer ?reifiedAnswerRequested .
							?reifiedAnswerRequested rdf:type rdf:Statement .
							?reifiedAnswerRequested rdf:subject ?reifiedSubject .
							?reifiedAnswerRequested rdf:predicate ?reifiedPredicate .
							?reifiedAnswerRequested rdf:object ?answerRequested .
							FILTER (STRENDS(str(?answerRequested), "true") || STRENDS(str(?answerRequested), "True") || STRENDS(str(?answerRequested), "Yes") || STRENDS(str(?answerRequested), "yes"))	
							health:ScenarioIntroduction welcome:hasSlot health:flagMedEmergencyInformed .	
							health:flagMedEmergencyInformed welcome:hasTCNAnswer ?reifiedAnswerInformed .
							?reifiedAnswerInformed rdf:type rdf:Statement .
							?reifiedAnswerInformed rdf:subject ?reifiedSubjectInformed .
							?reifiedAnswerInformed rdf:predicate ?reifiedPredicateInformed .
							?reifiedAnswerInformed rdf:object ?answerRequestedInformed .							
							FILTER (STRENDS(str(?answerRequestedInformed), "Not") || STRENDS(str(?answerRequestedInformed), "not") || STRENDS(str(?answerRequestedInformed), "False") || STRENDS(str(?answerRequestedInformed), "false") || STRENDS(str(?answerRequestedInformed), "No") || STRENDS(str(?answerRequestedInformed), "no"))						
					}"""^^xsd:string ;
		]) .
		
:WritePublicLegislationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Public Legislation DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:PublicLegislation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:PublicLegislation welcome:belongsTo health:healthCareInformationProvision .
						health:PublicLegislation welcome:isCurrentDIP "true"^^xsd:boolean .
						health:PublicLegislation welcome:hasDIPStatus welcome:Unknown .
						health:PublicLegislation welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:PublicLegislation .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalExecutePersonalDoctorRegistration	
	a bt:Condition ;
	rdfs:label "Condition: Inform about Personal Doctor Registration ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:ScenarioIntroduction welcome:DIPId ?id .						
							health:ScenarioIntroduction welcome:hasSlot health:flagDocRegistrationRequested .	
							health:flagDocRegistrationRequested welcome:hasTCNAnswer ?reifiedAnswerRequested .
							?reifiedAnswerRequested rdf:type rdf:Statement .
							?reifiedAnswerRequested rdf:subject ?reifiedSubject .
							?reifiedAnswerRequested rdf:predicate ?reifiedPredicate .
							?reifiedAnswerRequested rdf:object ?answerRequested .
							FILTER (STRENDS(str(?answerRequested), "true") || STRENDS(str(?answerRequested), "True") || STRENDS(str(?answerRequested), "Yes") || STRENDS(str(?answerRequested), "yes"))	
							health:ScenarioIntroduction welcome:hasSlot health:flagDocRegistrationInformed .	
							health:flagDocRegistrationInformed welcome:hasTCNAnswer ?reifiedAnswerInformed .
							?reifiedAnswerInformed rdf:type rdf:Statement .
							?reifiedAnswerInformed rdf:subject ?reifiedSubjectInformed .
							?reifiedAnswerInformed rdf:predicate ?reifiedPredicateInformed .
							?reifiedAnswerInformed rdf:object ?answerRequestedInformed .							
							FILTER (STRENDS(str(?answerRequestedInformed), "Not") || STRENDS(str(?answerRequestedInformed), "not") || STRENDS(str(?answerRequestedInformed), "False") || STRENDS(str(?answerRequestedInformed), "false") || STRENDS(str(?answerRequestedInformed), "No") || STRENDS(str(?answerRequestedInformed), "no"))						
					}"""^^xsd:string ;
		]) .
		
:WriteSSNumberDIP2Execution
	a bt:Write ;
	rdfs:label "Write: SS Number DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:SSNumber rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:SSNumber welcome:belongsTo health:healthCareInformationProvision .
						health:SSNumber welcome:isCurrentDIP "true"^^xsd:boolean .
						health:SSNumber welcome:hasDIPStatus welcome:Unknown .
						health:SSNumber welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:SSNumber .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalAllSubTopicsInformed
	a bt:Condition ;
	rdfs:label "Condition: Were all topics informed ?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:ScenarioIntroduction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:ScenarioIntroduction welcome:DIPId ?id .						
							health:ScenarioIntroduction welcome:hasSlot health:flagMedEmergencyRequested .	
							health:flagMedEmergencyRequested welcome:hasTCNAnswer ?reifiedAnswerRequested_Med .
							?reifiedAnswerRequested_Med rdf:type rdf:Statement .
							?reifiedAnswerRequested_Med rdf:subject ?reifiedSubject_Med .
							?reifiedAnswerRequested_Med rdf:predicate ?reifiedPredicate_Med .
							?reifiedAnswerRequested_Med rdf:object ?answerRequested_Med .
							FILTER (STRENDS(str(?answerRequested_Med), "true") || STRENDS(str(?answerRequested_Med), "True") || STRENDS(str(?answerRequested_Med), "Yes") || STRENDS(str(?answerRequested_Med), "yes"))	
							health:ScenarioIntroduction welcome:hasSlot health:flagMedEmergencyInformed .	
							health:flagMedEmergencyInformed welcome:hasTCNAnswer ?reifiedAnswerInformed_Med .
							?reifiedAnswerInformed_Med rdf:type rdf:Statement .
							?reifiedAnswerInformed_Med rdf:subject ?reifiedSubjectInformed_Med .
							?reifiedAnswerInformed_Med rdf:predicate ?reifiedPredicateInformed_Med .
							?reifiedAnswerInformed_Med rdf:object ?answerRequestedInformed_Med .							
							FILTER (STRENDS(str(?answerRequestedInformed_Med), "true") || STRENDS(str(?answerRequestedInformed_Med), "True") || STRENDS(str(?answerRequestedInformed_Med), "Yes") || STRENDS(str(?answerRequestedInformed_Med), "yes"))	
							
							health:ScenarioIntroduction welcome:hasSlot health:flagDocRegistrationRequested .	
							health:flagDocRegistrationRequested welcome:hasTCNAnswer ?reifiedAnswerRequested_Doctor .
							?reifiedAnswerRequested_Doctor rdf:type rdf:Statement .
							?reifiedAnswerRequested_Doctor rdf:subject ?reifiedSubject_Doctor .
							?reifiedAnswerRequested_Doctor rdf:predicate ?reifiedPredicate_Doctor .
							?reifiedAnswerRequested_Doctor rdf:object ?answerRequested_Doctor .
							FILTER (STRENDS(str(?answerRequested_Doctor), "true") || STRENDS(str(?answerRequested_Doctor), "True") || STRENDS(str(?answerRequested_Doctor), "Yes") || STRENDS(str(?answerRequested_Doctor), "yes"))	
							health:ScenarioIntroduction welcome:hasSlot health:flagDocRegistrationInformed .	
							health:flagDocRegistrationInformed welcome:hasTCNAnswer ?reifiedAnswerInformed_Doctor .
							?reifiedAnswerInformed_Doctor rdf:type rdf:Statement .
							?reifiedAnswerInformed_Doctor rdf:subject ?reifiedSubjectInformed_Doctor .
							?reifiedAnswerInformed_Doctor rdf:predicate ?reifiedPredicateInformed_Doctor .
							?reifiedAnswerInformed_Doctor rdf:object ?answerRequestedInformed_Doctor .							
							FILTER (STRENDS(str(?answerRequestedInformed_Doctor), "true") || STRENDS(str(?answerRequestedInformed_Doctor), "True") || STRENDS(str(?answerRequestedInformed_Doctor), "Yes") || STRENDS(str(?answerRequestedInformed_Doctor), "yes"))		
														
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Normal Closing DIP for S5 - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:NormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:NormalClosingFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informEnd .
						welcome:NormalClosingFarewell welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:informEnd rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informEnd welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informEnd welcome:hasTemplateId "TInformEnd_S5"^^xsd:string .
						welcome:informEnd welcome:hasInputRDFContents welcome:Unknown .
						welcome:informEnd welcome:hasTCNAnswer welcome:Unknown .
						welcome:informEnd welcome:hasStatus welcome:Pending .
						welcome:informEnd welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informEnd welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informEnd welcome:isOptional "false"^^xsd:boolean .	
						welcome:informEnd welcome:dependsOn welcome:Unknown .
						welcome:informEnd welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateNormalClosingFarewellS5DIP2Execution_Part2 
	a bt:Update ;
	rdfs:label "Update: Create Normal Closing DIP for S5 - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:NormalClosingFarewell welcome:hasSlot welcome:informNormalClosingFarewell .
						welcome:informNormalClosingFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ConfirmationRequest"^^xsd:anyURI . 
						welcome:informNormalClosingFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:informNormalClosingFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informNormalClosingFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:hasStatus welcome:Pending .
						welcome:informNormalClosingFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informNormalClosingFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informNormalClosingFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informNormalClosingFarewell welcome:dependsOn welcome:Unknown .
						welcome:informNormalClosingFarewell welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateInformContactNGOFarewell_S5DIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Farewell DIP for S5 - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ContactNGOFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ContactNGOFarewell welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informInabilityAssist .						
						welcome:informInabilityAssist rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informInabilityAssist welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informInabilityAssist welcome:hasTemplateId "TInformInabilityAssist_s5"^^xsd:string .
						welcome:informInabilityAssist welcome:hasInputRDFContents welcome:Unknown .
						welcome:informInabilityAssist welcome:hasTCNAnswer welcome:Unknown .
						welcome:informInabilityAssist welcome:hasStatus welcome:Pending .
						welcome:informInabilityAssist welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informInabilityAssist welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informInabilityAssist welcome:isOptional "false"^^xsd:boolean .
						welcome:informInabilityAssist welcome:dependsOn welcome:Unknown .
						welcome:informInabilityAssist welcome:associatedWith welcome:Unknown .	
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
	
:UpdateCreateInformContactNGOFarewell_S5DIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Inform Contact NGO Farewell DIP for S5 - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 	
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {								
						welcome:ContactNGOFarewell welcome:hasSlot welcome:informContactNGOFarewell .
						welcome:informContactNGOFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .	
						welcome:informContactNGOFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .	
						welcome:informContactNGOFarewell welcome:hasTemplateId "TInformNormalClosingFarewell"^^xsd:string .
						welcome:informContactNGOFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informContactNGOFarewell welcome:hasTCNAnswer welcome:Unknown .
						welcome:informContactNGOFarewell welcome:hasStatus welcome:Pending .
						welcome:informContactNGOFarewell welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informContactNGOFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informContactNGOFarewell welcome:isOptional "false"^^xsd:boolean .	
						welcome:informContactNGOFarewell welcome:dependsOn welcome:Unknown .
						welcome:informContactNGOFarewell welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateClosingUponFailureUnknownTopicDIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure - Unknown Topic - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ClosingUponFailureFarewell welcome:hasDIPStatus welcome:Unknown .
						welcome:ClosingUponFailureFarewell welcome:isCurrentDIP "true"^^xsd:boolean .
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informMessage .
						welcome:informMessage rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informMessage welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informMessage welcome:hasTemplateId "TInformMessage"^^xsd:string . 
						welcome:informMessage welcome:hasInputRDFContents welcome:reifiedReasonSTReasonUnknownTopic .
						welcome:informMessage welcome:dependsOn welcome:Unknown .
						welcome:informMessage welcome:associatedWith welcome:Unknown .
						welcome:informMessage welcome:hasStatus welcome:Pending .
						welcome:informMessage welcome:hasNumberAttempts 0 .
						welcome:informMessage welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informMessage welcome:isOptional "false"^^xsd:boolean .				
						welcome:reifiedReasonSTReasonUnknownTopic rdf:type rdf:Statement .
						welcome:reifiedReasonSTReasonUnknownTopic rdf:subject welcome:subTemplate .
						welcome:reifiedReasonSTReasonUnknownTopic rdf:predicate welcome:isReason .
						welcome:reifiedReasonSTReasonUnknownTopic rdf:object "STReasonNoFoundService"^^xsd:string .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateClosingUponFailureUnknownTopicDIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Closing Upon Failure - Unknown Topic - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 										
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#> 
					INSERT {
						welcome:ClosingUponFailureFarewell welcome:hasSlot welcome:informClosingFailureFarewell .
						welcome:informClosingFailureFarewell rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI .
						welcome:informClosingFailureFarewell welcome:hasTemplateId "TInformClosingFailureFarewell"^^xsd:string . 
						welcome:informClosingFailureFarewell welcome:hasInputRDFContents welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:hasStatus welcome:Pending .
						welcome:informClosingFailureFarewell welcome:hasNumberAttempts 0 .
						welcome:informClosingFailureFarewell welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informClosingFailureFarewell welcome:isOptional "false"^^xsd:boolean .
						welcome:informClosingFailureFarewell welcome:dependsOn welcome:Unknown .
						welcome:informClosingFailureFarewell welcome:associatedWith welcome:Unknown .
					} WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .
		
:EventProducerInformFirstTopic
	a bt:EventProducer ;
	rdfs:label "EventProducer: Inform first subtopic" ;
	ajan:event agents:InformSubTopicEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:ExecutionKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:subTopic welcome:informed welcome:flagMedEmergencyRequested .
						}
						WHERE {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						}"""^^xsd:string ;
	] .	
	
:UpdateDeleteTopicSelected
	a bt:Update ;
	rdfs:label "Update: Delete Flag of Selected Topic" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					DELETE  {
						welcome:subTopic welcome:informed ?topic .
					}
					WHERE { 		
							welcome:subTopic welcome:informed ?topic .
					}"""^^xsd:string ;
		]) .		

#=============================================================================================
# MedicalEmergencyHealthBT

:EventHandlerMedicalEmergency
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Executing Medical Emergency Subtopic" ;
	ajan:event agents:InformSubTopicEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
								PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
								PREFIX ajan: <http://www.ajan.de/ajan-ns#>
								PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
								CONSTRUCT {
									welcome:subTopic welcome:informed welcome:flagMedEmergencyRequested .
								}
								WHERE { 
									welcome:subTopic welcome:informed welcome:flagMedEmergencyRequested .
								}"""^^xsd:string ;
	] .
	
:ConditionalInformFAQ_NotORContactNGOSubTopic_Yes
	a bt:Condition ;
	rdfs:label "Condition: Inform FAQ Not or Contact NGO Subtopic Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							{
								?bt welcome:hasActiveDIP ?id . 
								health:InformFAQ rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:InformFAQ welcome:DIPId ?id .						
								health:InformFAQ welcome:hasSlot health:obtainInterest .	
								health:obtainInterest welcome:hasTCNAnswer ?reifiedAnswerInterest .
								?reifiedAnswerInterest rdf:type rdf:Statement .
								?reifiedAnswerInterest rdf:subject ?reifiedSubjectInt .
								?reifiedAnswerInterest rdf:predicate ?reifiedPredicateInt .
								?reifiedAnswerInterest rdf:object ?answerInt .
								FILTER (STRENDS(str(?answerInt), "Not") || STRENDS(str(?answerInt), "not") || STRENDS(str(?answerInt), "False") || STRENDS(str(?answerInt), "false") || STRENDS(str(?answerInt), "No") || STRENDS(str(?answerInt), "no"))	
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								welcome:ContactNGOSubTopic rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								welcome:ContactNGOSubTopic welcome:DIPId ?id .						
								welcome:ContactNGOSubTopic welcome:hasSlot welcome:obtainContinue .	
								welcome:obtainContinue welcome:hasTCNAnswer ?reifiedAnswerContinue .
								?reifiedAnswerContinue rdf:type rdf:Statement .
								?reifiedAnswerContinue rdf:subject ?reifiedSubjectContinue .
								?reifiedAnswerContinue rdf:predicate ?reifiedPredicateContinue .
								?reifiedAnswerContinue rdf:object ?answerCont .
								FILTER (STRENDS(str(?answerCont), "true") || STRENDS(str(?answerCont), "True") || STRENDS(str(?answerCont), "Yes") || STRENDS(str(?answerCont), "yes"))	
							}
					}"""^^xsd:string ;
		]) .
		
:MessageMedicalEmergencyInformed
	a myWelcome:Message ;
	rdfs:label "Message: Send to KMS - Medical Emergency Informed"^^xsd:string ;
	rdfs:comment "Message: Send to KMS - Medical Emergency Informed"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
		  a bt:SelectQuery;
		  a bt:QueryUri ;
		  bt:originBase ajan:AgentKnowledge ;
		  bt:sparql """
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
			SELECT ?hdrName ?fieldValue
			WHERE {
				?headerName welcome:hasHeaderName ?hdrName .
				?headerName welcome:hasHeaderValue ?fieldValue .          
			}"""^^xsd:string
		] ; 
		http-core:headers ([
			  a http-core:Header ;            
			  http-core:hdrName http-headers:accept ;
			  http-core:fieldValue "text/turtle;charset=UTF-8" 
			][
			  a http-core:Header ;
			  http-core:hdrName http-headers:content-type ;
			  http-core:fieldValue "text/plain"
			]
		) ; 		
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT  {
							welcome:agent welcome:informed welcome:flagMedEmergencyRequested .
						}
						WHERE {							
							?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
					welcome:KMS welcome:hasCoreNotification ?requestURI .
				}"""^^xsd:string
	] . 
	
:ConditionalPublicLegislation_Yes
	a bt:Condition ;
	rdfs:label "Condition: Public Legislation Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:PublicLegislation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:PublicLegislation welcome:DIPId ?id .						
							health:PublicLegislation welcome:hasSlot health:obtainLegislationConfirmation .	
							health:obtainLegislationConfirmation welcome:hasTCNAnswer ?reifiedAnswerConfirmation .
							?reifiedAnswerConfirmation rdf:type rdf:Statement .
							?reifiedAnswerConfirmation rdf:subject ?reifiedSubjectConfirmation .
							?reifiedAnswerConfirmation rdf:predicate ?reifiedPredicateConfirmation  .
							?reifiedAnswerConfirmation rdf:object ?answerConfirmation  .
							FILTER (STRENDS(str(?answerConfirmation), "true") || STRENDS(str(?answerConfirmation), "True") || STRENDS(str(?answerConfirmation), "Yes") || STRENDS(str(?answerConfirmation), "yes"))	
					}"""^^xsd:string ;
		]) .
		
:WriteInformFAQDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Inform FAQ DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:InformFAQ rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:InformFAQ welcome:belongsTo health:healthCareInformationProvision .
						health:InformFAQ welcome:isCurrentDIP "true"^^xsd:boolean .
						health:InformFAQ welcome:hasDIPStatus welcome:Unknown .
						health:InformFAQ welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:InformFAQ .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalPublicLegislation_Not
	a bt:Condition ;
	rdfs:label "Condition: Public Legislation Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:PublicLegislation rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:PublicLegislation welcome:DIPId ?id .						
							health:PublicLegislation welcome:hasSlot health:obtainLegislationConfirmation .	
							health:obtainLegislationConfirmation welcome:hasTCNAnswer ?reifiedAnswerConfirmation .
							?reifiedAnswerConfirmation rdf:type rdf:Statement .
							?reifiedAnswerConfirmation rdf:subject ?reifiedSubjectConfirmation .
							?reifiedAnswerConfirmation rdf:predicate ?reifiedPredicateConfirmation  .
							?reifiedAnswerConfirmation rdf:object ?answerConfirmation  .
							FILTER (STRENDS(str(?answerConfirmation), "Not") || STRENDS(str(?answerConfirmation), "not") || STRENDS(str(?answerConfirmation), "False") || STRENDS(str(?answerConfirmation), "false") || STRENDS(str(?answerConfirmation), "No") || STRENDS(str(?answerConfirmation), "no"))	
					}"""^^xsd:string ;
		]) .
		
:UpdateCreateContactNGOSubTopicDIP2Execution_Part1
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Subtopic - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:ContactNGOSubTopic rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:ContactNGOSubTopic welcome:hasDIPStatus welcome:Unknown .
						welcome:ContactNGOSubTopic welcome:hasSlot welcome:informInabilityAssist .
						welcome:ContactNGOSubTopic welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:informInabilityAssist rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informInabilityAssist welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informInabilityAssist welcome:hasTemplateId "TInformInabilityAssist"^^xsd:string .
						welcome:informInabilityAssist welcome:hasInputRDFContents welcome:Unknown .
						welcome:informInabilityAssist welcome:hasTCNAnswer welcome:Unknown .
						welcome:informInabilityAssist welcome:hasStatus welcome:Pending .
						welcome:informInabilityAssist welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informInabilityAssist welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informInabilityAssist welcome:isOptional "false"^^xsd:boolean .	
						welcome:informInabilityAssist welcome:dependsOn welcome:Unknown .
						welcome:informInabilityAssist welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateContactNGOSubTopicDIP2Execution_Part2
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Subtopic - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:ContactNGOSubTopic welcome:hasSlot welcome:informGenericContact .
						welcome:informGenericContact rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informGenericContact welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informGenericContact welcome:hasTemplateId "TInformGenericContact"^^xsd:string .
						welcome:informGenericContact welcome:hasInputRDFContents welcome:Unknown .
						welcome:informGenericContact welcome:hasTCNAnswer welcome:Unknown .
						welcome:informGenericContact welcome:hasStatus welcome:Pending .
						welcome:informGenericContact welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informGenericContact welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informGenericContact welcome:isOptional "false"^^xsd:boolean .	
						welcome:informGenericContact welcome:dependsOn welcome:Unknown .
						welcome:informGenericContact welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .

:UpdateCreateContactNGOSubTopicDIP2Execution_Part3
	a bt:Update ;
	rdfs:label "Update: Create Contact NGO Subtopic - Part 3" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>					
					INSERT {
						welcome:ContactNGOSubTopic welcome:hasSlot welcome:obtainContinue .
						welcome:obtainContinue rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI .
						welcome:obtainContinue welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI . 
						welcome:obtainContinue welcome:hasTemplateId "TObtainContinue"^^xsd:string .
						welcome:obtainContinue welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainContinue welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainContinue welcome:hasStatus welcome:Pending .
						welcome:obtainContinue welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainContinue welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainContinue welcome:isOptional "false"^^xsd:boolean .	
						welcome:obtainContinue welcome:dependsOn welcome:Unknown .
						welcome:obtainContinue welcome:associatedWith welcome:Unknown .
					} 
					WHERE { 
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
		]) .	
		
:ConditionalContactNGOSubTopic_Not
	a bt:Condition ;
	rdfs:label "Condition: Contact NGO SubTopic Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							welcome:ContactNGOSubTopic rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							welcome:ContactNGOSubTopic welcome:DIPId ?id .						
							welcome:ContactNGOSubTopic welcome:hasSlot welcome:obtainContinue .	
							welcome:obtainContinue welcome:hasTCNAnswer ?reifiedAnswerConfirmation .
							?reifiedAnswerConfirmation rdf:type rdf:Statement .
							?reifiedAnswerConfirmation rdf:subject ?reifiedSubjectConfirmation .
							?reifiedAnswerConfirmation rdf:predicate ?reifiedPredicateConfirmation  .
							?reifiedAnswerConfirmation rdf:object ?answerConfirmation  .
							FILTER (STRENDS(str(?answerConfirmation), "Not") || STRENDS(str(?answerConfirmation), "not") || STRENDS(str(?answerConfirmation), "False") || STRENDS(str(?answerConfirmation), "false") || STRENDS(str(?answerConfirmation), "No") || STRENDS(str(?answerConfirmation), "no"))	
					}"""^^xsd:string ;
		]) .
		
:EventProducerInformSecondTopic
	a bt:EventProducer ;
	rdfs:label "EventProducer: Inform second subtopic" ;
	ajan:event agents:InformSubTopicEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:ExecutionKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							welcome:subTopic welcome:informed welcome:flagDocRegistrationRequested .
						}
						WHERE {
							?dip rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						}"""^^xsd:string ;
	] .	

#=============================================================================================
# InformOnlineDoctorRegistrationBT

:EventHandlerOnlineDoctorRegistration
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Executing Online Registration to Doctor Subtopic" ;
	ajan:event agents:InformSubTopicEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
								PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
								PREFIX ajan: <http://www.ajan.de/ajan-ns#>
								PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
								CONSTRUCT {
									welcome:subTopic welcome:informed welcome:flagDocRegistrationRequested .
								}
								WHERE { 
									welcome:subTopic welcome:informed welcome:flagDocRegistrationRequested .
								}"""^^xsd:string ;
	] .
	
:ConditionalTaxisnetApplication_Yes
	a bt:Condition ;
	rdfs:label "Condition: Taxisnet Application Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:TaxisnetApplication rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:TaxisnetApplication welcome:DIPId ?id .						
							health:TaxisnetApplication welcome:hasSlot health:obtainContinueScenario .	
							health:obtainContinueScenario welcome:hasTCNAnswer ?reifiedAnswerConfirmation .
							?reifiedAnswerConfirmation rdf:type rdf:Statement .
							?reifiedAnswerConfirmation rdf:subject ?reifiedSubjectConfirmation .
							?reifiedAnswerConfirmation rdf:predicate ?reifiedPredicateConfirmation  .
							?reifiedAnswerConfirmation rdf:object ?answerConfirmation  .
							FILTER (STRENDS(str(?answerConfirmation), "true") || STRENDS(str(?answerConfirmation), "True") || STRENDS(str(?answerConfirmation), "Yes") || STRENDS(str(?answerConfirmation), "yes"))	
					}"""^^xsd:string ;
		]) .
		
:MessageOnlineDoctorRegistrationInformed
	a myWelcome:Message ;
	rdfs:label "Message: Send to KMS - Online Registration to Doctor Informed"^^xsd:string ;
	rdfs:comment "Message: Send to KMS - Online Registration to Doctor Informed"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
		  a bt:SelectQuery;
		  a bt:QueryUri ;
		  bt:originBase ajan:AgentKnowledge ;
		  bt:sparql """
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
			SELECT ?hdrName ?fieldValue
			WHERE {
				?headerName welcome:hasHeaderName ?hdrName .
				?headerName welcome:hasHeaderValue ?fieldValue .          
			}"""^^xsd:string
		] ; 
		http-core:headers ([
			  a http-core:Header ;            
			  http-core:hdrName http-headers:accept ;
			  http-core:fieldValue "text/turtle;charset=UTF-8" 
			][
			  a http-core:Header ;
			  http-core:hdrName http-headers:content-type ;
			  http-core:fieldValue "text/plain"
			]
		) ; 		
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT  {
							welcome:agent welcome:informed welcome:flagDocRegistrationRequested .
						}
						WHERE {							
							?dipName rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
					welcome:KMS welcome:hasCoreNotification ?requestURI .
				}"""^^xsd:string
	] . 
	
:ConditionalSSNumber_Yes
	a bt:Condition ;
	rdfs:label "Condition: SSNumber Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:SSNumber rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:SSNumber welcome:DIPId ?id .						
							health:SSNumber welcome:hasSlot health:obtainSSNumberAvailable .	
							health:obtainSSNumberAvailable welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer  .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))	
					}"""^^xsd:string ;
		]) .
		
:WriteSSRightsDIP2Execution
	a bt:Write ;
	rdfs:label "Write: SS Rights DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:SSRights rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:SSRights welcome:belongsTo health:healthCareInformationProvision .
						health:SSRights welcome:isCurrentDIP "true"^^xsd:boolean .
						health:SSRights welcome:hasDIPStatus welcome:Unknown .
						health:SSRights welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:SSRights .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalSSNumber_Otherwise
	a bt:Condition ;
	rdfs:label "Condition: SSNumber Otherwise?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:SSNumber rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:SSNumber welcome:DIPId ?id .						
							health:SSNumber welcome:hasSlot health:obtainSSNumberAvailable .	
							health:obtainSSNumberAvailable welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer  .
							FILTER (STRENDS(str(?answer), "Unclear"))	
					}"""^^xsd:string ;
		]) .
		
:WriteAssignedPAAYPADIP2Execution
	a bt:Write ;
	rdfs:label "Write: Assigned PAAYPA DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:AssignedPAAYPA rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:AssignedPAAYPA welcome:belongsTo health:healthCareInformationProvision .
						health:AssignedPAAYPA welcome:isCurrentDIP "true"^^xsd:boolean .
						health:AssignedPAAYPA welcome:hasDIPStatus welcome:Unknown .
						health:AssignedPAAYPA welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:AssignedPAAYPA .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalSSNumber_NotORAssignedPAAYPA_Yes
	a bt:Condition ;
	rdfs:label "Condition: SSNumber Not or Assigned PAAYPA Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {							
							{
								?bt welcome:hasActiveDIP ?id . 
								health:SSNumber rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:SSNumber welcome:DIPId ?id .						
								health:SSNumber welcome:hasSlot health:obtainSSNumberAvailable .	
								health:obtainSSNumberAvailable welcome:hasTCNAnswer ?reifiedAnswer .
								?reifiedAnswer rdf:type rdf:Statement .
								?reifiedAnswer rdf:subject ?reifiedSubject .
								?reifiedAnswer rdf:predicate ?reifiedPredicate .
								?reifiedAnswer rdf:object ?answer  .
								FILTER (STRENDS(str(?answer), "Not") || STRENDS(str(?answer), "not") || STRENDS(str(?answer), "False") || STRENDS(str(?answer), "false") || STRENDS(str(?answer), "No") || STRENDS(str(?answer), "no"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								health:AssignedPAAYPA rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:AssignedPAAYPA welcome:DIPId ?id .						
								health:AssignedPAAYPA welcome:hasSlot health:obtainPAAYPAConfirmation .	
								health:obtainPAAYPAConfirmation welcome:hasTCNAnswer ?reifiedAnswerConfirmation .
								?reifiedAnswerConfirmation rdf:type rdf:Statement .
								?reifiedAnswerConfirmation rdf:subject ?reifiedSubjectConf .
								?reifiedAnswerConfirmation rdf:predicate ?reifiedPredicateConf .
								?reifiedAnswerConfirmation rdf:object ?answerConf .		
								FILTER (STRENDS(str(?answerConf), "true") || STRENDS(str(?answerConf), "True") || STRENDS(str(?answerConf), "Yes") || STRENDS(str(?answerConf), "yes"))	
							}
					}"""^^xsd:string ;
		]) .
		
:WriteSSInfoinFAQDIP2Execution
	a bt:Write ;
	rdfs:label "Write: SS Info in FAQ DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:SSInfoinFAQ rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:SSInfoinFAQ welcome:belongsTo health:healthCareInformationProvision .
						health:SSInfoinFAQ welcome:isCurrentDIP "true"^^xsd:boolean .
						health:SSInfoinFAQ welcome:hasDIPStatus welcome:Unknown .
						health:SSInfoinFAQ welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:SSInfoinFAQ .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalSSRights_Yes
	a bt:Condition ;
	rdfs:label "Condition: SS Rights Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:SSRights rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:SSRights welcome:DIPId ?id .						
							health:SSRights welcome:hasSlot health:obtainInfoSufficient .	
							health:obtainInfoSufficient welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer  .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))	
					}"""^^xsd:string ;
		]) .
		
:WritePersonalDocRegistrationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Personal Doc Registration DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:PersonalDocRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:PersonalDocRegistration welcome:belongsTo health:healthCareInformationProvision .
						health:PersonalDocRegistration welcome:isCurrentDIP "true"^^xsd:boolean .
						health:PersonalDocRegistration welcome:hasDIPStatus welcome:Unknown .
						health:PersonalDocRegistration welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:PersonalDocRegistration .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalPersonalDocRegistration_Yes
	a bt:Condition ;
	rdfs:label "Condition: Personal Doc Registration Yes?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {
							?bt welcome:hasActiveDIP ?id . 
							health:PersonalDocRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
							health:PersonalDocRegistration welcome:DIPId ?id .						
							health:PersonalDocRegistration welcome:hasSlot health:obtainRegistrationInterest .	
							health:obtainRegistrationInterest welcome:hasTCNAnswer ?reifiedAnswer .
							?reifiedAnswer rdf:type rdf:Statement .
							?reifiedAnswer rdf:subject ?reifiedSubject .
							?reifiedAnswer rdf:predicate ?reifiedPredicate .
							?reifiedAnswer rdf:object ?answer  .
							FILTER (STRENDS(str(?answer), "true") || STRENDS(str(?answer), "True") || STRENDS(str(?answer), "Yes") || STRENDS(str(?answer), "yes"))	
					}"""^^xsd:string ;
		]) .
		
:WriteTaxisnetApplicationDIP2Execution
	a bt:Write ;
	rdfs:label "Write: Taxisnet Application DIP in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
			PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
			PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
			PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
			PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
			PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
			PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
			PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
			PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			CONSTRUCT  {
						health:TaxisnetApplication rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						health:TaxisnetApplication welcome:belongsTo health:healthCareInformationProvision .
						health:TaxisnetApplication welcome:isCurrentDIP "true"^^xsd:boolean .
						health:TaxisnetApplication welcome:hasDIPStatus welcome:Unknown .
						health:TaxisnetApplication welcome:hasSlot ?input .
						?input rdf:type ?slotType .
						?input welcome:hasOntologyType ?paramTypeInput .
						?input welcome:hasTemplateId ?templateIdInput .						
						?input welcome:isOptional ?optionalInput .
						?input welcome:hasInputRDFContents welcome:Unknown .
						?input welcome:hasTCNAnswer welcome:Unknown .
						?input welcome:hasStatus welcome:Pending .
						?input welcome:dependsOn ?dependency .
						?input welcome:associatedWith ?association .
						?input welcome:hasNumberAttempts 0 .
						?input welcome:confidenceScore "0.0"^^xsd:float .					
			}
			WHERE { 
						health:healthCareInformationProvision rdf:type service:Service .
						health:healthCareInformationProvision service:describedBy ?process . 
						?process process:hasInput ?input .
						?input process:parameterType ?paramTypeInput .
						?input welcome:hasDIP health:TaxisnetApplication .
						?input welcome:hasSlotType ?slotType .
						?input welcome:isOptional ?optionalInput .							
						OPTIONAL {?input welcome:hasTemplateId ?templateIdInput }
						OPTIONAL {?input welcome:dependsOn ?val}
						OPTIONAL {?input welcome:associatedWith ?asso}
						BIND(IF(EXISTS{?input welcome:dependsOn ?val}, ?val, welcome:Unknown) as ?dependency)
						BIND(IF(EXISTS{?input welcome:associatedWith ?asso}, ?asso, welcome:Unknown) as ?association).	
			} """^^xsd:string ;
	] .
	
:ConditionalSSRightsORDocRegORAssignedPAAYPAORSSFAQORTaxiApp_Not
	a bt:Condition ;
	rdfs:label "Condition: SS Rights or Doc Reg or Assigned PAAYPA or SS FAQ or Taxi Not?" ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX service: <http://www.daml.org/services/owl-s/1.1/Service.owl#>
					PREFIX process: <http://www.daml.org/services/owl-s/1.1/Process.owl#>
					PREFIX preregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/PreregistrationProcedureService.owl#>
					PREFIX simulateAppointment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/SimulateAppointmentService.owl#>
					PREFIX fullpreregistration: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/FullPreregistration.owl#>
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					PREFIX health: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/Health.owl#>
					PREFIX ssc: <http://www.ajan.de/behavior/scs-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					ASK
					WHERE {							
							{
								?bt welcome:hasActiveDIP ?id . 
								health:SSRights rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:SSRights welcome:DIPId ?id .						
								health:SSRights welcome:hasSlot health:obtainInfoSufficient .	
								health:obtainInfoSufficient welcome:hasTCNAnswer ?reifiedAnswerSSRights .
								?reifiedAnswerSSRights rdf:type rdf:Statement .
								?reifiedAnswerSSRights rdf:subject ?reifiedSubjectRights .
								?reifiedAnswerSSRights rdf:predicate ?reifiedPredicateRights .
								?reifiedAnswerSSRights rdf:object ?answerRights  .
								FILTER (STRENDS(str(?answerRights), "Not") || STRENDS(str(?answerRights), "not") || STRENDS(str(?answerRights), "False") || STRENDS(str(?answerRights), "false") || STRENDS(str(?answerRights), "No") || STRENDS(str(?answerRights), "no"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								health:PersonalDocRegistration rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:PersonalDocRegistration welcome:DIPId ?id .						
								health:PersonalDocRegistration welcome:hasSlot health:obtainRegistrationInterest .	
								health:obtainRegistrationInterest welcome:hasTCNAnswer ?reifiedAnswerInt .
								?reifiedAnswerInt rdf:type rdf:Statement .
								?reifiedAnswerInt rdf:subject ?reifiedSubjectInt .
								?reifiedAnswerInt rdf:predicate ?reifiedPredicateInt .
								?reifiedAnswerInt rdf:object ?answerInt  .
								FILTER (STRENDS(str(?answerInt), "Not") || STRENDS(str(?answerInt), "not") || STRENDS(str(?answerInt), "False") || STRENDS(str(?answerInt), "false") || STRENDS(str(?answerInt), "No") || STRENDS(str(?answerInt), "no"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								health:AssignedPAAYPA rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:AssignedPAAYPA welcome:DIPId ?id .						
								health:AssignedPAAYPA welcome:hasSlot health:obtainPAAYPAConfirmation .	
								health:obtainPAAYPAConfirmation welcome:hasTCNAnswer ?reifiedAnswerPAAYPA .
								?reifiedAnswerPAAYPA rdf:type rdf:Statement .
								?reifiedAnswerPAAYPA rdf:subject ?reifiedSubjectPAAYPA .
								?reifiedAnswerPAAYPA rdf:predicate ?reifiedPredicatePAAYPA .
								?reifiedAnswerPAAYPA rdf:object ?answerPAAYPA  .
								FILTER (STRENDS(str(?answerPAAYPA), "Not") || STRENDS(str(?answerPAAYPA), "not") || STRENDS(str(?answerPAAYPA), "False") || STRENDS(str(?answerPAAYPA), "false") || STRENDS(str(?answerPAAYPA), "No") || STRENDS(str(?answerPAAYPA), "no"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								health:SSInfoinFAQ rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:SSInfoinFAQ welcome:DIPId ?id .						
								health:SSInfoinFAQ welcome:hasSlot health:obtainChecking .	
								health:obtainChecking welcome:hasTCNAnswer ?reifiedAnswerCheck .
								?reifiedAnswerCheck rdf:type rdf:Statement .
								?reifiedAnswerCheck rdf:subject ?reifiedSubjectCheck .
								?reifiedAnswerCheck rdf:predicate ?reifiedPredicateCheck .
								?reifiedAnswerCheck rdf:object ?answerCheck  .
								FILTER (STRENDS(str(?answerCheck), "Not") || STRENDS(str(?answerCheck), "not") || STRENDS(str(?answerCheck), "False") || STRENDS(str(?answerCheck), "false") || STRENDS(str(?answerCheck), "No") || STRENDS(str(?answerCheck), "no"))
							}
							UNION
							{
								?bt welcome:hasActiveDIP ?id . 
								health:TaxisnetApplication rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
								health:TaxisnetApplication welcome:DIPId ?id .						
								health:TaxisnetApplication welcome:hasSlot health:obtainContinueScenario .	
								health:obtainContinueScenario welcome:hasTCNAnswer ?reifiedAnswerTaxi .
								?reifiedAnswerTaxi rdf:type rdf:Statement .
								?reifiedAnswerTaxi rdf:subject ?reifiedSubjectTaxi .
								?reifiedAnswerTaxi rdf:predicate ?reifiedPredicateTaxi .
								?reifiedAnswerTaxi rdf:object ?answerTaxi  .
								FILTER (STRENDS(str(?answerTaxi), "Not") || STRENDS(str(?answerTaxi), "not") || STRENDS(str(?answerTaxi), "False") || STRENDS(str(?answerTaxi), "false") || STRENDS(str(?answerTaxi), "No") || STRENDS(str(?answerTaxi), "no"))
							}
					}"""^^xsd:string ;
		]) .
		
#=============================================================================================
# FAQBTBehavior

:EventHandlerRetrievedExternalFAQs
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Receive External FAQ Notification" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#ExternalFAQEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT {
							welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
							?bnode rdf:first ?faq1 .
							?bnode rdf:rest ?restSecondEl .
							?restSecondEl rdf:first ?faq2 . 
							?restSecondEl rdf:rest ?restThirdEl . 
							?restThirdEl rdf:first ?faq3 . 
						}
						WHERE { 		
							welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
							{							
								{
      								OPTIONAL {
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
											?bnode rdf:rest ?restSecondEl .
											?restSecondEl rdf:first ?faq2 .  
											?restSecondEl rdf:rest ?restThirdEl . 
											?restThirdEl rdf:first ?faq3 . 
     							 	}
    							}
								UNION
								{
      								OPTIONAL {
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
											?bnode rdf:rest ?restSecondEl .
											?restSecondEl rdf:first ?faq2 .  
 									} 
    							}
								UNION
								{
      								OPTIONAL { 	
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
									}
								}
						}
					}
					"""^^xsd:string ;
				] .

:EventHandlerRetrievedInternalFAQs
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Receive Internal FAQ Notification" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#InternalFAQEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT {
							welcome:KMSNotifies welcome:FAQRequest "true" .
						}
						WHERE { 
							welcome:KMSNotifies welcome:FAQRequest "true" .
						} 
					"""^^xsd:string ;
				] .
				
:WriteExternalFAQNotifiationToExecution
	a bt:Write ;
	rdfs:label "Write: FAQ Notification in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					CONSTRUCT  {
						welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
						?bnode rdf:first ?faq1 .
						?restSecondEl rdf:first ?faq2 .
						?restThirdEl rdf:first ?faq3 .
					}
					WHERE { 		
							welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
							{							
								{
      								OPTIONAL {
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
											?bnode rdf:rest ?restSecondEl .
											?restSecondEl rdf:first ?faq2 .  
											?restSecondEl rdf:rest ?restThirdEl . 
											?restThirdEl rdf:first ?faq3 . 
     							 	}
    							}
								UNION
								{
      								OPTIONAL {
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
											?bnode rdf:rest ?restSecondEl .
											?restSecondEl rdf:first ?faq2 .  
 									} 
    							}
								UNION
								{
      								OPTIONAL { 	
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
									}
								}
						}
					}"""^^xsd:string ;
	] .

:WriteInternalFAQNotifiationToExecution
	a bt:Write ;
	rdfs:label "Write: Internal FAQ Notification in Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					CONSTRUCT  {
							welcome:KMSNotifies welcome:FAQRequest "true" .
					}
					WHERE {
							welcome:KMSNotifies welcome:FAQRequest "true" .
					}"""^^xsd:string ;
	] .
	
:UpdateDeleteExternalFAQNotificationAgentKnowledge
	a bt:Update ;
	rdfs:label "Update: Delete External FAQ Notification from LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					DELETE  {
						welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
						?bnode rdf:first ?faq1 .
						?bnode rdf:rest ?restSecondEl .
						?restSecondEl rdf:first ?faq2 .
						?restSecondEl rdf:rest ?restThirdEl .
						?restThirdEl rdf:first ?faq3 .
					}
					WHERE { 		
							welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
							{							
								{
      								OPTIONAL {
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
											?bnode rdf:rest ?restSecondEl .
											?restSecondEl rdf:first ?faq2 .  
											?restSecondEl rdf:rest ?restThirdEl . 
											?restThirdEl rdf:first ?faq3 . 
     							 	}
    							}
								UNION
								{
      								OPTIONAL {
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
											?bnode rdf:rest ?restSecondEl .
											?restSecondEl rdf:first ?faq2 .  
 									} 
    							}
								UNION
								{
      								OPTIONAL { 	
											welcome:KMSNotifies welcome:ExternalFaqID ?bnode .
											?bnode rdf:first ?faq1 .
									}
								}
						}
					}"""^^xsd:string ;
		]) .

:UpdateDeleteInternalFAQNotificationAgentKnowledge
	a bt:Update ;
	rdfs:label "Update: Delete Internal FAQ Notification from LAKR" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					DELETE{
						welcome:KMSNotifies welcome:FAQRequest ?val .
					}
					WHERE { 
						welcome:KMSNotifies welcome:FAQRequest ?val .
					}
					"""^^xsd:string ;
		]) .
		
:UpdateCreateFAQDIPinExecution_Part1
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 1" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					INSERT  {
						welcome:FAQ rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#DIP"^^xsd:anyURI .
						welcome:FAQ welcome:hasDIPStatus welcome:Unknown .
						welcome:FAQ welcome:hasSlot welcome:informAnswer .
						welcome:FAQ welcome:isCurrentDIP "true"^^xsd:boolean . 
						welcome:informAnswer rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI .
						welcome:informAnswer welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informAnswer welcome:hasTemplateId "TInformAnswer"^^xsd:string .
						welcome:informAnswer welcome:hasInputRDFContents welcome:Unknown .
						welcome:informAnswer welcome:hasTCNAnswer welcome:Unknown .
						welcome:informAnswer welcome:hasStatus welcome:Pending .
						welcome:informAnswer welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informAnswer welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informAnswer welcome:isOptional "false"^^xsd:boolean .	
						welcome:informAnswer welcome:dependsOn welcome:Unknown .
						welcome:informAnswer welcome:associatedWith welcome:Unknown .
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}
					"""^^xsd:string ;
		]) .	
		
:UpdateCreateFAQDIPinExecution_Part2
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 2" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {											
						welcome:FAQ welcome:hasSlot welcome:obtainSatisfaction .
						welcome:obtainSatisfaction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI . 
						welcome:obtainSatisfaction welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:obtainSatisfaction welcome:hasTemplateId "TObtainSatisfaction"^^xsd:string .
						welcome:obtainSatisfaction welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainSatisfaction welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainSatisfaction welcome:hasStatus welcome:Pending .
						welcome:obtainSatisfaction welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainSatisfaction welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainSatisfaction welcome:isOptional "false"^^xsd:boolean .
						welcome:obtainSatisfaction welcome:dependsOn welcome:Unknown .
						welcome:obtainSatisfaction welcome:associatedWith welcome:Unknown .	
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}
					"""^^xsd:string ;
		]) .	
		
:UpdateCreateFAQDIPinExecution_Part3
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 3" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {
						welcome:FAQ welcome:hasSlot welcome:informFollowUpAnswer .
						welcome:informFollowUpAnswer rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI . 
						welcome:informFollowUpAnswer welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informFollowUpAnswer welcome:hasTemplateId "TInformAnswer"^^xsd:string .
						welcome:informFollowUpAnswer welcome:hasInputRDFContents welcome:Unknown .
						welcome:informFollowUpAnswer welcome:hasTCNAnswer welcome:Unknown .
						welcome:informFollowUpAnswer welcome:hasStatus welcome:Pending .
						welcome:informFollowUpAnswer welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informFollowUpAnswer welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informFollowUpAnswer welcome:isOptional "false"^^xsd:boolean .
						welcome:informFollowUpAnswer welcome:dependsOn welcome:obtainSatisfaction .
						welcome:informFollowUpAnswer welcome:associatedWith welcome:Unknown .						
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
	]) .

:UpdateCreateFAQDIPinExecution_Part4
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 4" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {						
						welcome:FAQ welcome:hasSlot welcome:obtainFollowUpSatisfaction .
						welcome:obtainFollowUpSatisfaction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI . 
						welcome:obtainFollowUpSatisfaction welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:obtainFollowUpSatisfaction welcome:hasTemplateId "TObtainFollowUpSatisfaction"^^xsd:string .
						welcome:obtainFollowUpSatisfaction welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainFollowUpSatisfaction welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainFollowUpSatisfaction welcome:hasStatus welcome:Pending .
						welcome:obtainFollowUpSatisfaction welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainFollowUpSatisfaction welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainFollowUpSatisfaction welcome:isOptional "false"^^xsd:boolean .
						welcome:obtainFollowUpSatisfaction welcome:dependsOn welcome:Unknown .
						welcome:obtainFollowUpSatisfaction welcome:associatedWith welcome:Unknown .
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
	]) .
				
:UpdateCreateFAQDIPinExecution_Part5
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 5" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {
						welcome:FAQ welcome:hasSlot welcome:obtainFAQSatisfaction .
						welcome:obtainFAQSatisfaction rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemDemand"^^xsd:anyURI . 
						welcome:obtainFAQSatisfaction welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:obtainFAQSatisfaction welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainFAQSatisfaction welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainFAQSatisfaction welcome:hasStatus welcome:Pending .
						welcome:obtainFAQSatisfaction welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainFAQSatisfaction welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainFAQSatisfaction welcome:isOptional "false"^^xsd:boolean .
						welcome:obtainFAQSatisfaction welcome:dependsOn welcome:Unknown .
						welcome:obtainFAQSatisfaction welcome:associatedWith welcome:Unknown .						
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
	]) .

:UpdateCreateFAQDIPinExecution_Part6
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 6" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {						
						welcome:FAQ welcome:hasSlot welcome:informInabilityAssist .
						welcome:informInabilityAssist rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI . 
						welcome:informInabilityAssist welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informInabilityAssist welcome:hasTemplateId "TInformInabilityAssist"^^xsd:string .
						welcome:informInabilityAssist welcome:hasInputRDFContents welcome:Unknown .
						welcome:informInabilityAssist welcome:hasTCNAnswer welcome:Unknown .
						welcome:informInabilityAssist welcome:hasStatus welcome:Pending .
						welcome:informInabilityAssist welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informInabilityAssist welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informInabilityAssist welcome:isOptional "false"^^xsd:boolean .
						welcome:informInabilityAssist welcome:dependsOn welcome:obtainSatisfaction,  welcome:obtainFollowUpSatisfaction .
						welcome:informInabilityAssist welcome:associatedWith welcome:Unknown .
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
	]) .
				
:UpdateCreateFAQDIPinExecution_Part7
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 7" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {
						welcome:FAQ welcome:hasSlot welcome:informGenericContact .
						welcome:informGenericContact rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#SystemInfo"^^xsd:anyURI . 
						welcome:informGenericContact welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Template"^^xsd:anyURI . 
						welcome:informGenericContact welcome:hasTemplateId "TInformGenericContact"^^xsd:string .
						welcome:informGenericContact welcome:hasInputRDFContents welcome:Unknown .
						welcome:informGenericContact welcome:hasTCNAnswer welcome:Unknown .
						welcome:informGenericContact welcome:hasStatus welcome:Pending .
						welcome:informGenericContact welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:informGenericContact welcome:confidenceScore "0.0"^^xsd:float .
						welcome:informGenericContact welcome:isOptional "false"^^xsd:boolean .
						welcome:informGenericContact welcome:dependsOn welcome:Unknown .
						welcome:informGenericContact welcome:associatedWith welcome:Unknown .						
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
	]) .

:UpdateCreateFAQDIPinExecution_Part8
	a bt:Update ;
	rdfs:label "Update: FAQ DIP in Execution - Part 8" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>			
					INSERT  {						
						welcome:FAQ welcome:hasSlot welcome:obtainContinueInterest .
						welcome:obtainContinueInterest rdf:type "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#ConfirmationRequest"^^xsd:anyURI . 
						welcome:obtainContinueInterest welcome:hasOntologyType "https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#Boolean"^^xsd:anyURI .
						welcome:obtainContinueInterest welcome:hasTemplateId "TObtainContinueInterest"^^xsd:string .
						welcome:obtainContinueInterest welcome:hasInputRDFContents welcome:Unknown .
						welcome:obtainContinueInterest welcome:hasTCNAnswer welcome:Unknown .
						welcome:obtainContinueInterest welcome:hasStatus welcome:Pending .
						welcome:obtainContinueInterest welcome:hasNumberAttempts "0"^^xsd:int .
						welcome:obtainContinueInterest welcome:confidenceScore "0.0"^^xsd:float .
						welcome:obtainContinueInterest welcome:isOptional "false"^^xsd:boolean .
						welcome:obtainContinueInterest welcome:dependsOn welcome:Unknown .
						welcome:obtainContinueInterest welcome:associatedWith welcome:Unknown .
					}
					WHERE {
						?agent rdf:type ajan:Agent .
					}"""^^xsd:string ;
	]) .

:UpdateCreateHeaderAppMessageFAQSuggestion
	a bt:Update ;
	rdfs:label "Update: Header Message for App - FAQ Suggestion" ;
	bt:query ([
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX employment: <http://localhost:8060/welcome/integration/coordination/ajan/agents/welcome/services/CreateCV.owl#>
					DELETE{
						?headerNameSubject welcome:hasHeaderName ?headerValName . 
						?headerValSubject welcome:hasHeaderValue ?headerVal . 
					}
					INSERT {
						welcome:headerCorrelation welcome:hasHeaderName "X-Correlation-ID" .
						welcome:headerCorrelation welcome:hasHeaderValue ?correlationID .
						welcome:headerUserID welcome:hasHeaderName "X-User-ID" .
						welcome:headerUserID welcome:hasHeaderValue ?id .					
						welcome:headerMsgType welcome:hasHeaderName "X-Msg-Type" .
						welcome:headerMsgType welcome:hasHeaderValue "FAQSuggestion" .
					} 
					WHERE { 
						?msg welcome:hasCorrelationID ?correlationID .
						?du rdf:type welcome:DialogueUser .
						?du welcome:hasUserId ?idObject .
						?idObject welcome:hasValue ?id .
						OPTIONAL { ?headerNameSubject welcome:hasHeaderName ?headerValName . }
						OPTIONAL { ?headerValSubject welcome:hasHeaderValue ?headerVal . }
					}
					"""^^xsd:string ;
		]) .
				
:MessageSendFoundFAQtoApp
	a myWelcome:Message ;
	rdfs:label "Message: Send FAQ ID to App"^^xsd:string ;
	rdfs:comment "Message: Send FAQ ID to App"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				WHERE {
						?headerName welcome:hasHeaderName ?hdrName .
						?headerName welcome:hasHeaderValue ?fieldValue .					
				}"""^^xsd:string
		] ;	
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;			
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT  {
							welcome:notificationTitle welcome:ExternalFAQ ?bnode .
							?bnode welcome:FAQId ?faq1 .
						}
						WHERE {							
							?bnode rdf:first ?faq1 .
						}"""^^xsd:string
		  ]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .
																																		
#=============================================================================================
# ShutdownBTBehavior

:EventHandlerShutdown
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Shutdown Request" ;
	bt:event <http://localhost:8090/rdf4j/repositories/agents#AgentShutdownEvent> ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE { 
							?s ?p ?o . 			
						} 
					"""^^xsd:string ;
				] .

:WriteLAR2EKB
	a bt:Write ;
	rdfs:label "Write: LAR Content to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			CONSTRUCT  {
				?s ?p ?o .
			}
			WHERE {
				?s ?p ?o .
			} """^^xsd:string ;
	] .
	
:ConditionAgentRunningBT
	a bt:Condition ;
	rdfs:label "Condition: Agent Runs a BT? " ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					ASK
					WHERE {
						?agent welcome:hasBTRunning "true"^^xsd:boolean .
						?agent rdf:type ajan:Agent .							
					}"""^^xsd:string ;
		]) .

:ConditionAgentIn_Coordination
	a bt:Condition ;
	rdfs:label "Condition: Is Agent in Coordination ? " ;
	bt:query ([
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX welcome-ws: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					ASK
					WHERE {
						?agentUri	rdf:type	ajan:Agent, ajan:ThisAgent ;
									welcome:hasStatus welcome:in_coordination .									
					}"""^^xsd:string ;
		]) .
		
:UpdateAgentRunningYes
	a bt:Update ;
	rdfs:label "Update: Not Kill the Agent" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					DELETE {
						?agent welcome:canBeKilled ?previousVal .
					}
					INSERT {
						?agent welcome:canBeKilled "false"^^xsd:boolean .
					}
					WHERE {
						?agent rdf:type ajan:Agent .
						OPTIONAL {
							?agent welcome:canBeKilled ?previousVal .
						}
					}					
					"""^^xsd:string ;
		]) .

:UpdateAgentRunningNot
	a bt:Update ;
	rdfs:label "Update: Kill the Agent" ;
	bt:query ( [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					DELETE {
						?agent welcome:canBeKilled ?previousVal .
					}
					INSERT {
						?agent welcome:canBeKilled "true"^^xsd:boolean .
					}
					WHERE {
						?agent rdf:type ajan:Agent .
						OPTIONAL {
							?agent welcome:canBeKilled ?previousVal .
						}
					}					
					"""^^xsd:string ;
		]) .

:MessageSendShutdownNotification
	a myWelcome:Message ;
	rdfs:label "Message: Send Shutdown Notification to WPM"^^xsd:string ;
	rdfs:comment "Message: Send Shutdown Notification to WPM"^^xsd:string ;
	bt:targetBase ajan:AgentKnowledge ;  
	myWelcome:correlatorId [
		a bt:SelectQuery;
		bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?correlatorId
				WHERE {
						?msg welcome:hasCorrelationID ?correlatorId .
				}"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 
							{
								VALUES ?hdrName {"X-Turn-ID"}
								?turn welcome:hasTurnID ?fieldValue .
							}
							
							UNION
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;						
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle;charset=UTF-8"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;	
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
						CONSTRUCT {
							?agent welcome:canBeKilled ?val .
						}
						WHERE {
							?agent welcome:canBeKilled ?val .
						}"""^^xsd:string
			]
		] ;    
	] ;
	bt:queryUri [
	a bt:SelectQuery ;
	a bt:QueryUri ;
	bt:originBase ajan:AgentKnowledge ;
	bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentShutdownAcknowledgement") AS ?requestURI )
				}"""^^xsd:string
	] . 
#	bt:queryUri [
#	a bt:SelectQuery ;
#	a bt:QueryUri ;
#	bt:originBase ajan:AgentKnowledge ;  
#	bt:sparql """
#				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
#				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
#				SELECT ?requestURI 
#				WHERE
#				{
#				  welcome:dispatcher welcome:hasAddress ?partialAddress .
#				  BIND(CONCAT(STR(?partialAddress), "/dms/receiveDIP") AS ?requestURI )
#				}"""^^xsd:string
#	] .

##########################################################################################
# ----------------------------------- CHC Stuff ---------------------------------------#
##########################################################################################

:HandleCHCProtocolEvent
	a bt:HandleQueueEvent ;
	rdfs:label "CHC Protocol Event Handler" ;
	rdfs:comment "Handle CHC Protocol Event which is triggered by the MyWelcome app" ;
	bt:event agents:CHCProtocolEvent ;
	bt:validate [
			a bt:ConstructQuery ;
			bt:targetBase ajan:ExecutionKnowledge ;
			bt:sparql """
					CONSTRUCT {
						?s ?p ?o .
					}
					WHERE {
						?s ?p ?o .
					}"""^^xsd:string ;
				] .
				
:WriteThisAgentIdToEKB
	a bt:Write ;
	rdfs:label "Write: ID of agent to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			CONSTRUCT  {
				?agentUri	rdf:type	ajan:Agent, ajan:ThisAgent ;
							ajan:agentId	?agentName .
			}
			WHERE {
				?agentUri	rdf:type	ajan:Agent ;
							ajan:agentId	?agentName .
			} """^^xsd:string ;
	] .
	
:ConditionAgentRunningCHCProcess
	a bt:Condition ;
	rdfs:label "Is Agent Running a CHC Process as Dedicated Agent?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE {
						?agentUri	rdf:type	ajan:Agent ;
									welcome:isRunningChc	?runningChc .
						FILTER(LCASE(?runningChc) = "true")

						}"""^^xsd:string ;
		] .

:MessageAlreadyRunningCHCProcess
	a myWelcome:Message ;
	rdfs:label "Message: Send Already running a CHC Process to TCN"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
							UNION 
							{
								VALUES ?hdrName {"X-Msg-Type"}
								VALUES ?fieldValue {"CHC-Status"} 
							}		
				}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json; charset=UTF-8"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "APP"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:AgentKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent welcome:informTCN "Already running CHC. Cannot start a new one now."^^xsd:string.
						}
						WHERE {
							?agent rdf:type ajan:Agent .
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
				SELECT ?requestURI 
				WHERE
				{
				  welcome:dispatcher welcome:hasAddress ?partialAddress .
				  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
				}"""^^xsd:string
	] .
	
:EventProducerExecuteCHCProcessEvent
	a bt:EventProducer ;
	rdfs:label "EventProducer: Execute CHC Process" ;
	ajan:event agents:ExecuteCHCProcessEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:ExecutionKnowledge;
					bt:sparql """

						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .

#-----------------ExecutingPreCHCProcessBT Nodes-----------------------------
:HandleExecuteCHCProcessEvent
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Execute CHC Process BT" ;
	bt:event agents:ExecuteCHCProcessEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .
				
:CHCStartFlagOn
	a bt:Update ;
	rdfs:label "Agent Running CHC Flag-On" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

					INSERT {
						?agent	welcome:isRunningChc	"true" .

					}
					WHERE {
						?agent	rdf:type ajan:Agent .

					}
					"""^^xsd:string ;
		] .
		
:Message2AppStartingCHC
	a myWelcome:Message ;
	rdfs:label "Message: Inform TCN that agent is starting CHC"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
   ] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
							UNION 
							{
								VALUES ?hdrName {"X-Msg-Type"}
								VALUES ?fieldValue {"CHC-Status"}
							}	
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "APP"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent welcome:startedCHC "true" .							
						}
						WHERE {
							?agent	rdf:type ajan:Agent, ajan:ThisAgent ;
									ajan:agentId	?agentName .
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					SELECT ?requestURI 
					WHERE
					{
					  welcome:dispatcher welcome:hasAddress ?partialAddress .
					  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
					}"""^^xsd:string
		] .
		
:Message2WPMUpdateStatus2InCoordination
	a myWelcome:Message ;
	rdfs:label "Message: Update Agent status to In_Coordination in WAR"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "WPM"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX welcome-sw: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						CONSTRUCT {
							?agent	welcome:hasStatus welcome-sw:in_coordination ;
									ajan:agentId	?agentName .
						}
						WHERE {
							?agent	rdf:type ajan:Agent, ajan:ThisAgent ;
									ajan:agentId ?agentName .		
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

					SELECT ?requestURI
					WHERE {
						welcome:dispatcher welcome:hasAddress ?partialAddress .
						BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentStatus") AS ?requestURI )
					}"""^^xsd:string
	] .
	
:Message2KMSLocationPreference
	a myWelcome:Message ;
	rdfs:label "Message: Send Location Preferences to KMS"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "KMS"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

						CONSTRUCT {
							welcome:dedicatedAgent welcome:inform welcome:location .
						}
						WHERE {
							?agent	rdf:type ajan:Agent .
					
						#	welcome:DialogueUser							
						#		welcome:hasChcLocationPreference	?bNLocPref .
						#	
						#	?bNLocPref rdf:rest*/rdf:first* ?locPref .
						#	FILTER NOT EXISTS {?locPref ?y ?z }
						#	FILTER(?locPref != rdf:nil)						
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					
					SELECT ?requestURI 
					WHERE
					{
						welcome:KMS welcome:hasCHCURI ?requestURI .
					}"""^^xsd:string
	] .
	
:EventProducerCHCFailureEvent
	a bt:EventProducer ;
	rdfs:label "EventProducer: CHC Failed Event" ;
	ajan:event agents:CHCFailureEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:ExecutionKnowledge;
					bt:sparql """

						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .
				
#-----------------ExecutingMainCHCProcessBT Nodes-----------------------------
				
:EventHandlerLARPopulated4CHC
	a bt:HandleEvent ;
	rdfs:label "EventHandler: LAR Populated for CHC" ;
	bt:event agents:PopularLAR4CHCEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .

:WriteRelevantAgentsInLAR
	a bt:Write ;
	rdfs:label "Write: Relevant Agents for CHC in LAR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				CONSTRUCT	{
					?agent rdf:type ajan:Agent ;
						ajan:agentName ?agId ;
						welcome:hasAddress ?agAddress ;
						welcome:hasStatus ?agStatus .
				}
				WHERE	{
					?agent rdf:type ajan:Agent ;
						ajan:agentName ?agId ;
						welcome:hasAddress ?agAddress ;
						welcome:hasStatus ?agStatus .
				}"""^^xsd:string ;
	] .
	
:WriteChcProblemInstance2Execution
	a bt:Write ;
	rdfs:label "Write: CHC Problem Instance to Execution Knowledge" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				PREFIX welcome-sw: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				CONSTRUCT	{
						#?agent	rdf:type	ajan:Agent .

						?bnode	rdf:type	mac:MACProblemInstance, welcome:CHCUseCase;
									welcome:hasStatus	"running"^^xsd:string;
									mac:hasId		?uniqueChcId;
									mac:hasUseCase	"CHC"^^xsd:string;
									mac:hasSolver	"HDBSCAN"^^xsd:string;
									mac:hasNumberOfAgents	?numOfAgents;
									mac:hasParticipants		?name;
									welcome:hasAgeWeight		"10"^^xsd:int;
									welcome:hasGenderWeight		"9"^^xsd:int;
									welcome:hasFamilyWeight		"5"^^xsd:int;
									welcome:hasNationalityWeight	"8"^^xsd:int;
									welcome:hasReligionWeight		"6"^^xsd:int;
									welcome:hasEthnicityWeight		"7"^^xsd:int;
									welcome:hasLocationWeight		"2"^^xsd:int;
									welcome:hasAccessibilityWeight	"3"^^xsd:int;
									welcome:hasRentPeriodWeight		"1"^^xsd:int;
									welcome:hasShareWithWeight		"4"^^xsd:int.
						#?agent ajan:agentId ?name.

							}
				WHERE	{
					BIND(SHA1(xsd:string(NOW())) AS ?uniqueChcId)

					{
						SELECT ?agent ?name
						WHERE	{
							?agent	rdf:type	ajan:Agent ;
									welcome:hasStatus	?status ;
									ajan:agentName	?name.
							FILTER(?status=welcome-sw:active || ?status=welcome-sw:in_coordination)
							
						}
					}
					{
						SELECT (count(?agent) as ?numOfAgents)
						WHERE	{
							?agent rdf:type ajan:Agent .
							?agent welcome:hasStatus ?status.
							FILTER(?status=welcome-sw:active || ?status=welcome-sw:in_coordination)
								}
					}
					{
						BIND(BNODE() AS ?bnode)
					}
				}"""^^xsd:string ;
	] .
	
:WriteChcPiAndChcRunningFlag2Lakr
	a bt:Write ;
	rdfs:label "Write: CHC Problem Instance and Running CHC Flag to Agent Knowledge" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				CONSTRUCT	{
						?agent	welcome:isRunningCHC ?chcId .

						?bnode	rdf:type	mac:MACProblemInstance, welcome:CHCUseCase;
									welcome:hasStartTime	?now ;
									welcome:hasStatus	"running"^^xsd:string;
									mac:hasId		?chcId;
									mac:hasUseCase	?useCaseName ;
									mac:hasSolver	?solver;
									mac:hasNumberOfAgents	?numOfAgents;
									mac:hasParticipants		?name;
									welcome:hasAgeWeight		"10"^^xsd:int;
									welcome:hasGenderWeight		"9"^^xsd:int;
									welcome:hasFamilyWeight		"5"^^xsd:int;
									welcome:hasNationalityWeight	"8"^^xsd:int;
									welcome:hasReligionWeight		"6"^^xsd:int;
									welcome:hasEthnicityWeight		"7"^^xsd:int;
									welcome:hasLocationWeight		"2"^^xsd:int;
									welcome:hasAccessibilityWeight	"3"^^xsd:int;
									welcome:hasRentPeriodWeight		"1"^^xsd:int;
									welcome:hasShareWithWeight		"4"^^xsd:int.
				}
				WHERE	{
						?agent	rdf:type ajan:Agent .

						?bnode	rdf:type	mac:MACProblemInstance, welcome:CHCUseCase;
									welcome:hasStatus	"running"^^xsd:string;
									mac:hasId		?chcId;
									mac:hasSolver	?solver;
									mac:hasUseCase	?useCaseName ;
									mac:hasNumberOfAgents	?numOfAgents;
									mac:hasParticipants		?name;
									welcome:hasAgeWeight		"10"^^xsd:int;
									welcome:hasGenderWeight		"9"^^xsd:int;
									welcome:hasFamilyWeight		"5"^^xsd:int;
									welcome:hasNationalityWeight	"8"^^xsd:int;
									welcome:hasReligionWeight		"6"^^xsd:int;
									welcome:hasEthnicityWeight		"7"^^xsd:int;
									welcome:hasLocationWeight		"2"^^xsd:int;
									welcome:hasAccessibilityWeight	"3"^^xsd:int;
									welcome:hasRentPeriodWeight		"1"^^xsd:int;
									welcome:hasShareWithWeight		"4"^^xsd:int.

						BIND(NOW() AS ?now)
				}"""^^xsd:string ;
	] .

:UpdateExtractChcPersonalInfo
	a bt:Update ;
	rdfs:label "Update: Create CHC Personal Info in LAKR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

					INSERT {
						?agent welcome:hasCHCPersonalInfo ?bnode2 .

						?bnode2	rdf:type	welcome:CHCPersonalInfo;
								mac:hasId	?chcId ;
								welcome:hasAge	?age;
								welcome:hasGender	?gender;
								welcome:hasFamily	?family;
								welcome:hasNationality	?nationality;
								welcome:hasReligion		?religion;
								welcome:hasEthnicity 	?ethnicity;
								welcome:hasEmailValue ?email ;
								welcome:speaksLanguage	?lang ;
								welcome:hasChcLocationPreference	?locPref;
								welcome:hasChcAccessibilityPreference	?accessPref;
								welcome:hasChcRentPeriodPreference		?bNRentPref;
								welcome:hasChcShareWithPreference		?bNSharePref.

						?bNRentPref	?rentPred	?rentObj.
						?bNSharePref		?sharePred	?shareObj.
					}
					WHERE {
						?agent	rdf:type ajan:Agent .

						?agent	welcome:isRunningCHC ?chcId .

						welcome:tcn_user
							welcome:hasAge	?bNAge;
							welcome:hasGender	?bNGender;
							welcome:hasFamily	?bNFamily;
							welcome:hasNationality	?bNNationality;
							welcome:hasReligion		?bNReligion;
							welcome:hasEthnicity 	?bNEthnicity;
							welcome:hasEmail ?objEmail ;
							welcome:speaksLanguage	?bNLang ;
							welcome:hasChcLocationPreference	?bNLocPref;
							welcome:hasChcAccessibilityPreference	?bNAccessPref;
							welcome:hasChcRentPeriodPreference		?bNRentPref;
							welcome:hasChcShareWithPreference		?bNSharePref.
						
						?bNAge welcome:hasValue ?age .
						?bNGender welcome:hasValue ?gender .
						?bNFamily welcome:hasValue ?family .
						?bNNationality welcome:hasValue ?nationality .
						?bNReligion welcome:hasValue ?religion .
						?bNEthnicity welcome:hasValue ?ethnicity .
						?objEmail welcome:hasValue ?email .
						?bNLang rdf:rest*/rdf:first* ?lang .
						FILTER NOT EXISTS {?lang ?w ?u }
						FILTER(?lang != rdf:nil)
						?bNLocPref rdf:rest*/rdf:first* ?locPref .
						FILTER NOT EXISTS {?locPref ?y ?z }
						FILTER(?locPref != rdf:nil)
						?bNAccessPref welcome:hasValue ?accessPref .
						OPTIONAL{
							?bNRentPref	?rentPred	?rentObj.
						}
						OPTIONAL{
							?bNSharePref	?sharePred		?shareObj.
						}
						{BIND(BNODE() AS ?bnode2)}
					}
					"""^^xsd:string ;
		] .
		
:WritePersonalInfoRequestContent2Execution
	a bt:Write ;
	rdfs:label "Write: Personal Info Request Content to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
						}
						WHERE {

							?agent	rdf:type	ajan:Agent ;
									ajan:agentId	?agentId ;
									welcome:isRunningCHC	?chcId .
							?du		welcome:hasRootAddress	?rootAddress .
							BIND(CONCAT(?rootAddress, ?agentId) AS ?agentAddress)
						}"""^^xsd:string ;
	] .

:WriteDedicatedAndParticipantAgentinLAR
	a bt:Write ;
	rdfs:label "Write: Dedicated and Participant Agent in LAR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
							?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
						}
						WHERE {
								?agent	rdf:type	ajan:Agent ;
										welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
								?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
						}"""^^xsd:string ;
	] .

:ConditionMoreThanOneAgent
	a bt:Condition ;
	rdfs:label "Is there more than one agent other than the dedicated agent?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE 
					{	
							SELECT DISTINCT ?requestURI (COUNT(?requestURI) AS ?counterURI)
							WHERE {
									?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
										
									?bnode	mac:hasId	?chcId ;
													mac:hasParticipants	?pAgentName .
											
									?pagentURI rdf:type ajan:Agent ;
											ajan:agentName ?pAgentName ;
											welcome:hasAddress ?agentAddress .
											
									FILTER(?pAgentName != ?agentId)
									BIND(CONCAT(?agentAddress, "?capability=shareCHCPersonalInfo") AS ?requestURI )								
							  } GROUP BY ?requestURI 
					}"""^^xsd:string
		] .
		
:Broadcast4PersonalInfo
	a bt:Broadcast ;
	rdfs:label "Broadcast: Request agents to return Personal Info for CHC"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("text/turtle" "text/turtle")
					   }
				}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ; 
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
						}
						WHERE {
							?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					SELECT DISTINCT ?requestURI
					WHERE {
						?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
										
						?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
								
						?pagentURI rdf:type ajan:Agent ;
								ajan:agentName ?pAgentName ;
								welcome:hasAddress ?agentAddress .
								
						FILTER(?pAgentName != ?agentId)
						BIND(CONCAT(?agentAddress, "?capability=shareCHCPersonalInfo") AS ?requestURI )
						#BIND(CONCAT("http://192.168.32.8:8060/welcome/integration/coordination/ajan/agents/", ?pAgentName, "?capability=shareCHCPersonalInfo") AS ?requestURI )
					}"""^^xsd:string
	] .

:DeleteDedicatedAndParticipantAgentfromLAR
	a bt:Update ;
	rdfs:label "Update: Delete Dedicated and Participant Agent from LAR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
							?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
							?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
					}
					WHERE {
							?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
							?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
						}

					"""^^xsd:string ;
		] .
		
:InsertCHCWasBroadcasted2Execution
	a bt:Update ;
	rdfs:label "Update: Insert CHC Process info was broadcasted succesfully" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					INSERT{
							?broadcastedBnode	rdf:type	welcome:TemporaryBnode ;
												welcome:hasCHCBroadcasted	"true"^^xsd:boolean ;
												mac:hasId	?chcId .
					}
					WHERE {
							?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId .

							BIND(BNODE() AS ?broadcastedBnode)
						}

					"""^^xsd:string ;
		] .
		
:UpdateSetTimer
	a bt:Update ;
	rdfs:label "Update: Set Timer according to Nb Participants" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					?bnode welcome:hasWaitingTime ?waitTime . 
				}
				INSERT{
					?bnode welcome:hasWaitingTime 20000 . #Same as the waiting value in the Wait node
				}
				WHERE {
					?dAgent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId .
					
					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents  .
					OPTIONAL {?bnode welcome:hasWaitingTime ?waitTime . }
				}"""^^xsd:string ;
		] .
		
:Wait4ChcPersonalInfo
	a bt:Wait ;
	rdfs:label "Wait: wait for agents to return their Personal Info for CHC" ;
	rdfs:comment "" ;
	bt:milliseconds "20000"^^xsd:int .

:UpdateTimer
	a bt:Update ;
	rdfs:label "Update: Set New Timer" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					?bnode welcome:hasWaitingTime ?waitTime . 
				}
				INSERT{
					?bnode welcome:hasWaitingTime ?newTimer .
				}
				WHERE {
					?dAgent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId .
					
					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents .
					?bnode welcome:hasWaitingTime ?waitTime . 
					BIND((?waitTime + 20000) AS ?newTimer )
				}"""^^xsd:string ;
		] .

:ConditionAnyoneNotReturnedPersonalInfo
	a bt:Condition ;
	rdfs:label "Condition: Has any participant agent NOT returned its CHC Personal Info?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

				ASK
				WHERE 
				{	
					SELECT ?numOfAgents (COUNT(?pAgentUri) AS ?counterPI)
					  WHERE {
						  ?dAgent	rdf:type	ajan:Agent ;
									welcome:isRunningCHC ?chcId ;
									ajan:agentId	?dAgentId.
							?bnode	rdf:type	welcome:CHCUseCase;
									mac:hasId		?chcId;
									mac:hasNumberOfAgents	?numOfAgents;
									mac:hasParticipants		?pAgentId .
										
						  OPTIONAL{
								?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
									  ajan:agentId	?pAgentId .
								?bnode2 rdf:type welcome:CHCPersonalInfo ;
									  mac:hasId ?chcId .
						}
						FILTER(!bound(?bnode2) || (?counterPI != ?numOfAgents))
					  } GROUP BY ?numOfAgents
				}"""^^xsd:string ;
		] .
		
:ConditionMaxWaitingTimeReached
	a bt:Condition ;
	rdfs:label "Condition: Was the Max Time Reached?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			ASK
			{
				?dAgent	rdf:type	ajan:Agent ;
					welcome:isRunningCHC ?chcId .
				?bnode	rdf:type	welcome:CHCUseCase;
					mac:hasId		?chcId;
					mac:hasNumberOfAgents	?numOfAgents ;
					welcome:hasWaitingTime ?waitTime .
				FILTER(?waitTime >= (30000/5)* ?numOfAgents)
			}"""^^xsd:string ;
		] .
		
:RemoveNotRespondingAgentsFromCHCProblemInstance
	a bt:Update ;
	rdfs:label "Update: Remove non-responding agents from CHC Process" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					?bnode	mac:hasParticipants	?pAgentId .
					?bnode	mac:hasNumberOfAgents	?numOfAgents.
				}
				INSERT{
					?bnode	mac:hasNumberOfAgents ?counterPI.
					welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
				}
				WHERE {					
					  SELECT ?numOfAgents ?pAgentId ?agentAddress (COUNT(?bnodeCounter) AS ?counterPI)
					  WHERE {
						  ?dAgent	rdf:type	ajan:Agent ;
									welcome:isRunningCHC ?chcId ;
									ajan:agentId	?dAgentId.
							?bnode	rdf:type	welcome:CHCUseCase;
									mac:hasId		?chcId;
									mac:hasNumberOfAgents	?numOfAgents;
									mac:hasParticipants		?pAgentId .
									
							FILTER NOT EXISTS {
											?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
														ajan:agentId	?pAgentId .	
											?bnode2 rdf:type welcome:CHCPersonalInfo ;
														mac:hasId ?chcId .		
						    }							
						   ?bnodeCounter rdf:type welcome:CHCPersonalInfo ;
														mac:hasId ?chcId .	
					  } GROUP BY ?numOfAgents ?pAgentId ?agentAddress
				}"""^^xsd:string ;
		] .

:ConditionAtLeastOneParticipant
	a bt:Condition ;
	rdfs:label "Condition: Is there at least one participant?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

				ASK
				WHERE 
				{	
					 ?dAgent rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId ;
							ajan:agentId	?dAgentId.
					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents;
							mac:hasParticipants	?pAgentId .							
					FILTER(?numOfAgents > 1)
				}"""^^xsd:string ;
		] .

:WriteNotRespodingAgentsinLAR
	a bt:Write ;
	rdfs:label "Write: Not Responding Agent List in LAR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
						}
						WHERE {
							welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
						}"""^^xsd:string ;
	] .
	
:BroadcastFail4NotResponding
	a bt:Broadcast ;
	rdfs:label "Broadcast: Inform Failed for Not Responding Agents"^^xsd:string ;
	rdfs:comment "Failed only for Not Responding Agents"^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("text/turtle" "text/turtle")
					   }
				}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
							
							?dAgent	rdf:type	ajan:Agent ;
									ajan:agentId ?dAgentId .
							
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .							
						}
						WHERE {
							welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
							
							?dAgent	rdf:type	ajan:Agent ;
									ajan:agentId ?dAgentId .

							#TODO: Check Optional
							OPTIONAL {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
							}
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					SELECT DISTINCT ?requestURI
					WHERE {
						welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
						?nrAgent rdf:type ajan:Agent ;
								 welcome:hasAddress ?nrAddress ;
								 ajan:agentName ?pAgentId .						
						#BIND(CONCAT("http://localhost:8060/welcome/integration/coordination/ajan/agents/", ?pAgentId, "?capability=finalizeCHCProcess") AS ?requestURI )
						 BIND(CONCAT(?nrAddress, "?capability=finalizeCHCProcess") AS ?requestURI )
					}"""^^xsd:string
	] .
	
:DeleteListNotRespondingAgents2LAKR
	a bt:Update ;
	rdfs:label "Update: Delete List of Not Responding Agents from LAKR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
				}
				WHERE {
					welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
				}"""^^xsd:string ;
		] .

:DeleteListNotRespondingAgents2LAR
	a bt:Update ;
	rdfs:label "Update: Delete List of Not Responding Agents from LAR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
				}
				WHERE {
					welcome:CHC welcome:hasNotRespondingAgent ?pAgentId .
				}"""^^xsd:string ;
		] .
		
:WriteSimilaritiesRequestContent2Execution
	a bt:Write ;
	rdfs:label "Write: Similarities Request Content to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}
						WHERE {

							?dAgent	rdf:type	ajan:Agent ;
									welcome:isRunningCHC ?chcId ;
									ajan:agentId	?dAgentId.

							?du		welcome:hasRootAddress	?rootAddress .
							BIND(CONCAT(?rootAddress, ?dAgentId) AS ?agentAddress)

							?bnode	rdf:type	welcome:CHCUseCase;
									mac:hasId		?chcId;
									mac:hasParticipants		?pAgentId .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.
							OPTIONAL{
								?rentPref	?rentPred	?rentObj.
									}
							OPTIONAL{
								?sharePref	?sharePred		?shareObj.
									}
						}"""^^xsd:string ;
	] .
	
:Broadcast4SimilarityValues
	a bt:Broadcast ;
	rdfs:label "Broadcast: Request agents to return their Similarity values for CHC"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("text/turtle" "text/turtle")
					   }
				}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}
						WHERE {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.
							OPTIONAL{
								?rentPref	?rentPred	?rentObj.
									}
							OPTIONAL{
								?sharePref	?sharePred		?shareObj.
									}
										}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					SELECT DISTINCT ?requestURI
					WHERE {
						?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
										
						?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
								
						?pagentURI rdf:type ajan:Agent ;
								ajan:agentName ?pAgentName ;
								welcome:hasAddress ?agentAddress .
								
						FILTER(?pAgentName != ?agentId)
						BIND(CONCAT(?agentAddress, "?capability=shareCHCSimilarities") AS ?requestURI )
						#BIND(CONCAT(?agentAddress, "?capability=shareCHCSimilarities") AS ?requestURI )
					}"""^^xsd:string
	] .

:WriteParticipantAgentEmail2LAKR
	a bt:Write ;
	rdfs:label "Write: Email of the Participant Agent to LAKR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				CONSTRUCT  {
						?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode ;
								ajan:agentId	?pAgentId .
					    ?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
								mac:hasId	?chcId ;												
								welcome:hasEmailValue ?email .
				}
				WHERE {
					?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode ;
								ajan:agentId	?pAgentId .
					?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
								mac:hasId	?chcId ;												
								welcome:hasEmailValue ?email .
				} """^^xsd:string ;
	] .
	
:WriteCHCPreferences2Execution
	a bt:Write ;
	rdfs:label "Write: CHC Individual Preferences to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				CONSTRUCT  {
						?agent	rdf:type ajan:Agent ;
								ajan:agentId	?subAgentId ;
								welcome:hasCHCPreferencesInfo	?bnode .

						?bnode	rdf:type	welcome:CHCPreferencesInfo ;
								welcome:hasChcAgePreference ?element ;
								welcome:hasChcAgePreference ?agePrefVal ;
								welcome:hasChcGenderPreference ?genPref ;
								welcome:hasChcFamilyPreference ?famPref ;
								welcome:hasChcFamilyPreference ?famElement ;
								welcome:hasChcNationPreference ?natPref ;
								welcome:hasChcReligionPreference ?relPref ;
								welcome:hasChcEthnicPreference ?ethPref .

						?element welcome:lowerBound	?lowerAge;
									welcome:higherBound ?higherAge.
				}
				WHERE {
					?agent	rdf:type ajan:Agent ;
							ajan:agentId	?subAgentId .
					?du		#rdf:type	welcome:DialogueUser ;
							welcome:hasChcAgePreference ?bNAgePrefSubject ;
							welcome:hasChcGenderPreference ?bNGenPref ;
							welcome:hasChcFamilyPreference ?bNFamPref ;
							welcome:hasChcNationPreference ?bNNatPref ;
							welcome:hasChcReligionPreference ?bNRelPref ;
							welcome:hasChcEthnicPreference ?bNEthPref .							
					OPTIONAL {
						?bNAgePrefSubject rdf:rest*/rdf:first* ?element .
 						?element welcome:lowerBound	?lowerAge;
									welcome:higherBound ?higherAge.
					}
					OPTIONAL {
						?bNAgePrefSubject welcome:hasValue ?agePrefVal .
					}										
					?bNGenPref welcome:hasValue ?genPref .					
					OPTIONAL {
						?bNFamPref welcome:hasValue ?famPref .
					}					
					OPTIONAL {
						?bNFamPref rdf:rest*/rdf:first* ?famElement .
						FILTER NOT EXISTS {?famElement ?w ?u }
						FILTER(?famElement != rdf:nil) 						
					}					
					?bNNatPref welcome:hasValue ?natPref .
					?bNRelPref welcome:hasValue ?relPref .
					?bNEthPref welcome:hasValue ?ethPref .
					{BIND(BNODE() AS ?bnode)}

				} """^^xsd:string ;
	] .

:ComputeSimilarities4CHC
	a bt:Write ;
	rdfs:label "Write: Computed Similarity Values of CHC to LAKR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;		
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT  {
							?subAgent	welcome:hasCHCSimilarityValue	?smlBnode .
							?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
										mac:hasSubjectAgent ?subAgentId ;
										mac:hasObjectAgent ?pAgentId ;
										mac:isComputedForProblemId  ?chcId ;
										mac:hasSimilarityScore ?maxTotalSml .
						}
                        WHERE {
						{
						SELECT ?subAgent ?subAgentId ?pAgentId ?chcId (MAX(?totalSml) AS ?maxTotalSml)
						WHERE {
						{
						SELECT ?subAgent ?subAgentId ?pAgentId ?chcId  ?totalSml
						WHERE {

						# to retrieve Preferences of the subject agent from Execution.
						?subAgent	rdf:type ajan:Agent ;
								ajan:agentId	?subAgentId ;
								welcome:hasCHCPreferencesInfo	?prefBNode .

						?prefBNode	rdf:type	welcome:CHCPreferencesInfo ;
									welcome:hasChcAgePreference ?subAgePref ;
									welcome:hasChcGenderPreference ?subGenPref ;
									welcome:hasChcFamilyPreference ?subFamPref ;
									welcome:hasChcNationPreference ?subNatPref ;
									welcome:hasChcReligionPreference ?subRelPref ;
									welcome:hasChcEthnicPreference ?subEthPref .
						OPTIONAL {
								?subAgePref	welcome:lowerBound	?subLowerAge;
											welcome:higherBound ?subHigherAge.
								}


						# to retrieve participant agent id
						?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode ;
									ajan:agentId	?pAgentId .


						# to rule out agent computing similarity with itself
						FILTER(?subAgentId != ?pAgentId)


						# to retrieve Personal Info of the subject agent
						?subAgentUri	welcome:hasCHCPersonalInfo	?subPersonalInfoBNode ;
										ajan:agentId	?subAgentId .
						?subPersonalInfoBNode	rdf:type	welcome:CHCPersonalInfo ;
												mac:hasId	?chcId ;
												welcome:hasAge	?subAge;
												welcome:hasGender	?subGender;
												welcome:hasFamily	?subFamily;
												welcome:hasNationality	?subNationality;
												welcome:hasReligion		?subReligion;
												welcome:hasEthnicity 	?subEthnicity;
												welcome:hasChcLocationPreference	?subLocPref;
												welcome:hasChcAccessibilityPreference	?subAccessPref;
												welcome:hasChcRentPeriodPreference		?subRentPref;
												welcome:hasChcShareWithPreference		?subSharePref.

						OPTIONAL {
							?subRentPref	welcome:startDate ?subStartRent ;
											welcome:endDate ?subEndRent .
						}
						OPTIONAL {
							?subSharePref	welcome:min ?subMinShare ;
											welcome:max ?subMaxShare .
								}

						# to retrieve Personal Info of the participant (object) agent
						?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
												mac:hasId	?chcId ;
												welcome:hasAge	?objAge;
												welcome:hasGender	?objGender;
												welcome:hasFamily	?objFamily;
												welcome:hasNationality	?objNationality;
												welcome:hasReligion		?objReligion;
												welcome:hasEthnicity 	?objEthnicity;
												welcome:hasChcLocationPreference	?objLocPref;
												welcome:hasChcAccessibilityPreference	?objAccessPref;
												welcome:hasChcRentPeriodPreference		?objRentPref;
												welcome:hasChcShareWithPreference		?objSharePref.

						OPTIONAL {
							?objRentPref	welcome:startDate ?objStartRent ;
											welcome:endDate ?objEndRent .
								}
						OPTIONAL {
							?objSharePref	welcome:min ?objMinShare ;
											welcome:max ?objMaxShare .
								}


						# to assign/retrieve preference weight values
						VALUES ?ageWeight {"10"^^xsd:int}
						VALUES ?genWeight {"9"^^xsd:int}
						VALUES ?famWeight {"5"^^xsd:int}
						VALUES ?natWeight {"8"^^xsd:int}
						VALUES ?relWeight {"6"^^xsd:int}
						VALUES ?ethWeight {"7"^^xsd:int}
						VALUES ?locWeight {"2"^^xsd:int}
						VALUES ?accWeight {"3"^^xsd:int}
						VALUES ?rentWeight {"1"^^xsd:int}
						VALUES ?shareWeight {"4"^^xsd:int}

						# to assign/retrieve configuration values
						BIND(1 AS ?matchScore)
						BIND(-1 AS ?unmatchScore)
						#BIND(10 AS ?numOfPreferences)

						# to compute similarity value of subject agent for object agent
						# age similarity
						BIND(IF(?subAgePref = "Dont mind" || (xsd:integer(?objAge) >= xsd:integer(?subLowerAge) && xsd:integer(?objAge) <= xsd:integer(?subHigherAge)), ?matchScore, ?unmatchScore) AS ?ageSml).
						# gender similarity
						BIND(IF(?subGenPref = "Dont mind" || LCASE(STR(?objGender)) = LCASE(STR(?subGenPref)), ?matchScore, ?unmatchScore) AS ?genSml).
						# family similarity
						BIND(IF(?subFamPref = "Dont mind" || LCASE(STR(?objFamily)) = LCASE(STR(?subFamPref)), ?matchScore, ?unmatchScore) AS ?famSml).
						# nationality similarity
						BIND(IF(?subNatPref = "Dont mind" || (?subNatPref = "Same" && ?subNationality = ?objNationality) || (?subNatPref = "Mixed" && ?subNationality != ?objNationality), ?matchScore, ?unmatchScore) AS ?natSml)
						#religion similarity
						BIND(IF(?subRelPref = "Dont mind" || (?subRelPref = "Same" && ?subReligion = ?objReligion) || (?subRelPref = "Mixed" && ?subReligion != ?objReligion), ?matchScore, ?unmatchScore) AS ?relSml)
						# ethnicity similarity
						BIND(IF(?subEthPref = "Dont mind" || (?subEthPref = "Same" && ?subEthnicity = ?objEthnicity) || (?subEthPref = "Mixed" && ?subEthnicity != ?objEthnicity), ?matchScore, ?unmatchScore) AS ?ethSml)
						# location similarity
						BIND(IF(?subLocPref = "Dont mind" || ?objLocPref = "Dont mind" || ?subLocPref = ?objLocPref, ?matchScore, ?unmatchScore) AS ?locSml)
						# accessibility similarity
						BIND(IF(?subAccessPref = "Dont mind" || ?objAccessPref = "Dont mind" || LCASE(STR(?subAccessPref)) = LCASE(STR(?objAccessPref)), ?matchScore, ?unmatchScore) AS ?accSml)
						# rental period similarity
						BIND(((year(xsd:dateTime(?subEndRent)) - year(now()))*365 + 30*(month(xsd:dateTime(?subEndRent))) + day(xsd:dateTime(?subEndRent))) AS ?subEndRentIntValue)
						BIND(((year(xsd:dateTime(?objEndRent)) - year(now()))*365 + 30*(month(xsd:dateTime(?objEndRent))) + day(xsd:dateTime(?objEndRent))) AS ?objEndRentIntValue)
						BIND(((year(xsd:dateTime(?subStartRent)) - year(now()))*365 + 30*(month(xsd:dateTime(?subStartRent))) + day(xsd:dateTime(?subStartRent))) AS ?subStartRentIntValue)
						BIND(((year(xsd:dateTime(?objStartRent)) - year(now()))*365 + 30*(month(xsd:dateTime(?objStartRent))) + day(xsd:dateTime(?objStartRent))) AS ?objStartRentIntValue)
						BIND(IF(?subEndRentIntValue > ?objEndRentIntValue, ?objEndRentIntValue, ?subEndRentIntValue) AS ?smallerEndRent)
						BIND(IF(?subStartRentIntValue > ?objStartRentIntValue, ?subStartRentIntValue, ?objStartRentIntValue) AS ?biggerStartRent)
						BIND(IF(?subStartRentIntValue > ?objStartRentIntValue, ?objStartRentIntValue, ?subStartRentIntValue) AS ?smallerStartRent)
						BIND(IF(?subEndRentIntValue > ?objEndRentIntValue, ?subEndRentIntValue, ?objEndRentIntValue) AS ?biggerEndRent)
						BIND(?smallerEndRent - ?biggerStartRent + 1 AS ?rentOverlap)
						BIND(?biggerEndRent - ?smallerStartRent + 1 AS ?rentTotal)
						BIND(IF(?subRentPref = "Dont mind" || ?objRentPref = "Dont mind", ?matchScore, IF(?subStartRent > ?objEndRent || ?objStartRent > ?subEndRent, ?unmatchScore,
						xsd:double(?rentOverlap/?rentTotal))) AS ?rentSml)
						# share with similarity
						BIND(IF(?subMaxShare > ?objMaxShare, ?objMaxShare, ?subMaxShare) AS ?smallerMaxShare)
						BIND(IF(?subMinShare > ?objMinShare, ?subMinShare, ?objMinShare) AS ?biggerMinShare)
						BIND(IF(?subMinShare > ?objMinShare, ?objMinShare, ?subMinShare) AS ?smallerMinShare)
						BIND(IF(?subMaxShare > ?objMaxShare, ?subMaxShare, ?objMaxShare) AS ?biggerMaxShare)
						BIND(?smallerMaxShare - ?biggerMinShare + 1 AS ?shareOverlap)
						BIND(?biggerMaxShare - ?smallerMinShare + 1 AS ?shareTotal)
						BIND(IF(?subSharePref = "Dont mind" || ?objSharePref = "Dont mind", ?matchScore, IF(?subMinShare > ?objMaxShare || ?objMinShare > ?subMaxShare, ?unmatchScore,
						xsd:double(?shareOverlap/?shareTotal))) AS ?shareSml)
						# total similarity
						BIND(xsd:float(((?ageSml * ?ageWeight) + (?genSml * ?genWeight) + (?famSml * ?famWeight) + (?natSml * ?natWeight) + (?relSml * ?relWeight) +
						(?ethSml * ?ethWeight) + (?locSml * ?locWeight) + (?accSml * ?accWeight) + (?rentSml * ?rentWeight) + (?shareSml * ?shareWeight))/10.0) AS ?totalSml).

						} GROUP BY ?subAgentId ?pAgentId ?chcId ?subAgent ?totalSml
						}
						} GROUP BY  ?subAgent ?subAgentId ?pAgentId ?chcId
						}
						BIND(BNODE() AS ?smlBnode)
						}"""^^xsd:string ;
	] .
	
:WriteSimilarities2LAKR
	a bt:Write ;
	rdfs:label "Write: CHC Similarity values to Agent Knowledge" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			CONSTRUCT	{

					?agentUri	welcome:hasCHCSimilarityValue	?smlBnode .
					?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
									mac:hasSubjectAgent ?agentId ;
									mac:hasObjectAgent ?pAgentId ;
									mac:isComputedForProblemId  ?chcId ;
									mac:hasSimilarityScore ?smlValue .

					}
			WHERE 	{

						?agentUri	welcome:hasCHCSimilarityValue	?smlBnode .

						?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
									mac:hasSubjectAgent ?agentId ;
									mac:hasObjectAgent ?pAgentId ;
									mac:isComputedForProblemId  ?chcId ;
									mac:hasSimilarityScore ?smlValue .
					} """^^xsd:string ;
	] .

:UpdateSetSimilarityTimer
	a bt:Update ;
	rdfs:label "Update: Set Similarity Timer according to Nb Participants" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					?bnode welcome:hasSimilarityWaitingTime ?waitTime . 
				}
				INSERT{
					?bnode welcome:hasSimilarityWaitingTime 0 .
				}
				WHERE {
					?dAgent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId .
					
					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents .
					OPTIONAL {?bnode welcome:hasSimilarityWaitingTime ?waitTime . }
				}"""^^xsd:string ;
		] .

:Wait4SimilarityValues
	a bt:Wait ;
	rdfs:label "Wait: wait for agents to return their Similarity values for CHC" ;
	rdfs:comment "" ;
	bt:milliseconds "20000"^^xsd:int .

:UpdateSimilarityTimer	
	a bt:Update ;
	rdfs:label "Update: Set New Similartiy Timer" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				DELETE{
					?bnode welcome:hasSimilarityWaitingTime ?waitTime . 
				}
				INSERT{
					?bnode welcome:hasSimilarityWaitingTime ?newTimer .
				}
				WHERE {
					?dAgent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId .
					
					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents .
					?bnode welcome:hasSimilarityWaitingTime ?waitTime . 
					BIND((?waitTime + 20000) AS ?newTimer )
				}"""^^xsd:string ;
		] .

:ConditionEveryoneReturnedSimilarities
	a bt:Condition ;
	rdfs:label "Did all participating agents return their Similarity values?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
								PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

				ASK
				WHERE {
						{
							SELECT ?numOfAgents (count(?smlValue) AS ?total)
							WHERE {
								?dAgent	rdf:type	ajan:Agent ;
								welcome:isRunningCHC ?chcId ;
								ajan:agentId	?dAgentId.

								?bnode	rdf:type	welcome:CHCUseCase;
								mac:hasId		?chcId;
								mac:hasNumberOfAgents	?numOfAgents;
								mac:hasParticipants		?pAgentId .

								?agentUri	welcome:hasCHCSimilarityValue	?smlBnode .

								?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
								mac:hasSubjectAgent ?pAgentId ;
								mac:hasObjectAgent ?oAgentId ;
								mac:isComputedForProblemId  ?chcId ;
								mac:hasSimilarityScore ?smlValue .
								} GROUP BY ?numOfAgents
						}

						FILTER(?total = (?numOfAgents * (?numOfAgents-1)))

					}"""^^xsd:string ;
		] .
		
:EventProducerSolverCHCEvent
	a bt:EventProducer ;
	rdfs:label "EventProducer: Solve CHC Event" ;
	ajan:event agents:SolveCHCEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:ExecutionKnowledge;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent welcome:requested "SolveCHC" .
						}
						WHERE {
							?agent	rdf:type ajan:Agent ;
								ajan:agentId	?subAgentId ;
						}"""^^xsd:string ;
				] .
				
:ConditionMaxSimilarityWaitingTimeReached
	a bt:Condition ;
	rdfs:label "Condition: Was the Max Time for Similarity Reached?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			ASK
			{
				?dAgent	rdf:type	ajan:Agent ;
					welcome:isRunningCHC ?chcId .
				?bnode	rdf:type	welcome:CHCUseCase;
					mac:hasId		?chcId;
					mac:hasNumberOfAgents	?numOfAgents ;
					welcome:hasSimilarityWaitingTime ?similWaitTime .
													
				FILTER(?similWaitTime >= 30000 * (?numOfAgents/3))
			}"""^^xsd:string ;
		] .
		
#-----------------SharingCHCPersonalInfoBT Nodes-----------------------------
:HandleShareCHCPersonalInfoEvent
	a bt:HandleQueueEvent ;
	rdfs:label "EventHandler: Share CHC Personal Info" ;
	bt:event agents:ShareCHCPersonalInfoEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:LocalServicesKnowledge ;
					bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
						}
						WHERE {
							?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
						}"""^^xsd:string ;
				] .

:WriteDedicated2Execution
	a bt:Write ;
	rdfs:label "Write: Dedicated to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
				PREFIX ajan: <http://www.ajan.de/ajan-ns#>
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
				PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
				PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
				CONSTRUCT {
					?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
							welcome:isRunningCHC	?chcId ;
							welcome:hasRootAddress	?agentAddress .
				}
				WHERE {
					?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
							welcome:isRunningCHC	?chcId ;
							welcome:hasRootAddress	?agentAddress .
				}"""^^xsd:string ;
	] .
	
:UpdateDeleteDedicatedfromLSR
	a bt:Update ;
	rdfs:label "Update: Delete Dedicated Agent from LSR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
						?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
								welcome:isRunningCHC	?chcId ;
								welcome:hasRootAddress	?agentAddress .
					}
					WHERE {
						?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
								welcome:isRunningCHC	?chcId ;
								welcome:hasRootAddress	?agentAddress .
					}"""^^xsd:string ;
	] .
		
:WriteCHCPersonalInfo2Exec
	a bt:Write ;
	rdfs:label "Write: Personal info of agent to Execution for the particular CHC process" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			CONSTRUCT  {
				?agent	rdf:type ajan:Agent, ajan:ThisAgent ;
						ajan:agentId	?agentName ;
						welcome:hasCHCPersonalInfo	?bnode .

				?bnode	rdf:type	welcome:CHCPersonalInfo;
								welcome:hasAge	?age;
								welcome:hasGender	?gender;
								welcome:hasFamily	?family;
								welcome:hasNationality	?nationality;
								welcome:hasReligion		?religion;
								welcome:hasEthnicity 	?ethnicity;
								welcome:hasEmailValue ?email ;
								welcome:speaksLanguage	?lang ;
								welcome:hasChcLocationPreference	?locPref;
								welcome:hasChcAccessibilityPreference	?accessPref;
								welcome:hasChcRentPeriodPreference		?bNRentPref;
								welcome:hasChcShareWithPreference		?bNSharePref.

						?bNRentPref	?rentPred	?rentObj.
						?bNSharePref ?sharePred	?shareObj.

				}
			WHERE {
				?agent	rdf:type ajan:Agent ;
						ajan:agentId	?agentName .

				welcome:tcn_user
							welcome:hasAge	?bNAge;
							welcome:hasGender	?bNGender;
							welcome:hasFamily	?bNFamily;
							welcome:hasNationality	?bNNationality;
							welcome:hasReligion		?bNReligion;
							welcome:hasEthnicity 	?bNEthnicity;
							welcome:hasEmail ?objEmail ;
							welcome:speaksLanguage	?bNLang ;
							welcome:hasChcLocationPreference	?bNLocPref;
							welcome:hasChcAccessibilityPreference	?bNAccessPref;
							welcome:hasChcRentPeriodPreference		?bNRentPref;
							welcome:hasChcShareWithPreference		?bNSharePref.
						
						?bNAge welcome:hasValue ?age .
						?bNGender welcome:hasValue ?gender .
						?bNFamily welcome:hasValue ?family .
						?bNNationality welcome:hasValue ?nationality .
						?bNReligion welcome:hasValue ?religion .
						?bNEthnicity welcome:hasValue ?ethnicity .
						?objEmail welcome:hasValue ?email .
						?bNLang rdf:rest*/rdf:first* ?lang .
						FILTER NOT EXISTS {?lang ?w ?u }
						FILTER(?lang != rdf:nil)
						?bNLocPref rdf:rest*/rdf:first* ?locPref .
						FILTER NOT EXISTS {?locPref ?y ?z }
						FILTER(?locPref != rdf:nil)
						?bNAccessPref welcome:hasValue ?accessPref .
						OPTIONAL{
							?bNRentPref	?rentPred	?rentObj.
						}
						OPTIONAL{
							?bNSharePref	?sharePred		?shareObj.
						}
				{BIND(BNODE() AS ?bnode)}

			} """^^xsd:string ;
	] .

:Message2DedicatedChcPersonalInfo
	a myWelcome:Message ;
	rdfs:label "Message: Return Personal Info to Dedicated agent for CHC"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	  ] ;
	 bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("text/turtle" "text/turtle")
					   }
				}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent	ajan:agentId	?agentName ;
									welcome:hasCHCPersonalInfo	?bnode .

							?bnode	rdf:type	welcome:CHCPersonalInfo;
								mac:hasId	?chcId ;
								welcome:hasAge	?age;
								welcome:hasGender	?gender;
								welcome:hasFamily	?family;
								welcome:hasNationality	?nationality;
								welcome:hasReligion		?religion;
								welcome:hasEthnicity 	?ethnicity;
								welcome:hasEmailValue ?email ;
								welcome:speaksLanguage	?lang ;
								welcome:hasChcLocationPreference	?locPref;
								welcome:hasChcAccessibilityPreference	?accessPref;
								welcome:hasChcRentPeriodPreference		?rentPref;
								welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}
						WHERE {
							?agent rdf:type ajan:Agent ;
									ajan:agentId	?agentName ;
									welcome:hasCHCPersonalInfo	?bnode .

							?bnode	rdf:type	welcome:CHCPersonalInfo;
								welcome:hasAge	?age;
								welcome:hasGender	?gender;
								welcome:hasFamily	?family;
								welcome:hasNationality	?nationality;
								welcome:hasReligion		?religion;
								welcome:hasEthnicity 	?ethnicity;
								welcome:hasEmailValue ?email ;
								welcome:speaksLanguage	?lang ;
								welcome:hasChcLocationPreference	?locPref;
								welcome:hasChcAccessibilityPreference	?accessPref;
								welcome:hasChcRentPeriodPreference		?rentPref;
								welcome:hasChcShareWithPreference		?sharePref.

							OPTIONAL{
								?rentPref	?rentPred	?rentObj.
							}
							OPTIONAL{
								?sharePref	?sharePred		?shareObj.
							}

							?dedicated	welcome:hasMacRole	"Dedicated"^^xsd:string ;
										welcome:isRunningCHC	?chcId .

				}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

					SELECT DISTINCT ?requestURI
					WHERE {
					  ?agent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
								welcome:isRunningCHC	?chcId ;
								welcome:hasRootAddress	?address .
					BIND(CONCAT(?address, "?capability=receiveCHCPersonalInfo") AS ?requestURI )
					}"""^^xsd:string
	] .

:AddAgentInvolvedInCHCFlag
	a bt:Write ;
	rdfs:label "Write: CHC Id in which the agent is participating to LAKR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					
					CONSTRUCT  {
						?participantAgent	welcome:isInvolvedInCHC	?chcId .
					}
					WHERE {
						?participantAgent	rdf:type	ajan:Agent ;
											welcome:hasCHCPersonalInfo	?bnode .

						?dedicatedAgent		welcome:hasMacRole	"Dedicated"^^xsd:string ;
											welcome:isRunningCHC	?chcId .
					} """^^xsd:string ;
	] .

#-----------------ReceiveCHCPersonalInfoBT Nodes-----------------------------
:HandleReceiveCHCPersonalInfoEvent
	a bt:HandleQueueEvent ;
	rdfs:label "HandleQueueEvent: Receive CHC Personal info" ;
	bt:event agents:ReceiveCHCPersonalInfoEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					#bt:targetBase ajan:ExecutionKnowledge ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """

						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .

#-----------------SharingCHCSimilaritiesBT Nodes-----------------------------
:HandleShareCHCSimilaritiesEvent
	a bt:HandleQueueEvent ;
	rdfs:label "HandleQueueEvent: Share CHC Similarities Event" ;
	bt:event agents:ShareCHCSimilaritiesEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:LocalServicesKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}
						WHERE {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}"""^^xsd:string ;
				] .

:WriteCopyPIfromLSR2Execution
	a bt:Write ;
	rdfs:label "Write: Copy Personal Information from LSR to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}
						WHERE {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
						}"""^^xsd:string ;
	] .
	
:UpdateRemovePIfromLSR
	a bt:Update ;
	rdfs:label "Update: Delete PI from LSR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.
					}
					WHERE {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?pAgentUri	welcome:hasCHCPersonalInfo	?bnode2 ;
										ajan:agentId	?pAgentId .

							?bnode2		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;
										welcome:hasAge	?age;
										welcome:hasGender	?gender;
										welcome:hasFamily	?family;
										welcome:hasNationality	?nationality;
										welcome:hasReligion		?religion;
										welcome:hasEthnicity 	?ethnicity;
										welcome:hasEmailValue ?email ;
										welcome:hasChcLocationPreference	?locPref;
										welcome:hasChcAccessibilityPreference	?accessPref;
										welcome:hasChcRentPeriodPreference		?rentPref;
										welcome:hasChcShareWithPreference		?sharePref.

							?rentPref	?rentPred	?rentObj.
							?sharePref	?sharePred		?shareObj.						
					}"""^^xsd:string ;
		] .
		
:MessageSimilarities2Dedicated
	a myWelcome:Message ;
	rdfs:label "Message: Return Similarity values to Dedicated agent"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("application/ld+json" "application/ld+json")
					   }
				}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent	welcome:hasCHCSimilarityValue	?smlBnode .

							?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
										mac:hasSubjectAgent ?agentId ;
										mac:hasObjectAgent ?pAgentId ;
										mac:isComputedForProblemId  ?chcId ;
										mac:hasSimilarityScore ?smlValue .
								}
						WHERE {
							?agent	rdf:type	ajan:Agent ;
									ajan:agentId	?agentId .

							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId .

							?agent	welcome:hasCHCSimilarityValue	?smlBnode .

							?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
										mac:hasSubjectAgent ?agentId ;
										mac:hasObjectAgent ?pAgentId ;
										mac:isComputedForProblemId  ?chcId ;
										mac:hasSimilarityScore ?smlValue .

						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					SELECT ?requestURI
					WHERE {
						?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
								welcome:isRunningCHC	?chcId ;
								welcome:hasRootAddress	?agentAddress .
						BIND(CONCAT(?agentAddress, "?capability=receiveCHCSimilarities") AS ?requestURI )
					}"""^^xsd:string
	] .

#-----------------ReceivingCHCSimilaritiesBT Nodes-----------------------------
:HandleReceiveCHCSimilaritiesEvent
	a bt:HandleQueueEvent ;
	rdfs:label "QueueEventHandler: Receive CHC Similarities" ;
	bt:event agents:ReceiveCHCSimilaritiesEvent ;
	bt:validate [
					a bt:ConstructQuery ;
					#bt:targetBase ajan:ExecutionKnowledge ;
					bt:targetBase ajan:AgentKnowledge ;
					bt:sparql """
						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .
				
#---------------SolvingCHCBT Nodes----------------------------
:HandleSolveCHCEvent
	a bt:HandleEvent ;
	rdfs:label "EventHandler: Solve CHC" ;
	bt:event agents:SolveCHCEvent;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?agent welcome:requested "SolveCHC" .
						}
						WHERE {
							?agent welcome:requested "SolveCHC" .
						}"""^^xsd:string ;
				] .

:ComputeCHCReciprocalSimilarities
	a bt:Write ;
	rdfs:label "Write: Compute CHC Reciprocal Similarities" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			CONSTRUCT  {
					?agent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId ;
							ajan:agentId	?dAgentId.

					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents;
							mac:hasParticipants		?pAgentId ;
							welcome:hasAgeWeight ?ageWeight;
							welcome:hasGenderWeight ?genWeight;
							welcome:hasFamilyWeight	?famWeight;
							welcome:hasNationalityWeight	?natWeight;
							welcome:hasReligionWeight	?relWeight;
							welcome:hasEthnicityWeight	?ethWeight;
							welcome:hasLocationWeight	?locWeight;
							welcome:hasAccessibilityWeight	?accWeight;
							welcome:hasRentPeriodWeight	?rentWeight;
							welcome:hasShareWithWeight	?shareWeight.

					?rrsBnode	rdf:type	welcome:CHCReciprocalScore ;
								mac:hasSubjectAgent ?pAgentId ;
								mac:hasObjectAgent ?pAgentId2 ;
								mac:isComputedForProblemId  ?chcId ;
								ajan:hasReciprocalScore	?bReciprocalScore .
					}
			WHERE {
					?agent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId ;
							ajan:agentId	?dAgentId.

					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents;
							mac:hasParticipants		?pAgentId, ?pAgentId2 ;
							welcome:hasAgeWeight ?ageWeight;
							welcome:hasGenderWeight ?genWeight;
							welcome:hasFamilyWeight	?famWeight;
							welcome:hasNationalityWeight	?natWeight;
							welcome:hasReligionWeight	?relWeight;
							welcome:hasEthnicityWeight	?ethWeight;
							welcome:hasLocationWeight	?locWeight;
							welcome:hasAccessibilityWeight	?accWeight;
							welcome:hasRentPeriodWeight	?rentWeight;
							welcome:hasShareWithWeight	?shareWeight.

					FILTER(?pAgentId!=?pAgentId2)

					?smlBnode	rdf:type	welcome:CHCSimilarityValue ;
								mac:hasSubjectAgent ?pAgentId ;
								mac:hasObjectAgent ?pAgentId2 ;
								mac:isComputedForProblemId  ?chcId ;
								mac:hasSimilarityScore ?smlValue .

					?smlBnode2	rdf:type	welcome:CHCSimilarityValue ;
								mac:hasSubjectAgent ?pAgentId2 ;
								mac:hasObjectAgent ?pAgentId ;
								mac:isComputedForProblemId  ?chcId ;
								mac:hasSimilarityScore ?smlValue2 .
					FILTER(?smlBnode != ?smlBnode2)

					BIND(0 AS ?reciprocalScore) .
                    BIND(IF(?smlValue != 0 && ?smlValue2 != 0, 2/((1/?smlValue)+(1/?smlValue2)), ?reciprocalScore) AS ?bReciprocalScore) .
					BIND(BNODE() AS ?rrsBnode) .

				} """^^xsd:string ;
	] .

:ComputeCHCConstraints
	a bt:Write ;
	rdfs:label "Write: Compute CHC Must and Cannot link connections" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
								?bnode	mac:hasCannotLinkConnections	?cannotLinkBnode .

								?cannotLinkBnode	mac:hasCannotConnect	?pAgentId, ?pAgentId2 .
						}
						WHERE {

							{
								SELECT ?bnode ?pAgentId ?pAgentId2 (SUM(?canSpeakSameLang) AS ?finalCanSpeakSameLang)
								WHERE{
									{
										SELECT ?bnode ?pAgentId ?pAgentId2 ?canSpeakSameLang
										WHERE{
											?agentUri	rdf:type	ajan:Agent ;
														welcome:isRunningCHC	?chcId .

											?bnode	rdf:type	welcome:CHCUseCase;
													mac:hasId		?chcId;
													mac:hasParticipants		?pAgentId, ?pAgentId2 .
											FILTER(?pAgentId != ?pAgentId2)
											FILTER(?pAgentId < ?pAgentId2)

											?agentUri2	ajan:agentId	?pAgentId ;
														welcome:hasCHCPersonalInfo	?bnode2 .

											?bnode2	rdf:type	welcome:CHCPersonalInfo;
													mac:hasId	?chcId ;
													welcome:speaksLanguage	?lang .

											?agentUri3	ajan:agentId	?pAgentId2 ;
														welcome:hasCHCPersonalInfo	?bnode3 .

											?bnode3	rdf:type	welcome:CHCPersonalInfo;
													mac:hasId	?chcId ;
													welcome:speaksLanguage	?lang2 .
											BIND(IF(?lang = ?lang2, 1, 0) AS ?canSpeakSameLang)
										} GROUP BY ?bnode ?pAgentId ?pAgentId2 ?canSpeakSameLang
									}
								}GROUP BY ?bnode ?pAgentId ?pAgentId2
							}
							FILTER(?finalCanSpeakSameLang=0)
							BIND(BNODE() AS ?cannotLinkBnode)
				} """^^xsd:string ;
	] .
	
:WriteReciprocalScores2Lakr
	a bt:Write ;
	rdfs:label "Write: Reciprocal Scores to lakr" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			CONSTRUCT  {
					?agent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId ;
							ajan:agentId	?dAgentId.

					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents;
							mac:hasParticipants		?pAgentId ;
							welcome:hasAgeWeight ?ageWeight;
							welcome:hasGenderWeight ?genWeight;
							welcome:hasFamilyWeight	?famWeight;
							welcome:hasNationalityWeight	?natWeight;
							welcome:hasReligionWeight	?relWeight;
							welcome:hasEthnicityWeight	?ethWeight;
							welcome:hasLocationWeight	?locWeight;
							welcome:hasAccessibilityWeight	?accWeight;
							welcome:hasRentPeriodWeight	?rentWeight;
							welcome:hasShareWithWeight	?shareWeight.

					?rrsBnode	rdf:type	welcome:CHCReciprocalScore ;
								mac:hasSubjectAgent ?pAgentId ;
								mac:hasObjectAgent ?objectAgentId ;
								mac:isComputedForProblemId  ?chcId ;
								ajan:hasReciprocalScore	?bReciprocalScore .
					}
			WHERE {
					?agent	rdf:type	ajan:Agent ;
							welcome:isRunningCHC ?chcId ;
							ajan:agentId	?dAgentId.

					?bnode	rdf:type	welcome:CHCUseCase;
							mac:hasId		?chcId;
							mac:hasNumberOfAgents	?numOfAgents;
							mac:hasParticipants		?pAgentId ;
							welcome:hasAgeWeight ?ageWeight;
							welcome:hasGenderWeight ?genWeight;
							welcome:hasFamilyWeight	?famWeight;
							welcome:hasNationalityWeight	?natWeight;
							welcome:hasReligionWeight	?relWeight;
							welcome:hasEthnicityWeight	?ethWeight;
							welcome:hasLocationWeight	?locWeight;
							welcome:hasAccessibilityWeight	?accWeight;
							welcome:hasRentPeriodWeight	?rentWeight;
							welcome:hasShareWithWeight	?shareWeight.


					?rrsBnode	rdf:type	welcome:CHCReciprocalScore ;
								mac:hasSubjectAgent ?pAgentId ;
								mac:hasObjectAgent ?objectAgentId ;
								mac:isComputedForProblemId  ?chcId ;
								ajan:hasReciprocalScore	?bReciprocalScore .
			}"""^^xsd:string ;
	] .

:ClusteringSolver_HDBSCAN
	a bt:HDBSCAN ;
	rdfs:label "Run HDBSCAN Algorithm to Solve CHC" ;
	bt:query [
				a bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:targetBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
                        CONSTRUCT {
								?bnode	rdf:type	mac:MACProblemInstance;
										mac:hasId		?chcId;
										mac:hasNumberOfAgents	?numOfAgents;
										mac:hasParticipants		?pAgentId ;
										mac:hasPerfectMatchScore ?perfectMatchScore ;
										mac:hasCannotLinkConnections	?cannotLinkBnode .

								?cannotLinkBnode	mac:hasCannotConnect	?cntAgent1, ?cntAgent2 .


								# HDBSCAN Parameters: min Points and min Cluster Size
								?bnode	mac:hasMinPoints	"1"^^xsd:integer ;
										mac:hasMinClusterSize	"2"^^xsd:integer .


								?dsnBnode	rdf:type	mac:DistanceScore ;
											mac:isComputedBy ?pAgentId ;
											mac:isComputedAgainst ?oAgentId ;
											mac:isComputedFor  ?chcId ;
											mac:hasValue	?distanceScore .
						}
						WHERE {
                           {
                            SELECT DISTINCT ?bnode ?chcId ?numOfAgents ?perfectMatchScore ?pAgentId ?oAgentId ?distanceScore ?cannotLinkBnode ?cntAgent1 ?cntAgent2
                            {
								?agent	rdf:type	ajan:Agent ;
										welcome:isRunningCHC ?chcId ;
										ajan:agentId	?dAgentId.

								?bnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasNumberOfAgents	?numOfAgents;
										mac:hasParticipants		?pAgentId ;
										welcome:hasAgeWeight ?ageWeight;
										welcome:hasGenderWeight ?genWeight;
										welcome:hasFamilyWeight	?famWeight;
										welcome:hasNationalityWeight	?natWeight;
										welcome:hasReligionWeight	?relWeight;
										welcome:hasEthnicityWeight	?ethWeight;
										welcome:hasLocationWeight	?locWeight;
										welcome:hasAccessibilityWeight	?accWeight;
										welcome:hasRentPeriodWeight	?rentWeight;
										welcome:hasShareWithWeight	?shareWeight.
								OPTIONAL{
									?bnode	mac:hasCannotLinkConnections	?cannotLinkBnode .
									?cannotLinkBnode	mac:hasCannotConnect	?cntAgent1, ?cntAgent2 .
								}

										BIND(1 AS ?matchScore)
										BIND(0 AS ?unmatchScore)
										BIND(10 AS ?numberOfPreferences)
										BIND((?matchScore * (?ageWeight + ?genWeight + ?famWeight + ?natWeight + ?relWeight + ?ethWeight + ?locWeight + ?accWeight + ?rentWeight + ?shareWeight))/?numberOfPreferences AS ?perfectMatchScore)

								?rrsBnode	rdf:type	welcome:CHCReciprocalScore ;
											mac:hasSubjectAgent ?pAgentId ;
											mac:hasObjectAgent ?oAgentId ;
											mac:isComputedForProblemId  ?chcId ;
											ajan:hasReciprocalScore	?bReciprocalScore .

								BIND((?perfectMatchScore - ?bReciprocalScore) AS ?distanceScore)
                            }
                                }
								BIND(BNODE() AS ?dsnBnode)
				}"""^^xsd:string ;
			] .
			
:WriteCHCResultRequestContent2Execution
	a bt:Write ;
	rdfs:label "Write: CHC Result Request Content to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?dAgent	rdf:type	ajan:Agent ;
									ajan:agentId	?dAgentId ;
									welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?bnode	rdf:type	welcome:CHCUseCase;
									mac:hasId		?chcId;									
									welcome:hasStartTime ?start ;
									mac:hasParticipants		?pAgentId .
						}
						WHERE {

							?dAgent	rdf:type	ajan:Agent ;
									welcome:isRunningCHC ?chcId ;
									ajan:agentId	?dAgentId.

							?du		welcome:hasRootAddress	?rootAddress .
							BIND(CONCAT(?rootAddress, ?dAgentId) AS ?agentAddress)

							?bnode	rdf:type	welcome:CHCUseCase;
									mac:hasId		?chcId;									
									welcome:hasStartTime ?start ;
									mac:hasParticipants		?pAgentId .

						}"""^^xsd:string ;
	] .

:BroadcastHDBSCANResult
	a bt:Broadcast ;
	rdfs:label "Broadcast: the result of CHC Process"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("text/turtle" "text/turtle")
					   }
				}"""^^xsd:string
		] ;		
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

						CONSTRUCT {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:hasFinishedCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;										
										welcome:hasStartTime ?start ;
										mac:hasSolution	?clusteringBnode .

							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .
						}
						WHERE {
							?dAgent	rdf:type	ajan:Agent ;
									welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?clusteringBnode	rdf:type	mac:Clustering ;
									#mac:hasSolutionOf	?chcId ;
									mac:isSolutionOf ?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .

							?chcBnode	rdf:type	welcome:CHCUseCase;
									mac:hasId		?chcId;
									welcome:hasStartTime ?start ;
									mac:hasParticipants		?pAgentId .
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					SELECT DISTINCT ?requestURI
					WHERE {
						?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
										
						?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
								
						?pagentURI rdf:type ajan:Agent ;
								ajan:agentName ?pAgentName ;
								welcome:hasAddress ?agentAddress .
								
						FILTER(?pAgentName != ?agentId)
						BIND(CONCAT(?agentAddress, "?capability=finalizeCHCProcess") AS ?requestURI )
					}"""^^xsd:string
	] .

:EventProducerFinalizeCHCProcessEvent
	a bt:EventProducer ;
	rdfs:label "EventProducer: Finalize CHC Process Event" ;
	ajan:event agents:FinalizeCHCProcessEvent ;
	bt:content [
					a bt:ConstructQuery ;
					bt:originBase ajan:ExecutionKnowledge;
					bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

						CONSTRUCT {
							?dAgent	ajan:agentId ?dAgentId .

							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:hasFinishedCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;
										welcome:hasStartTime	?startTime ;
										mac:hasSolution	?clusteringBnode .

							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .
						}
						WHERE {
							?dAgent	rdf:type	ajan:Agent ;
									ajan:agentId ?dAgentId .

							OPTIONAL {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
							}
							
							OPTIONAL {
								?chcBnode	rdf:type	welcome:CHCUseCase;
											#welcome:hasStatus	?chcStatus ;
											mac:hasId		?chcId ;
											welcome:hasStartTime	?startTime ;
											mac:hasParticipants		?pAgentId .
							}

							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										mac:hasSolutionOf	?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .
							}
							
							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										#mac:hasSolutionOf	?chcId ;
									mac:isSolutionOf ?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .							
							}
						}"""^^xsd:string ;
				] .

#---------------FinalizingCHCProcessBT Nodes----------------------------

:HandleFinalizeCHCProcessEvent
	a bt:HandleQueueEvent ;
	rdfs:label "QueueEventHandler: Finalize CHC Process" ;
	bt:event agents:FinalizeCHCProcessEvent;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:LocalServicesKnowledge ;
					#bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

						CONSTRUCT {
							?dAgent	ajan:agentId ?dAgentId .

							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:hasFinishedCHC	?chcId ;
									welcome:hasRootAddress	?dAgentAddress .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;
										welcome:hasStartTime	?startTime ;
										mac:hasSolution	?clusteringBnode .

							
											
							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .
							
							welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .
						}
						WHERE {					
							OPTIONAL {
									?dAgent	rdf:type ajan:Agent  }
							OPTIONAL {
									?dAgent	ajan:agentId ?dAgentId .
							}
							OPTIONAL {
									?dAgent	rdf:type ajan:ThisAgent .
							}
							OPTIONAL {?dAgent welcome:hasFinishedCHC ?chcId .}
							
							OPTIONAL{?dAgent welcome:hasRootAddress ?dAgentAddress }
							
							OPTIONAL {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?dAgentAddress .
							}	
							
							OPTIONAL {
								?chcBnode rdf:type welcome:CHCUseCase;
											mac:hasId ?chcId ;
											welcome:hasStartTime?startTime ;
											mac:hasParticipants	?pAgentId .							
							}
							
							OPTIONAL {?chcBnode mac:hasSolution	?clusteringBnode .}
							
							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										mac:hasSolutionOf	?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .
							}
							
							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										mac:isSolutionOf ?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .							
							}
							OPTIONAL {welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .}
						}"""^^xsd:string ;
				] .

:WriteCopyResult2Execution
	a bt:Write ;
	rdfs:label "Write: Copy CHC Results to Execution " ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:LocalServicesKnowledge;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						CONSTRUCT {
							?dAgent	ajan:agentId ?dAgentId .

							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:hasFinishedCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;
										#welcome:hasStatus	?defaultChcStatus ;
										welcome:hasStartTime	?startTime ;
										mac:hasSolution	?clusteringBnode .

							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .
							welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .
						}
						WHERE {
							OPTIONAL {
									?dAgent	rdf:type ajan:Agent .
							}
							OPTIONAL {
									?dAgent	ajan:agentId ?dAgentId 
							}
							OPTIONAL {
									?dAgent	rdf:type ajan:ThisAgent .
							}
							OPTIONAL {?dAgent welcome:hasFinishedCHC ?chcId .}
							
							OPTIONAL{?dAgent welcome:hasRootAddress ?agentAddress }
							
							OPTIONAL {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
							}	
							
							OPTIONAL {
								?chcBnode	rdf:type	welcome:CHCUseCase;
											mac:hasId		?chcId ;
											welcome:hasStartTime	?startTime ;
											mac:hasParticipants		?pAgentId .
							}
							
							OPTIONAL {?chcBnode mac:hasSolution	?clusteringBnode .}
							
							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										mac:hasSolutionOf	?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .
							}
							
							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										mac:isSolutionOf ?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .							
							}
							OPTIONAL {welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .}
						}"""^^xsd:string ;
	] .
	
:UpdateDeleteResultfromLSR
	a bt:Update ;
	rdfs:label "Update: Delete CHC Results in LSR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:LocalServicesKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
							?dAgent	rdf:type	ajan:Agent ;
											ajan:agentId ?dAgentId .
							?dAgent welcome:hasFinishedCHC ?chcId .
							?dAgent welcome:hasRootAddress ?agentAddress .
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .							
							?chcBnode	rdf:type	welcome:CHCUseCase;
											mac:hasId		?chcId ;
											welcome:hasStartTime	?startTime ;
											mac:hasParticipants		?pAgentId .
							?chcBnode mac:hasSolution	?clusteringBnode .
							?clusteringBnode	rdf:type	mac:Clustering .
							?clusteringBnode	?predClustering		?objClustering .
							?clusterBnode	rdf:type	mac:Cluster .
							?clusterBnode   ?predCluster ?objCluster .
							welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .
					}
					WHERE {
							OPTIONAL {
									?dAgent	rdf:type ajan:Agent .
							}
							OPTIONAL {
									?dAgent	ajan:agentId ?dAgentId 
							}
							OPTIONAL {?dAgent welcome:hasFinishedCHC ?chcId .}
							
							OPTIONAL{?dAgent welcome:hasRootAddress ?agentAddress }
							
							OPTIONAL {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .
							}	
							
							OPTIONAL {
								?chcBnode	rdf:type	welcome:CHCUseCase;
											mac:hasId		?chcId ;
											welcome:hasStartTime	?startTime ;
											mac:hasParticipants		?pAgentId .
							}
							
							OPTIONAL {?chcBnode mac:hasSolution	?clusteringBnode .}
							
							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
													?predClustering		?objClustering .
							}
							OPTIONAL {
								?clusterBnode	rdf:type	mac:Cluster ;
												?predCluster ?objCluster .
							}		
							OPTIONAL {welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .}							
					}"""^^xsd:string ;
		] .
		
:ConditionCHCSucceeded
	a bt:Condition ;
	rdfs:label "has CHC process finished with success?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE {
						?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string .

						OPTIONAL {
							?dAgent	welcome:hasFinishedCHC	?chcId .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasSolution	?clusteringBnode .
						}

						FILTER(BOUND(?chcId) && BOUND(?clusteringBnode))

						}"""^^xsd:string ;
		].

:WriteEmails2Execution
	a bt:Write ;
	rdfs:label "Write: Copy Emails of Found Agents to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
			PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
			PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
			PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
			PREFIX ajan: <http://www.ajan.de/ajan-ns#>
			PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
			CONSTRUCT  {
							?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode ;
										ajan:agentId	?otherAgentId .
							?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;												
										welcome:hasEmailNode ?bEmailNode .
							?bEmailNode welcome:hasEmailValue ?email .
			}
			WHERE {
							
								?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode ;
										ajan:agentId	?otherAgentId .
								?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
										mac:hasId	?chcId ;												
										welcome:hasEmailValue ?email .
								BIND(BNODE() AS ?bEmailNode)
							
			} """^^xsd:string ;
	] .

:UpdateDeletePreviousResultMessages
	a bt:Update ;
	rdfs:label "Update: Delete Previous Result Messages from Execution" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {						
									welcome:CHCResult 	welcome:hasSelfMember ?thisAgentId ;
														welcome:hasStartTime ?start .
									welcome:CHCResult welcome:hasFlatMateList ?bEmailNode .
									?bEmailNode welcome:FlatMateId ?otherAgentId; 
									?bEmailNode welcome:FlatMateEmail ?email. 
					}
					WHERE {
									welcome:CHCResult 	welcome:hasSelfMember ?thisAgentId ;
														welcome:hasStartTime ?start .
									OPTIONAL {welcome:CHCResult welcome:hasFlatMateList ?bEmailNode .}
									OPTIONAL {?bEmailNode welcome:FlatMateId ?otherAgentId }; 
									OPTIONAL {?bEmailNode welcome:FlatMateEmail ?email. }
					}
					"""^^xsd:string ;
		] .
		
:WriteCHCResultMessage2Execution
	a bt:Write ;
	rdfs:label "Write: CHC Result to Execution" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge;
		bt:targetBase ajan:ExecutionKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT {									
									?clusterBnode welcome:hasSelfMember ?thisAgentId ;
												welcome:hasStartTime ?start ;
												welcome:hasFlatMate ?otherAgentId ;
												mac:hasResultId ?chcId .
						}
						WHERE {
								{
									SELECT DISTINCT ?clusterBnode ?clusteringBnode ?thisAgentId ?otherAgentId ?start ?chcId
									WHERE{
											?thisAgent	rdf:type	ajan:Agent ;
														ajan:agentId	?thisAgentId .

											?chcBnode	rdf:type	welcome:CHCUseCase;
														mac:hasId		?chcId;
														mac:hasParticipants		?pAgentId ;
														welcome:hasStartTime ?start ;
														mac:hasSolution	?clusteringBnode .
											?clusteringBnode	rdf:type	mac:Clustering ;
														mac:hasSolutionOf	?chcId .
											OPTIONAL {	?clusteringBnode mac:hasMembers		?clusterBnode .
														?clusterBnode	rdf:type	mac:Cluster ;
																		mac:hasMembers	?thisAgentId ;
																		mac:isClusterOf	?clusteringBnode . 
											}
											OPTIONAL {
														?clusterBnode	mac:hasMembers	?otherAgentId .
														FILTER(?otherAgentId != ?thisAgentId)
											}	
									}
								}
						}"""^^xsd:string ;
	] .
	
#:WriteCHCResultMessage2LSR
#	a bt:Write ;
#	rdfs:label "Write: CHC Result to LSR" ;
#	bt:query [
#		a bt:ConstructQuery ;
#		bt:originBase ajan:ExecutionKnowledge;
#		bt:targetBase ajan:LocalServicesKnowledge ;
#		bt:sparql """
#						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
#						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
#						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
#						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
#						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
#						CONSTRUCT {									
#									?clusterBnode welcome:hasSelfMember ?thisAgentId ;
#												welcome:hasStartTime ?start ;
#												welcome:hasFlatMate ?otherAgentId ;
#												mac:hasResultId ?chcId .
#						}
#						WHERE {
#								{
#									SELECT DISTINCT ?clusterBnode ?thisAgentId ?otherAgentId ?start ?chcId
#									WHERE{
#											?thisAgent	rdf:type	ajan:Agent ;
#														ajan:agentId	?thisAgentId .
#
#											?chcBnode	rdf:type	welcome:CHCUseCase;
#														mac:hasId		?chcId;
#														mac:hasParticipants		?pAgentId ;
#														welcome:hasStartTime ?start ;
#														mac:hasSolution	?clusteringBnode .
#											?clusteringBnode	rdf:type	mac:Clustering ;
#														mac:hasSolutionOf	?chcId .
#											OPTIONAL {	?clusteringBnode mac:hasMembers		?clusterBnode .
#														?clusterBnode	rdf:type	mac:Cluster ;
#																		mac:hasMembers	?thisAgentId ;
#																		mac:isClusterOf	?clusteringBnode . 
#											}
#											OPTIONAL {
#														?clusterBnode	mac:hasMembers	?otherAgentId .
#														FILTER(?otherAgentId != ?thisAgentId)
#											}	
#									}
#								}
#						}"""^^xsd:string ;
#	] .

:Message2WPMResultOfCHC
	a myWelcome:Message ;
	rdfs:label "Message: Inform TCN by Email about the result of CHC use case"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "WPM"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						CONSTRUCT {
									welcome:CHCResult 	welcome:hasSelfMember ?thisAgentId ;
														welcome:hasStartTime ?start ;
														welcome:hasFlatMateList ?bEmailNode .
									?bEmailNode welcome:FlatMateId ?otherAgentId; welcome:FlatMateEmail ?email.
						}
						WHERE {
								
    								{
										SELECT ?thisAgentId ?start ?otherAgentId ?email ?bEmailNode
										WHERE {
												?clusterBnode welcome:hasSelfMember ?thisAgentId ;
														welcome:hasStartTime ?start .
												OPTIONAL {
															?clusterBnode	welcome:hasFlatMate ?otherAgentId 
												}
												?clusterBnode mac:hasResultId ?chcId .									
												?otherAgentURI ajan:agentId ?sameOtherAgentId ;				
												welcome:hasCHCPersonalInfo ?bNPersonalInfo .
												OPTIONAL {
														?bNPersonalInfo rdf:type welcome:CHCPersonalInfo ;
														mac:hasId ?chcId ;
														welcome:hasEmailNode ?bEmailNode .														
														?bEmailNode welcome:hasEmailValue ?email .
														FILTER (STRENDS(str(?otherAgentId), str(?sameOtherAgentId)))
												}
										} GROUP BY ?thisAgentId ?start ?otherAgentId ?email ?bEmailNode
									 }
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					SELECT ?requestURI 
					WHERE
					{
					  welcome:dispatcher welcome:hasAddress ?partialAddress .
					  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/chcResults") AS ?requestURI )
					}"""^^xsd:string
	] .

:Message2AppCHCFinished
	a myWelcome:Message ;
	rdfs:label "Message: Inform the App that CHC Finished"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}							
							UNION 
							{
								VALUES ?hdrName {"X-Msg-Type"}
								VALUES ?fieldValue {"CHC"}
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "App"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX welcome-sw: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						CONSTRUCT {
							welcome:CHC welcome:hasFinished "true" .
						}
						WHERE {
							?thisAgent	rdf:type	ajan:Agent .
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					SELECT ?requestURI 
					WHERE
					{
					  welcome:dispatcher welcome:hasAddress ?partialAddress .
					  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
					}"""^^xsd:string
	] .	

:UpdateDeletePersonalInfoFromLAKR
	a bt:Update ;
	rdfs:label "Update: Delete Personal Info from LAKR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {						
						?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode  .
						?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
									mac:hasId	?chcId ;												
									?prop ?value .		
					}
					WHERE {
						?pAgentUri	welcome:hasCHCPersonalInfo	?personalInfoBNode ;
									ajan:agentId	?otherAgentId .
						?personalInfoBNode		rdf:type	welcome:CHCPersonalInfo ;
									mac:hasId	?chcId ;												
									?prop ?value .		
					}"""^^xsd:string ;
		] .
		
:WriteCHCResult2Lakr
	a bt:Write ;
	rdfs:label "Write: CHC Result to LAKR" ;
	bt:query [
		a bt:ConstructQuery ;
		bt:originBase ajan:ExecutionKnowledge;
		bt:targetBase ajan:AgentKnowledge ;
		bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>

						CONSTRUCT {
							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;
										welcome:hasStartTime ?startTime ;
										welcome:hasStatus	"succeeded" ;
										mac:hasSolution	?clusteringBnode .
							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .
						}
						WHERE {
							?dAgent	#welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:hasFinishedCHC	?chcId .
									#welcome:hasAddress	?agentAddress .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;
										welcome:hasStartTime ?startTime ;
										mac:hasSolution	?clusteringBnode .

							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .

						}"""^^xsd:string ;
	] .


:Message2AppChcFailure
	a myWelcome:Message ;
	rdfs:label "Message: Inform TCN that CHC failed"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
							UNION 
							{
								VALUES ?hdrName {"X-Msg-Type"}
								VALUES ?fieldValue {"CHC-Result"}
							}	
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "APP"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

						CONSTRUCT {
							welcome:CHCUseCase	welcome:hasStatus	"Failed" .
						}
						WHERE {

							?s ?p ?o .
						}
						"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
					SELECT ?requestURI 
					WHERE
					{
					  welcome:dispatcher welcome:hasAddress ?partialAddress .
					  BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentNotification") AS ?requestURI )
					}"""^^xsd:string
	] .

:UpdateChcStatus2Failure
	a bt:Update ;
	rdfs:label "Update: CHC status to Failed in LAKR" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
						?chcBnode welcome:hasStatus ?chcStatus .
					}
					INSERT {
						?chcBnode welcome:hasStatus "Failed"^^xsd:string .
					}
					WHERE {
						?agent	rdf:type ajan:Agent .


						OPTIONAL {
							?agent	welcome:isRunningCHC ?chcId .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										welcome:hasStatus	?chcStatus ;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId .
						}						
					}"""^^xsd:string ;
		] .

:ConditionIsANotRespondingAgent
	a bt:Condition ;
	rdfs:label "Condition: Is A Not Responding Agent or Dedicated with no CHC Use Case?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE {
						{
							welcome:CHC welcome:hasNotRespondingAgent ?nRAgentId .
						}
						UNION
						{
							FILTER NOT EXISTS {?chcBnode rdf:type welcome:CHCUseCase .}
						}
					}"""^^xsd:string ;
		].
		
:RemoveAgentInCHC
	a bt:Update ;
	rdfs:label "Update: Delete Agent Involved in CHC" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
							?thisAgent welcome:isInvolvedInCHC ?chcId .
							?dAgent welcome:isRunningCHC ?chcId .
					}
					WHERE {

						?thisAgent	rdf:type	ajan:Agent ;
									ajan:agentId ?dAgentId .
							
						OPTIONAL {?dAgent welcome:isRunningCHC	?chcId . }
									
					}"""^^xsd:string ;
		] .
		
:RemoveAgentInCHCAndComputeRuntime
	a bt:Update ;
	rdfs:label "Update: remove chc id if agent either running or involved in it and add runtime" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
							?agentUri	welcome:isInvolvedInCHC	?chcId ;
										welcome:isRunningCHC	?chcId .
					}
					INSERT{
							?chcBnode	mac:hasRuntime	?chcRuntimeInSeconds.
					}
					WHERE {


						?chcBnode	rdf:type	welcome:CHCUseCase .

						OPTIONAL {
							?chcBnode	mac:hasSolution	?clusteringBnode .
						}

						OPTIONAL {
							?chcBnode	welcome:hasStatus	?chcStatus .
						}

						FILTER(BOUND(?clusteringBnode) || (LCASE(STR(?chcStatus)) = "failed"))

						?chcBnode	mac:hasId		?chcId .

						?agentUri	rdf:type	ajan:Agent ;
									ajan:agentId	?agentName .

						OPTIONAL {
							?agentUri	welcome:isRunningCHC	?chcId .
						}

						OPTIONAL {
							?agentUri	welcome:isInvolvedInCHC	?chcId .
						}

						BIND(NOW() AS ?endTime)
						?chcBnode	welcome:hasStartTime	?startTime .

						BIND( (DAY(?startTime)*86400 + HOURS(?startTime)*3600 + MINUTES(?startTime)*60 + SECONDS(?startTime)) AS ?startTimeInSeconds)
						BIND( (DAY(?endTime)*86400 + HOURS(?endTime)*3600 + MINUTES(?endTime)*60 + SECONDS(?endTime)) AS ?endTimeInSeconds)
						BIND( ?endTimeInSeconds - ?startTimeInSeconds AS ?chcRuntimeInSeconds)
						
						}"""^^xsd:string ;
		] .

:UpdateAgentRunningChcFlagOff
	a bt:Update ;
	rdfs:label "Agent Running CHC Flag-Off" ;
	bt:query [
		a bt:UpdateQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					DELETE {
						?agent	welcome:isRunningChc	"true" . 
					}
					INSERT{
						?agent	welcome:isRunningChc	"false" .
					}
					WHERE {
						?agent	rdf:type ajan:Agent .
						OPTIONAL { ?agent welcome:isRunningChc	"true" . }
					}
					"""^^xsd:string ;
		] .
		
:ConditionAgentInAnyMAC
	a bt:Condition ;
	rdfs:label "is agent involved in or running any coordination use case?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE {
						?agentUri rdf:type	ajan:Agent .

						OPTIONAL {
							?agentUri	welcome:isRunningCHC	?runningChcId .
						}

						OPTIONAL {
							?agentUri	welcome:isInvolvedInCHC	?involvedInChcId .
						}

						FILTER(BOUND(?involvedInChcId) || BOUND(?runningChcId))

						}"""^^xsd:string ;
		] .

:Message2WPMUpdateStatus2Active
	a myWelcome:Message ;
	rdfs:label "Message: Update Agent status to Active in WAR"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	myWelcome:correlatorId [
    a bt:SelectQuery;
    bt:originBase ajan:AgentKnowledge ;
      bt:sparql """
        PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
        SELECT ?correlatorId
        WHERE {
            ?msg welcome:hasCorrelationID ?correlatorId .
        }"""^^xsd:string
	] ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					SELECT DISTINCT ?hdrName ?fieldValue
					WHERE { 							
							{
							   VALUES ?hdrName {"X-Correlation-ID"}
							   ?msg welcome:hasCorrelationID ?fieldValue .
							}
							UNION
							{
								VALUES ?hdrName {"X-User-ID"}
								?du rdf:type welcome:DialogueUser .
								?du welcome:hasUserId ?idObject .
								?idObject welcome:hasValue ?fieldValue .
							}
					}"""^^xsd:string
		] ;
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "application/ld+json"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "application/ld+json"
				][
					a http-core:Header ;
					http-core:hdrName http-headers:to ;
					http-core:fieldValue "WPM"
			]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX welcome-sw: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						CONSTRUCT {
							?agent	welcome:hasStatus	welcome-sw:active ;
									ajan:agentId	?agentName .
						}
						WHERE {
							?agent	rdf:type	ajan:Agent  ;
									ajan:agentId	?agentName .
						}"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:AgentKnowledge ;
		bt:sparql """
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

					SELECT ?requestURI
					WHERE {
						welcome:dispatcher welcome:hasAddress ?partialAddress .
						BIND(CONCAT(STR(?partialAddress), "/welcome/integration/workflow/dispatcher/agentStatus") AS ?requestURI )
					}"""^^xsd:string
	] .
	
:HandleCHCFailureEvent
	a bt:HandleEvent ;
	rdfs:label "EventHandler: CHC Failed Event" ;
	bt:event agents:CHCFailureEvent;
	bt:validate [
					a bt:ConstructQuery ;
					bt:targetBase ajan:ExecutionKnowledge ;
					bt:sparql """

						CONSTRUCT {
							?s ?p ?o .
						}
						WHERE {
							?s ?p ?o .
						}"""^^xsd:string ;
				] .

:ConditionWasCHCBuiltAndBroadcasted
	a bt:Condition ;
	rdfs:label "was CHC Use case Broadcasted?" ;
	bt:query  [
		a bt:AskQuery ;
		bt:originBase ajan:ExecutionKnowledge ;
		bt:sparql """
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					ASK
					WHERE {
							?broadcastedBnode	rdf:type	welcome:TemporaryBnode ;
												welcome:hasCHCBroadcasted	"true"^^xsd:boolean ;
												mac:hasId	?chcId .
												
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId .

					}"""^^xsd:string ;
		] .
		
:BroadcastCHCFailed
	a bt:Broadcast ;
	rdfs:label "Broadcast: CHC process failed"^^xsd:string ;
	rdfs:comment ""^^xsd:string ;
	bt:targetBase ajan:ExecutionKnowledge ;
	bt:binding [
		a http-core:Request ;
		http-core:httpVersion "1.1"^^xsd:string ;
		http-core:mthd http-methods:POST ;
		bt:headers [
			a bt:SelectQuery;
			a bt:QueryUri ;
			bt:originBase ajan:AgentKnowledge ;
			bt:sparql """
				PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#> 
				SELECT ?hdrName ?fieldValue
				{	
					 VALUES (?hdrName ?fieldValue)
					   { ("text/turtle" "text/turtle")
					   }
				}"""^^xsd:string
		] ;		
		http-core:headers ([
					a http-core:Header ;
					http-core:hdrName http-headers:accept ;
					http-core:fieldValue "text/turtle"^^xsd:string
				][
					a http-core:Header ;
					http-core:hdrName http-headers:content-type ;
					http-core:fieldValue "text/turtle"
				]
		) ;
		http-core:body [
			a actn:Payload ;
			bt:query [
				rdf:type bt:ConstructQuery ;
				bt:originBase ajan:ExecutionKnowledge ;
				bt:sparql """
						PREFIX ajan: <http://www.ajan.de/ajan-ns#>
						PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
						PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
						PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
						PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

						CONSTRUCT {
							?dAgent	welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:hasFinishedCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							?chcBnode	rdf:type	welcome:CHCUseCase;
										mac:hasId		?chcId;
										mac:hasParticipants		?pAgentId ;
										mac:hasSolution	?clusteringBnode .

							?clusteringBnode	rdf:type	mac:Clustering ;
									mac:hasSolutionOf	?chcId ;
									mac:hasMembers		?clusterBnode .

							?clusterBnode	rdf:type	mac:Cluster ;
									mac:hasMembers	?clusterMember ;
									mac:isClusterOf	?clusteringBnode .
						}
						WHERE {
							?dAgent	rdf:type	ajan:Agent ;
									welcome:hasMacRole	"Dedicated"^^xsd:string ;
									welcome:isRunningCHC	?chcId ;
									welcome:hasRootAddress	?agentAddress .

							#BIND("failed"^^xsd:string AS ?defaultChcStatus)

							OPTIONAL {
								?chcBnode	rdf:type	welcome:CHCUseCase;
											#welcome:hasStatus	?chcStatus ;
											mac:hasId		?chcId ;
											mac:hasParticipants		?pAgentId .
							}

							OPTIONAL {
								?clusteringBnode	rdf:type	mac:Clustering ;
										mac:hasSolutionOf	?chcId ;
										mac:hasMembers		?clusterBnode .
								?clusterBnode	rdf:type	mac:Cluster ;
										mac:hasMembers	?clusterMember ;
										mac:isClusterOf	?clusteringBnode .
								#BIND("succeeded"^^xsd:string AS ?defaultChcStatus)
							} }
							"""^^xsd:string
			]
		] ;
	] ;
	bt:queryUri [
		a bt:SelectQuery ;
		a bt:QueryUri ;
		bt:originBase ajan:LocalAgentsKnowledge ;
		bt:sparql """
					PREFIX ajan: <http://www.ajan.de/ajan-ns#>
					PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
					PREFIX welcome: <https://raw.githubusercontent.com/gtzionis/WelcomeOntology/main/welcome.ttl#>
					PREFIX mac: <http://localhost:8090/rdf4j/repositories/ajan_mac_ontology#>
					SELECT DISTINCT ?requestURI
					WHERE {
						?agent	welcome:isRunningCHC	?chcId ;
										ajan:agentId	?agentId .
										
						?bnode	mac:hasId	?chcId ;
										mac:hasParticipants	?pAgentName .
								
						?pagentURI rdf:type ajan:Agent ;
								ajan:agentName ?pAgentName ;
								welcome:hasAddress ?agentAddress .
								
						FILTER(?pAgentName != ?agentId)
						BIND(CONCAT(?agentAddress, "?capability=shareCHCSimilarities") AS ?requestURI )
						#BIND(CONCAT(?agentAddress, "?capability=shareCHCSimilarities") AS ?requestURI )
					}"""^^xsd:string
	] .
